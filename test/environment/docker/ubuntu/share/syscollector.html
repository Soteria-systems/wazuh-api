<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:18,&quot;tests&quot;:239,&quot;passes&quot;:239,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2020-06-08T12:20:03.421Z&quot;,&quot;end&quot;:&quot;2020-06-08T12:21:19.563Z&quot;,&quot;duration&quot;:76142,&quot;testsRegistered&quot;:239,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false,&quot;passPercentClass&quot;:&quot;success&quot;,&quot;pendingPercentClass&quot;:&quot;danger&quot;},&quot;suites&quot;:{&quot;uuid&quot;:&quot;0229853f-ac5c-4e8e-90ed-2e7c25567acd&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;1adf9ffe-184a-4a2f-8876-64c323c19921&quot;,&quot;title&quot;:&quot;Syscollector&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;ccf01d42-aee0-48f0-8563-445ed6daa799&quot;,&quot;title&quot;:&quot;GET/syscollector/:agent_id/os&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/os \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:393,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/\&quot; + agent_id)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;os&#x27;, &#x27;manager&#x27;]);\n        res.body.data.os.should.have.properties([&#x27;arch&#x27;, &#x27;platform&#x27;]);\n        expected_hostname = res.body.data.manager;\n        expected_architecture = res.body.data.os.arch;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6b023bd4-c21a-4d17-a0e1-84ac96176885&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/os Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:337,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/os\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.array;\n        res.body.data.should.have.properties(os_fields);\n        res.body.data.os.should.have.properties([&#x27;name&#x27;, &#x27;version&#x27;]);\n        res.body.data.scan.should.have.properties([&#x27;id&#x27;, &#x27;time&#x27;]);\n        res.body.data.hostname.should.be.equal(expected_hostname);\n        res.body.data.architecture.should.be.equal(expected_architecture);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6202d5ad-3440-47c3-8f85-56d3b2474dcd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/os Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:313,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/os?select=os_version,sysname,release\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;os&#x27;, &#x27;sysname&#x27;, &#x27;release&#x27;]);\n        res.body.data.os.should.have.properties([&#x27;version&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;11471c95-802e-44ab-af27-cd9a07b9bf87&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/os Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:321,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/os?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2a2ad1e6-f110-4630-83c8-2cd5c3d97029&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6202d5ad-3440-47c3-8f85-56d3b2474dcd&quot;,&quot;11471c95-802e-44ab-af27-cd9a07b9bf87&quot;,&quot;2a2ad1e6-f110-4630-83c8-2cd5c3d97029&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:971,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;4e9f2cec-b44a-4137-8afe-a176e2788849&quot;,&quot;title&quot;:&quot;GET/syscollector/:agent_id/hardware&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hardware Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:292,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/hardware\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.array;\n        res.body.data.should.have.properties(hardware_fields);\n        res.body.data.ram.should.have.properties([&#x27;free&#x27;, &#x27;total&#x27;]);\n        res.body.data.scan.should.have.properties([&#x27;id&#x27;, &#x27;time&#x27;]);\n        res.body.data.cpu.should.have.properties([&#x27;name&#x27;, &#x27;cores&#x27;, &#x27;mhz&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2fb1e08b-d574-429d-bffd-1870b8e5aabb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hardware Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:288,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/hardware?select=ram_free,board_serial,cpu_name,ram_total\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;board_serial&#x27;, &#x27;ram&#x27;, &#x27;cpu&#x27;]);\n        res.body.data.ram.should.have.properties([&#x27;free&#x27;, &#x27;total&#x27;]);\n        res.body.data.cpu.should.have.properties([&#x27;name&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d7aac850-e498-4925-9333-b646305e9ecb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hardware Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:288,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/hardware?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;58c4ecfa-2615-4fb0-a9ab-b96c206a1610&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2fb1e08b-d574-429d-bffd-1870b8e5aabb&quot;,&quot;d7aac850-e498-4925-9333-b646305e9ecb&quot;,&quot;58c4ecfa-2615-4fb0-a9ab-b96c206a1610&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:868,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;ecd7b776-f50e-4f7e-9779-a508bf3ed812&quot;,&quot;title&quot;:&quot;GET/syscollector/:agent_id/packages&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;]);\n        expected_name = res.body.data.items[0].name;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d37521c3-8440-4ed2-9623-84032a487952&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;vendor&#x27;]);\n        expected_vendor = res.body.data.items[0].vendor;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;77a712a4-2d14-4f35-9174-a65c68eef973&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:317,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;]);\n        expected_filter_name = res.body.data.items[0].name;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9870c81b-ce60-470f-a669-3fa885b647a9&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:330,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;architecture&#x27;]);\n        expected_architecture = res.body.data.items[0].architecture;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5df413f1-ff06-43d6-92fb-103e64547bf0&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:361,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;format&#x27;]);\n        expected_format = res.body.data.items[0].format;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5484dacf-2075-49c7-bd25-f9231c38bd1f&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:400,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(packages_fields);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;17d3086e-f0a4-4555-9557-e490dc256417&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:295,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?select=scan_id,description,architecture\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;description&#x27;, &#x27;architecture&#x27;, &#x27;scan&#x27;]);\n        res.body.data.items[0].scan.should.have.properties([&#x27;id&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2daf32b6-13af-4ca9-8238-b0ffb5a64cfd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e2152e5d-eb9c-4674-a02d-3496190a1104&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(packages_fields);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4dc05355-b2c2-4940-970a-17e169546958&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2e7dd6b8-4ee2-45f7-bbd1-431a0f04564a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Sort -&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Sort -&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?sort=-name&amp;limit=2\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(2);\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;]);\n        res.body.data.items[1].should.have.properties([&#x27;name&#x27;]);\n        //res.body.data.items[0].name.should.not.be.greaterThan(res.body.data.items[1].name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b550ac2d-2c93-4826-b6b5-9670839220dd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Sort +&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Sort +&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?sort=+name&amp;limit=2\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(2);\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;]);\n        res.body.data.items[1].should.have.properties([&#x27;name&#x27;]);\n        //res.body.data.items[1].name.should.not.be.greaterThan(res.body.data.items[0].name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;da55de65-9385-4e6d-a60e-e0a9cac055ee&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?sort=-wrongParameter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1403);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;206dbec2-a6d4-415a-b14e-d1189f8d6b81&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:295,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?search=\&quot; + expected_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(packages_fields);\n        res.body.data.items[0].name.should.be.equal(expected_name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;38236b41-8f9e-41f5-9682-74a9f5c38229&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: vendor&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Filter: vendor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?vendor=\&quot; + encodeURI(expected_vendor))\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;vendor&#x27;]);\n        res.body.data.items[0].vendor.should.be.equal(expected_vendor);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1acc52b7-b0f3-4aa8-aca0-9f079a06b701&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: name&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Filter: name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?name=\&quot; + expected_filter_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;]);\n        res.body.data.items[0].name.should.be.equal(expected_filter_name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9d464cb1-fdc1-4c64-b57d-abe5657fdea2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: architecture&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Filter: architecture&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:307,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?architecture=\&quot; + expected_architecture)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;architecture&#x27;]);\n        res.body.data.items[0].architecture.should.be.equal(expected_architecture);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8f315957-47b2-4c16-b895-ae772cd31e79&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: format&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Filter: format&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:304,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?format=\&quot; + expected_format)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;format&#x27;]);\n        res.body.data.items[0].format.should.be.equal(expected_format);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;30609413-c9fb-4e89-b72f-f8bc68dfa903&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:79,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/packages?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3adbf4b8-2f19-4813-b56b-03b703923272&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/packages Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:317,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(&#x27;/syscollector/&#x27; + agent_id + &#x27;/packages?q=format=&#x27; + expected_format + &#x27;,architecture!=&#x27; + expected_architecture)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;format&#x27;]);\n        res.body.data.items[0].format.should.be.equal(expected_format);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0d6b02e5-a642-475f-bd64-e1dddadcec4f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;17d3086e-f0a4-4555-9557-e490dc256417&quot;,&quot;2daf32b6-13af-4ca9-8238-b0ffb5a64cfd&quot;,&quot;e2152e5d-eb9c-4674-a02d-3496190a1104&quot;,&quot;4dc05355-b2c2-4940-970a-17e169546958&quot;,&quot;2e7dd6b8-4ee2-45f7-bbd1-431a0f04564a&quot;,&quot;b550ac2d-2c93-4826-b6b5-9670839220dd&quot;,&quot;da55de65-9385-4e6d-a60e-e0a9cac055ee&quot;,&quot;206dbec2-a6d4-415a-b14e-d1189f8d6b81&quot;,&quot;38236b41-8f9e-41f5-9682-74a9f5c38229&quot;,&quot;1acc52b7-b0f3-4aa8-aca0-9f079a06b701&quot;,&quot;9d464cb1-fdc1-4c64-b57d-abe5657fdea2&quot;,&quot;8f315957-47b2-4c16-b895-ae772cd31e79&quot;,&quot;30609413-c9fb-4e89-b72f-f8bc68dfa903&quot;,&quot;3adbf4b8-2f19-4813-b56b-03b703923272&quot;,&quot;0d6b02e5-a642-475f-bd64-e1dddadcec4f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4001,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;b09805ba-a8c0-4d7c-bdc0-8869f4c08e94&quot;,&quot;title&quot;:&quot;GET/experimental/syscollector/packages&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:394,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;]);\n        expected_name = res.body.data.items[0].name;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;dbb2bbc7-8a69-4ab5-9c3a-2a6d5e836fb0&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:322,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;vendor&#x27;]);\n        expected_vendor = res.body.data.items[0].vendor;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6590bf6b-5d21-4dc2-a5a7-5c8b6effee63&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:300,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;]);\n        expected_filter_name = res.body.data.items[0].name;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;981fc75f-cf37-4c33-8f0e-7e110a9aec3c&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:308,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;architecture&#x27;]);\n        expected_architecture = res.body.data.items[0].architecture;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6d3b8f4c-9891-4845-80cc-8536a1ac91b0&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:309,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;format&#x27;]);\n        expected_format = res.body.data.items[0].format;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;dd4e7ae3-c75f-4666-aeb1-8707a7d9b66b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:560,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(packages_fields);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2cc4fbc6-1f04-4d41-9c67-b2a6ca0a5ea1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:590,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?select=scan_id,description,scan_time,architecture\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;scan&#x27;, &#x27;description&#x27;, &#x27;architecture&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;18d1539f-d78a-40d1-bbeb-5e7e463713a0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:302,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7b187b28-7137-4263-b12b-75ee78d26919&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:337,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(packages_fields);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;297185bb-366c-41bf-a039-6788f3420d88&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:85,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;89e0fe0d-5a8d-4332-8305-68a04ee533aa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Sort -&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Sort -&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:308,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?sort=-name&amp;limit=2\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(2);\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;]);\n        res.body.data.items[1].should.have.properties([&#x27;name&#x27;]);\n        //res.body.data.items[0].name.should.not.be.greaterThan(res.body.data.items[1].name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;87afaccc-3e75-404d-9c5b-65f3cd3a7973&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Sort +&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Sort +&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:317,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?sort=+name&amp;limit=2\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(2);\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;]);\n        res.body.data.items[1].should.have.properties([&#x27;name&#x27;]);\n        //res.body.data.items[1].name.should.not.be.greaterThan(res.body.data.items[0].name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;266fa7ab-f01c-4589-ac8f-828eed2ac9a3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:318,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?sort=-wrongParameter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1403);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;189e015c-4bb7-48da-ae10-ed928d8c4837&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:382,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?search=\&quot; + expected_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(packages_fields);\n        res.body.data.items[0].name.should.be.equal(expected_name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;12ae1737-7ecc-486d-9f85-45c0267558ff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: vendor&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Filter: vendor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:328,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?vendor=\&quot; + encodeURI(expected_vendor))\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;vendor&#x27;]);\n        res.body.data.items[0].vendor.should.be.equal(expected_vendor);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4e16d603-b984-4fa3-a65a-adceacc9a0ad&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: name&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Filter: name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:346,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?name=\&quot; + expected_filter_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;]);\n        res.body.data.items[0].name.should.be.equal(expected_filter_name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;530058b6-39b8-4620-98de-5b4ace7965c3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: architecture&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Filter: architecture&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:487,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?architecture=\&quot; + expected_architecture)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;architecture&#x27;]);\n        res.body.data.items[0].architecture.should.be.equal(expected_architecture);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0d12dc22-168d-4938-b1dd-385e36866919&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: format&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Filter: format&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:517,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?format=\&quot; + expected_format)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;format&#x27;]);\n        res.body.data.items[0].format.should.be.equal(expected_format);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7b0344fb-d80f-4ab7-a82b-2fc7bb56a355&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/packages?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7d7bb947-51f4-4760-854b-6416f24c7b53&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/packages Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:527,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(&#x27;/experimental/syscollector/packages?q=format=&#x27; + expected_format + &#x27;,architecture!=&#x27; + expected_architecture + &#x27;,(size&gt;1000;size&lt;2000)&#x27;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;format&#x27;]);\n        res.body.data.items[0].format.should.be.equal(expected_format);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;bd7ca3a6-7ee4-4a03-95db-67a0bd81b7cc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2cc4fbc6-1f04-4d41-9c67-b2a6ca0a5ea1&quot;,&quot;18d1539f-d78a-40d1-bbeb-5e7e463713a0&quot;,&quot;7b187b28-7137-4263-b12b-75ee78d26919&quot;,&quot;297185bb-366c-41bf-a039-6788f3420d88&quot;,&quot;89e0fe0d-5a8d-4332-8305-68a04ee533aa&quot;,&quot;87afaccc-3e75-404d-9c5b-65f3cd3a7973&quot;,&quot;266fa7ab-f01c-4589-ac8f-828eed2ac9a3&quot;,&quot;189e015c-4bb7-48da-ae10-ed928d8c4837&quot;,&quot;12ae1737-7ecc-486d-9f85-45c0267558ff&quot;,&quot;4e16d603-b984-4fa3-a65a-adceacc9a0ad&quot;,&quot;530058b6-39b8-4620-98de-5b4ace7965c3&quot;,&quot;0d12dc22-168d-4938-b1dd-385e36866919&quot;,&quot;7b0344fb-d80f-4ab7-a82b-2fc7bb56a355&quot;,&quot;7d7bb947-51f4-4760-854b-6416f24c7b53&quot;,&quot;bd7ca3a6-7ee4-4a03-95db-67a0bd81b7cc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5481,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;a8bec863-b93b-47fa-8b54-b451c995e98c&quot;,&quot;title&quot;:&quot;GET/experimental/syscollector/os&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:303,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;sysname&#x27;]);\n        expected_name = res.body.data.items[0].sysname;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4b1fc664-baec-4b85-bed3-32a58087cc82&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:316,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;architecture&#x27;]);\n        expected_architecture = res.body.data.items[0].architecture;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8b6d4544-2cef-4abc-8b99-baac9c1b27be&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/os\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;os&#x27;]);\n        res.body.data.os.should.have.properties([&#x27;name&#x27;]);\n        expected_os_name = res.body.data.os.name;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a06ea66d-4888-44e2-aa91-b5f98df20723&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:307,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;os&#x27;]);\n        expected_os_version = res.body.data.items[0].os_version;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e25d2708-6a75-4672-bccd-f097f9ed4205&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:304,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;release&#x27;]);\n        expected_release = res.body.data.items[0].release;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d1f64510-8703-4faa-95be-62da36710df3&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:313,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(os_fields);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2160ca35-ffb6-43a7-9347-e2f70222a6ef&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:310,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?select=sysname,version,release,os_version\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;sysname&#x27;, &#x27;version&#x27;, &#x27;release&#x27;, &#x27;os&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;959d5766-2139-4317-8e8d-e207a4aaf529&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:290,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;63287206-b630-4cb8-a61a-55583cc62c66&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:304,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(os_fields);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a47e2a11-7899-4f2c-9bc3-0cb84bee2d17&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c4eb875f-b77b-4b67-abc7-421e5953318a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:328,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?search=\&quot; + expected_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(os_fields);\n        res.body.data.items[0].sysname.should.be.equal(expected_name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6a7a6203-8b1e-4961-a745-e7a0abafb636&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;09907445-b112-4aab-84a8-8a5807258da0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: architecture&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os Filter: architecture&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:311,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?architecture=\&quot; + expected_architecture)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;architecture&#x27;]);\n        res.body.data.items[0].architecture.should.be.equal(expected_architecture);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;86b1dcfc-4ab7-43e3-9cc9-2e84d0b56ad8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: os_name&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os Filter: os_name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:318,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?os_name=\&quot; + expected_os_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;os&#x27;]);\n        res.body.data.items[0].os.name.should.be.equal(expected_os_name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4ab31efa-0683-4c36-8e83-9908dfd3952b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: release&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os Filter: release&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:424,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?release=\&quot; + expected_release)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;release&#x27;]);\n        res.body.data.items[0].release.should.be.equal(expected_release);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8a6a9a10-d2a1-4266-9b3a-f392526e974c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/os Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:323,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/os?q=release=\&quot; + expected_release + &#x27;;os_major&gt;16&#x27;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;release&#x27;]);\n        res.body.data.items[0].release.should.be.equal(expected_release);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1a6f86b2-06ab-41b3-9d51-4d6084ab8534&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2160ca35-ffb6-43a7-9347-e2f70222a6ef&quot;,&quot;959d5766-2139-4317-8e8d-e207a4aaf529&quot;,&quot;63287206-b630-4cb8-a61a-55583cc62c66&quot;,&quot;a47e2a11-7899-4f2c-9bc3-0cb84bee2d17&quot;,&quot;c4eb875f-b77b-4b67-abc7-421e5953318a&quot;,&quot;6a7a6203-8b1e-4961-a745-e7a0abafb636&quot;,&quot;09907445-b112-4aab-84a8-8a5807258da0&quot;,&quot;86b1dcfc-4ab7-43e3-9cc9-2e84d0b56ad8&quot;,&quot;4ab31efa-0683-4c36-8e83-9908dfd3952b&quot;,&quot;8a6a9a10-d2a1-4266-9b3a-f392526e974c&quot;,&quot;1a6f86b2-06ab-41b3-9d51-4d6084ab8534&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3077,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;ddd54eb4-f795-4817-a335-cea143293d6f&quot;,&quot;title&quot;:&quot;GET/experimental/syscollector/hardware&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/hardware\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;ram&#x27;]);\n        res.body.data.ram.should.have.properties([&#x27;total&#x27;]);\n        expected_ram_total = res.body.data.ram.total;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3f4735f6-743f-4440-9b64-aff8182b7783&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/hardware\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;cpu&#x27;]);\n        res.body.data.cpu.should.have.properties([&#x27;cores&#x27;]);\n        expected_cpu_cores = res.body.data.cpu.cores;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a99c318e-6003-43a0-95d5-29222dd1b744&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/hardware\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;cpu&#x27;]);\n        res.body.data.cpu.should.have.properties([&#x27;mhz&#x27;]);\n        expected_cpu_mhz = res.body.data.cpu.mhz;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;084091a6-60b7-49d7-a81e-134ee96b12a1&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/hardware\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;board_serial&#x27;]);\n        expected_board_serial = res.body.data.board_serial;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;692678a3-09e8-46fe-a333-59f49c2c338b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:309,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/hardware\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(hardware_fields);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ba00336b-7146-4d87-92cb-d8c8d589653b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:318,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/hardware?select=ram_free,board_serial,cpu_name,cpu_mhz\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;ram&#x27;, &#x27;board_serial&#x27;, &#x27;cpu&#x27;, &#x27;agent_id&#x27;, &#x27;cpu&#x27;]);\n        res.body.data.items[0].cpu.should.have.properties([&#x27;mhz&#x27;,&#x27;name&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;439428b3-0587-437d-95b6-e6ca0f53d664&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:298,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/hardware?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;684de7dd-1458-48b5-b577-65e148000721&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:304,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/hardware?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(hardware_fields);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6b06af57-f933-4b0e-a48c-5975fdae9627&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/hardware?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;17de5ece-5632-4e43-83c0-7caa36eaedee&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:329,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/hardware?search=Intel\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(hardware_fields);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c7b80789-8669-46cd-9c3e-b545779e5a2b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:80,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/hardware?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7770f80f-0ac4-4f11-bb86-56f6d9defbe8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:298,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/hardware?sort=-wrongParameter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1403);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;075b714b-5c5e-4d5c-b74c-7038797c9d78&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: ram_total&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware Filter: ram_total&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:319,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/hardware?ram_total=\&quot; + expected_ram_total)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;ram&#x27;]);\n        res.body.data.items[0].ram.total.should.be.equal(expected_ram_total);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ddf88ac0-0a78-4bf8-845f-ed274af61b54&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: cpu_cores&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware Filter: cpu_cores&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:315,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/hardware?cpu_cores=\&quot; + expected_cpu_cores)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;cpu&#x27;]);\n        res.body.data.items[0].cpu.cores.should.be.equal(expected_cpu_cores);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;020ac028-9ffd-4b00-9bc6-050310b3e54a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: cpu_mhz&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware Filter: cpu_mhz&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:328,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/hardware?cpu_mhz=\&quot; + expected_cpu_mhz)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;cpu&#x27;]);\n        res.body.data.items[0].cpu.mhz.should.be.equal(expected_cpu_mhz);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;27ef3633-6fc5-4acb-9cdd-a95a6c2cb2b0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: board_serial&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware Filter: board_serial&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:354,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/hardware?board_serial=\&quot; + expected_board_serial)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;board_serial&#x27;]);\n        res.body.data.items[0].board_serial.should.be.equal(expected_board_serial);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1378a988-0072-4e90-95dc-bdb286c14a00&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/hardware Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:328,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/hardware?q=cpu_cores&gt;0;ram_usage&lt;1000\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].cpu.cores.should.be.above(0);\n        res.body.data.items[0].cpu.cores.should.be.below(1000);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;25a46b1b-ca32-4248-9c6b-b03f08cf463a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ba00336b-7146-4d87-92cb-d8c8d589653b&quot;,&quot;439428b3-0587-437d-95b6-e6ca0f53d664&quot;,&quot;684de7dd-1458-48b5-b577-65e148000721&quot;,&quot;6b06af57-f933-4b0e-a48c-5975fdae9627&quot;,&quot;17de5ece-5632-4e43-83c0-7caa36eaedee&quot;,&quot;c7b80789-8669-46cd-9c3e-b545779e5a2b&quot;,&quot;7770f80f-0ac4-4f11-bb86-56f6d9defbe8&quot;,&quot;075b714b-5c5e-4d5c-b74c-7038797c9d78&quot;,&quot;ddf88ac0-0a78-4bf8-845f-ed274af61b54&quot;,&quot;020ac028-9ffd-4b00-9bc6-050310b3e54a&quot;,&quot;27ef3633-6fc5-4acb-9cdd-a95a6c2cb2b0&quot;,&quot;1378a988-0072-4e90-95dc-bdb286c14a00&quot;,&quot;25a46b1b-ca32-4248-9c6b-b03f08cf463a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3658,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;b73c3ecc-cabe-4eca-9a2e-9265317b6435&quot;,&quot;title&quot;:&quot;GET/experimental/syscollector/processes&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:312,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        expected_state = res.body.data.items[0].state;\n        expected_ppid = res.body.data.items[0].ppid;\n        expected_egroup = res.body.data.items[0].egroup;\n        expected_euser = res.body.data.items[0].euser;\n        expected_fgroup = res.body.data.items[0].fgroup;\n        expected_name = res.body.data.items[0].name;\n        expected_nlwp = res.body.data.items[0].nlwp;\n        expected_pgrp = res.body.data.items[0].pgrp;\n        expected_priority = res.body.data.items[0].priority;\n        expected_rgroup = res.body.data.items[0].rgroup;\n        expected_ruser = res.body.data.items[0].ruser;\n        expected_sgroup = res.body.data.items[0].sgroup;\n        expected_suser = res.body.data.items[0].suser;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;771c42fa-8bd3-4fac-bc3a-5963b871d540&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:335,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(processes_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;daf199ac-ccde-4175-aaa3-969bdfbd4955&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:335,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?select=tty,sgroup,share,session,scan_id\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;tty&#x27;, &#x27;sgroup&#x27;, &#x27;share&#x27;, &#x27;session&#x27;, &#x27;scan&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8135b278-eaac-4466-a561-1055d21d3546&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:314,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;576d7457-83cb-4000-8530-2c3e81fa36fe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:311,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7112a0fd-26f5-4846-b1da-1a2af620b5b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;186d4c2e-d225-4a5d-8e9c-6e7b646f0758&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:432,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?search=\&quot; + expected_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].name.should.be.equal(expected_name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d3ec6fa1-4904-476c-ad61-46e995271684&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:80,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5b488e2d-b391-4dca-9764-315a892528f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:314,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?sort=-wrongParameter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1403);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;78cdb40a-bf25-4762-9f37-78dc7c95fe6e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: state&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Filter: state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:325,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?limit=2&amp;state=\&quot; + expected_state)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].state.should.be.equal(expected_state);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7d6d64b1-bf8e-4482-97fc-4167286dad30&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: ppid&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Filter: ppid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:310,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?limit=2&amp;ppid=\&quot; + expected_ppid)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].ppid.should.be.equal(expected_ppid);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9ab0878f-200d-4454-ae08-f5f137237e1c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: egroup&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Filter: egroup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:324,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?limit=2&amp;egroup=\&quot; + expected_egroup)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].egroup.should.be.equal(expected_egroup);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5351ceec-b037-4872-872d-0c5e70870009&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: euser&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Filter: euser&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:313,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?limit=2&amp;euser=\&quot; + expected_euser)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].euser.should.be.equal(expected_euser);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;716f7b2a-a974-4a07-bddf-e0357a0206c6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: fgroup&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Filter: fgroup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:316,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?limit=2&amp;fgroup=\&quot; + expected_fgroup)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].fgroup.should.be.equal(expected_fgroup);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fc3de447-7d37-44dc-b366-b474bdfc6298&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: name&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Filter: name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:334,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?name=\&quot; + expected_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].name.should.be.equal(expected_name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;564e036c-f23e-4776-b6a8-c92d8b696133&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: nlwp&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Filter: nlwp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:314,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?limit=2&amp;nlwp=\&quot; + expected_nlwp)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].nlwp.should.be.equal(expected_nlwp);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;077f10e1-fb9b-4070-a488-39ea1e393f5b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: pgrp&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Filter: pgrp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:329,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?pgrp=\&quot; + expected_pgrp)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].pgrp.should.be.equal(expected_pgrp);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ddb23b52-7b2f-40fc-8dbb-8540da7b6a6c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: priority&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Filter: priority&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:310,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?limit=2&amp;priority=\&quot; + expected_priority)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].priority.should.be.equal(expected_priority);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ae99ac45-e1b8-4a68-8658-33e0657464e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: rgroup&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Filter: rgroup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:304,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?limit=2&amp;rgroup=\&quot; + expected_rgroup)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].rgroup.should.be.equal(expected_rgroup);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f533edc5-dcca-4b28-996e-f5afc605e27f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: ruser&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Filter: ruser&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:305,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?limit=2&amp;ruser=\&quot; + expected_ruser)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].ruser.should.be.equal(expected_ruser);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5c4f8c98-7ef3-45e6-bd6a-3d95870a081a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: sgroup&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Filter: sgroup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:309,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?limit=2&amp;sgroup=\&quot; + expected_sgroup)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].sgroup.should.be.equal(expected_sgroup);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f93b24b5-fbc9-4da6-8372-98178be57888&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: suser&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Filter: suser&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:320,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?limit=2&amp;suser=\&quot; + expected_suser)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].suser.should.be.equal(expected_suser);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9bc1d41e-1c8a-44f1-9bf0-53dbeca27c78&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/processes Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:314,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/processes?limit=2&amp;offset=1&amp;q=suser!=\&quot; + expected_suser)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].suser.should.not.be.equal(expected_suser);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c2a2086d-f878-4300-8652-080a38e44030&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;daf199ac-ccde-4175-aaa3-969bdfbd4955&quot;,&quot;8135b278-eaac-4466-a561-1055d21d3546&quot;,&quot;576d7457-83cb-4000-8530-2c3e81fa36fe&quot;,&quot;7112a0fd-26f5-4846-b1da-1a2af620b5b5&quot;,&quot;186d4c2e-d225-4a5d-8e9c-6e7b646f0758&quot;,&quot;d3ec6fa1-4904-476c-ad61-46e995271684&quot;,&quot;5b488e2d-b391-4dca-9764-315a892528f4&quot;,&quot;78cdb40a-bf25-4762-9f37-78dc7c95fe6e&quot;,&quot;7d6d64b1-bf8e-4482-97fc-4167286dad30&quot;,&quot;9ab0878f-200d-4454-ae08-f5f137237e1c&quot;,&quot;5351ceec-b037-4872-872d-0c5e70870009&quot;,&quot;716f7b2a-a974-4a07-bddf-e0357a0206c6&quot;,&quot;fc3de447-7d37-44dc-b366-b474bdfc6298&quot;,&quot;564e036c-f23e-4776-b6a8-c92d8b696133&quot;,&quot;077f10e1-fb9b-4070-a488-39ea1e393f5b&quot;,&quot;ddb23b52-7b2f-40fc-8dbb-8540da7b6a6c&quot;,&quot;ae99ac45-e1b8-4a68-8658-33e0657464e3&quot;,&quot;f533edc5-dcca-4b28-996e-f5afc605e27f&quot;,&quot;5c4f8c98-7ef3-45e6-bd6a-3d95870a081a&quot;,&quot;f93b24b5-fbc9-4da6-8372-98178be57888&quot;,&quot;9bc1d41e-1c8a-44f1-9bf0-53dbeca27c78&quot;,&quot;c2a2086d-f878-4300-8652-080a38e44030&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6654,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;7476e8e2-b748-41e3-a8eb-99b4076f38eb&quot;,&quot;title&quot;:&quot;GET/experimental/syscollector/ports&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:310,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        expected_protocol = res.body.data.items[0].protocol;\n        expected_local_ip = res.body.data.items[0].local.ip;\n        expected_local_port = res.body.data.items[0].local.port;\n        expected_remote_ip = res.body.data.items[0].remote.ip;\n        expected_tx_queue = res.body.data.items[0].tx_queue;\n        expected_state = res.body.data.items[0].state;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;bc6973da-59e5-4e39-b02c-d045fccb26e0&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:342,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(ports_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9e276f40-27f7-4ab0-b481-3277cce813de&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:320,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?select=protocol,remote_ip,tx_queue,state\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;protocol&#x27;, &#x27;remote&#x27;, &#x27;tx_queue&#x27;, &#x27;state&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4e48d9a6-0f31-4ecd-bde7-30ba940f719a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:295,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2156e9de-e8c8-4843-89e3-2e31034e74b0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:301,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;14b4939e-4f45-49dc-8517-4d90d71890c0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;698c3c09-1f73-4669-ba61-680aa7d57e92&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:332,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?search=\&quot; + expected_remote_ip)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].remote.ip.should.be.equal(expected_remote_ip);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a6cff8d9-ead8-4aa8-a910-f7791b8ca72d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:79,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d1e9a537-3dfd-45de-8bb6-fda8bd07454c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:292,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?sort=-wrongParameter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1403);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c124f2c5-21cd-43c9-b567-4e73ad20587a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: protocol&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Filter: protocol&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:319,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?protocol=\&quot; + expected_protocol)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].protocol.should.be.equal(expected_protocol);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;10f70db2-44da-4eb3-947b-c974c0fa46a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: local_ip&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Filter: local_ip&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:322,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?local_ip=\&quot; + expected_local_ip)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].local.ip.should.be.equal(expected_local_ip);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b8db489c-f036-479e-a564-f91a0c004a2f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: local_port&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Filter: local_port&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:312,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?local_port=\&quot; + expected_local_port)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].local.port.should.be.equal(expected_local_port);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0ac99608-06bc-4254-930e-92d6e6e24fe2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: remote_ip&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Filter: remote_ip&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:318,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?remote_ip=\&quot; + expected_remote_ip)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].remote.ip.should.be.equal(expected_remote_ip);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e01fa846-89a9-442b-84f0-c695fd41af73&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: tx_queue&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Filter: tx_queue&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:315,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?tx_queue=\&quot; + expected_tx_queue)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].tx_queue.should.be.equal(expected_tx_queue);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;af7a18f2-a6e4-4062-ba41-000862a5bd86&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: state&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Filter: state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:315,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?state=\&quot; + expected_state)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].state.should.be.equal(expected_state);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;47a6ec13-6fc5-460d-9baa-ecb4030180af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/ports Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:316,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/ports?q=state!=\&quot; + expected_state + &#x27;;tx_queue&gt;100&#x27;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a1da7515-979b-4fe8-9659-6cf656d2922a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9e276f40-27f7-4ab0-b481-3277cce813de&quot;,&quot;4e48d9a6-0f31-4ecd-bde7-30ba940f719a&quot;,&quot;2156e9de-e8c8-4843-89e3-2e31034e74b0&quot;,&quot;14b4939e-4f45-49dc-8517-4d90d71890c0&quot;,&quot;698c3c09-1f73-4669-ba61-680aa7d57e92&quot;,&quot;a6cff8d9-ead8-4aa8-a910-f7791b8ca72d&quot;,&quot;d1e9a537-3dfd-45de-8bb6-fda8bd07454c&quot;,&quot;c124f2c5-21cd-43c9-b567-4e73ad20587a&quot;,&quot;10f70db2-44da-4eb3-947b-c974c0fa46a1&quot;,&quot;b8db489c-f036-479e-a564-f91a0c004a2f&quot;,&quot;0ac99608-06bc-4254-930e-92d6e6e24fe2&quot;,&quot;e01fa846-89a9-442b-84f0-c695fd41af73&quot;,&quot;af7a18f2-a6e4-4062-ba41-000862a5bd86&quot;,&quot;47a6ec13-6fc5-460d-9baa-ecb4030180af&quot;,&quot;a1da7515-979b-4fe8-9659-6cf656d2922a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4255,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;943cbf87-878f-443c-a8e2-cae5d6bdfa95&quot;,&quot;title&quot;:&quot;GET/syscollector/netaddr&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:301,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        expected_iface = res.body.data.items[0].iface;\n        expected_proto = res.body.data.items[0].proto;\n        expected_address = res.body.data.items[0].address;\n        expected_broadcast = res.body.data.items[0].broadcast;\n        expected_netmask = res.body.data.items[0].netmask;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;91275d5f-af1d-4afa-bcac-9d937b09d091&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:312,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;abc1e23e-2675-439f-8d56-b8413e63675f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:310,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?select=proto,netmask,broadcast\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;proto&#x27;, &#x27;netmask&#x27;, &#x27;broadcast&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4de131cb-0129-42a3-a045-f3bd4e7edd54&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:291,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3cf1c1d9-7814-4b4b-a153-b2c7099ae832&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:300,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f101ef5d-d5c9-49dd-8542-e7724c39f91f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;bedbc431-3772-4743-b433-7a7fc33ea720&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:318,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?search=\&quot; + expected_broadcast)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].broadcast.should.be.equal(expected_broadcast);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;02dfede1-0a1d-44b1-90f6-51b2ccabe61b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9d6a8a3d-f76b-41dc-9b02-45bae4fa5e93&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:290,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?sort=-wrongParameter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1403);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;eb74eccc-e9f9-4ae4-a692-ce655da08a85&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: iface&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Filter: iface&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:313,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?iface=\&quot; + expected_iface)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].iface.should.be.equal(expected_iface);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;67dab261-b969-454f-9161-5f9508c9b9f7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: proto&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Filter: proto&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:313,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?proto=\&quot; + expected_proto)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].proto.should.be.equal(expected_proto);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4f1721ab-591a-4194-9a44-29f55d8520f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: address&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Filter: address&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:311,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?address=\&quot; + expected_address)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].address.should.be.equal(expected_address);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;07f988bb-67a1-4aab-9466-93b5b441396e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: broadcast&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Filter: broadcast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:311,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?broadcast=\&quot; + expected_broadcast)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].broadcast.should.be.equal(expected_broadcast);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e40c54a7-2d76-48d2-9f18-08238df28131&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: netmask&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Filter: netmask&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:309,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?netmask=\&quot; + expected_netmask)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].netmask.should.be.equal(expected_netmask);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;98dfdf45-92df-4f5a-b15b-2405ae9349c2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/netaddr Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:311,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netaddr?q=netmask=\&quot; + expected_netmask)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].netmask.should.be.equal(expected_netmask);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;99e6f78c-aefd-4bf2-840d-21e490843948&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;abc1e23e-2675-439f-8d56-b8413e63675f&quot;,&quot;4de131cb-0129-42a3-a045-f3bd4e7edd54&quot;,&quot;3cf1c1d9-7814-4b4b-a153-b2c7099ae832&quot;,&quot;f101ef5d-d5c9-49dd-8542-e7724c39f91f&quot;,&quot;bedbc431-3772-4743-b433-7a7fc33ea720&quot;,&quot;02dfede1-0a1d-44b1-90f6-51b2ccabe61b&quot;,&quot;9d6a8a3d-f76b-41dc-9b02-45bae4fa5e93&quot;,&quot;eb74eccc-e9f9-4ae4-a692-ce655da08a85&quot;,&quot;67dab261-b969-454f-9161-5f9508c9b9f7&quot;,&quot;4f1721ab-591a-4194-9a44-29f55d8520f4&quot;,&quot;07f988bb-67a1-4aab-9466-93b5b441396e&quot;,&quot;e40c54a7-2d76-48d2-9f18-08238df28131&quot;,&quot;98dfdf45-92df-4f5a-b15b-2405ae9349c2&quot;,&quot;99e6f78c-aefd-4bf2-840d-21e490843948&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3844,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;55950cb9-b39f-49b0-8528-b171e8f4f928&quot;,&quot;title&quot;:&quot;GET/experimental/syscollector/netproto&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:297,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        expected_iface = res.body.data.items[0].iface;\n        expected_type = res.body.data.items[0].type;\n        expected_gateway = res.body.data.items[0].gateway;\n        expected_dhcp = res.body.data.items[0].dhcp;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;59f32748-fd68-41fd-86eb-f23e8060bc32&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:309,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7dcf2468-cfc6-48e0-8dc2-a8949ba5248e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:310,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto?select=iface,gateway,dhcp\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;iface&#x27;, &#x27;gateway&#x27;, &#x27;dhcp&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8e4e3318-7f9d-4f92-a709-e2cae26f9b1a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:294,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ce24b880-2bb1-471d-9419-6d2ba526e29e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:295,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;798741e5-5d3f-40a6-a00a-6180c7e9ae29&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2d582863-19f4-4872-b6be-afb82072f25e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:314,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto?search=\&quot; + expected_dhcp)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        res.body.data.items[0].dhcp.should.be.equal(expected_dhcp);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d35ecf20-80fb-435e-aac5-9f4466a85cce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;28e7b62d-6f08-4998-a72b-0c10d663e564&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:294,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto?sort=-wrongParameter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1403);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ed673005-1c02-43c4-b40f-e9eb2e8402cf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: iface&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto Filter: iface&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:309,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto?iface=\&quot; + expected_iface)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        res.body.data.items[0].iface.should.be.equal(expected_iface);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8b5a00a9-96f0-4c55-be0b-3b6ea7c3ab1a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: type&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto Filter: type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:313,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto?type=\&quot; + expected_type)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        res.body.data.items[0].type.should.be.equal(expected_type);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;96a702c1-86b3-412b-855f-b5e605c608a4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: gateway&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto Filter: gateway&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:308,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto?gateway=\&quot; + expected_gateway)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        res.body.data.items[0].gateway.should.be.equal(expected_gateway);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2df1c264-99f7-4261-b8e4-a5b4bc730fc1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: dhcp&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto Filter: dhcp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:311,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto?dhcp=\&quot; + expected_dhcp)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        res.body.data.items[0].dhcp.should.be.equal(expected_dhcp);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;cad50111-f161-4a08-a99c-5011932ed360&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netproto Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:311,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netproto?q=type=ipv4,iface=eth0\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;90dfb1ee-c155-4077-b311-a2543de95b0d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7dcf2468-cfc6-48e0-8dc2-a8949ba5248e&quot;,&quot;8e4e3318-7f9d-4f92-a709-e2cae26f9b1a&quot;,&quot;ce24b880-2bb1-471d-9419-6d2ba526e29e&quot;,&quot;798741e5-5d3f-40a6-a00a-6180c7e9ae29&quot;,&quot;2d582863-19f4-4872-b6be-afb82072f25e&quot;,&quot;d35ecf20-80fb-435e-aac5-9f4466a85cce&quot;,&quot;28e7b62d-6f08-4998-a72b-0c10d663e564&quot;,&quot;ed673005-1c02-43c4-b40f-e9eb2e8402cf&quot;,&quot;8b5a00a9-96f0-4c55-be0b-3b6ea7c3ab1a&quot;,&quot;96a702c1-86b3-412b-855f-b5e605c608a4&quot;,&quot;2df1c264-99f7-4261-b8e4-a5b4bc730fc1&quot;,&quot;cad50111-f161-4a08-a99c-5011932ed360&quot;,&quot;90dfb1ee-c155-4077-b311-a2543de95b0d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3523,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;386b2c86-5e73-483b-9917-086edd3423a7&quot;,&quot;title&quot;:&quot;GET/experimental/syscollector/netiface&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:306,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        expected_name = res.body.data.items[0].name;\n        expected_adapter = res.body.data.items[0].adapter;\n        expected_type = res.body.data.items[0].type;\n        expected_state = res.body.data.items[0].state;\n        expected_mtu = res.body.data.items[0].mtu;\n        expected_tx_packets = res.body.data.items[0].tx.packets;\n        expected_rx_packets = res.body.data.items[0].rx.packets;\n        expected_tx_bytes = res.body.data.items[0].tx.bytes;\n        expected_rx_bytes = res.body.data.items[0].rx.bytes;\n        expected_tx_errors = res.body.data.items[0].tx.errors;\n        expected_rx_errors = res.body.data.items[0].rx.errors;\n        expected_tx_dropped = res.body.data.items[0].tx.dropped;\n        expected_rx_dropped = res.body.data.items[0].rx.dropped;\n        expected_mac = res.body.data.items[0].mac;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7a47b80a-007a-4306-a7bb-df7108bb3362&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:315,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e0464cf8-b194-4ad6-9874-c8ae6f4a915d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:315,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?select=type,rx_bytes,tx_errors,tx_dropped,mac\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.items[0].should.have.properties([&#x27;type&#x27;, &#x27;rx_bytes&#x27;, &#x27;tx&#x27;, &#x27;mac&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3505ca29-010b-401a-b46d-58c8a989cc7e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:297,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ab79533b-4242-46c3-aaf1-a3d4000a9c7e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:315,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ab40750f-3bd3-4ec2-839b-3843dfaa596b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;684b3439-e5a1-41df-a8d8-82f49aae8e08&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:334,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?search=\&quot; + expected_mac)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].mac.should.be.equal(expected_mac);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;99fdaf5e-6dea-4df7-93f0-ecbb686ac106&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:80,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fe6d29d6-b100-4d01-bc12-f92e35dad02b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:306,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?sort=-wrongParameter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1403);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0dfa29fb-fa5c-4007-a654-2191dc8e08fe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: name&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Filter: name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:334,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?name=\&quot; + expected_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].name.should.be.equal(expected_name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9a97b41e-b6eb-4c76-9839-11b31130bb85&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: type&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Filter: type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:321,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?type=\&quot; + expected_type)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].type.should.be.equal(expected_type);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;191b902b-6271-4b86-baec-b5f0035959bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: state&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Filter: state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:314,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?state=\&quot; + expected_state)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].state.should.be.equal(expected_state);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;41eb4ed2-a7d8-4de7-8359-a92544eacbe5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: mtu&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Filter: mtu&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:320,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?mtu=\&quot; + expected_mtu)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].mtu.should.be.equal(expected_mtu);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9a4404a5-c5d5-4c11-a4a7-53da87589990&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: tx_packets&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Filter: tx_packets&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:310,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?tx_packets=\&quot; + expected_tx_packets)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].tx.packets.should.be.equal(expected_tx_packets);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;edd77d72-0b87-483b-9407-742dd9601124&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: rx_packets&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Filter: rx_packets&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:315,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?rx_packets=\&quot; + expected_rx_packets)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].rx.packets.should.be.equal(expected_rx_packets);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6be0e095-88c4-42f6-b9ea-d3decc9b53bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: tx_bytes&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Filter: tx_bytes&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:318,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?tx_bytes=\&quot; + expected_tx_bytes)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].tx.bytes.should.be.equal(expected_tx_bytes);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;88c14d9b-d477-41ac-afa2-2cffcd605c58&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: rx_bytes&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Filter: rx_bytes&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:318,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?rx_bytes=\&quot; + expected_rx_bytes)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].rx.bytes.should.be.equal(expected_rx_bytes);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d4da37cf-0876-44ab-ac1f-e4a81ccb39dd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: tx_errors&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Filter: tx_errors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:319,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?tx_errors=\&quot; + expected_tx_errors)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].tx.errors.should.be.equal(expected_tx_errors);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3238a2ec-77cf-400a-aa90-d7f00849dd86&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: rx_errors&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Filter: rx_errors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:315,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?rx_errors=\&quot; + expected_rx_errors)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].rx.errors.should.be.equal(expected_rx_errors);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b021fef4-d28e-4f37-b9e3-e520019c999a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: tx_dropped&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Filter: tx_dropped&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:320,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?tx_dropped=\&quot; + expected_tx_dropped)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].tx.dropped.should.be.equal(expected_tx_dropped);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;64c9b94e-63d2-47d9-92e2-65facfa51f8a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: rx_dropped&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Filter: rx_dropped&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:328,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?rx_dropped=\&quot; + expected_rx_dropped)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].rx.dropped.should.be.equal(expected_rx_dropped);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;dcb8d189-4cd5-4d0c-8d35-774945cf574d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/experimental/syscollector/netiface Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:319,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/experimental/syscollector/netiface?q=rx_dropped&gt;\&quot; + expected_rx_dropped)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ca50f777-7353-4e4c-a62e-043ed09283c3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e0464cf8-b194-4ad6-9874-c8ae6f4a915d&quot;,&quot;3505ca29-010b-401a-b46d-58c8a989cc7e&quot;,&quot;ab79533b-4242-46c3-aaf1-a3d4000a9c7e&quot;,&quot;ab40750f-3bd3-4ec2-839b-3843dfaa596b&quot;,&quot;684b3439-e5a1-41df-a8d8-82f49aae8e08&quot;,&quot;99fdaf5e-6dea-4df7-93f0-ecbb686ac106&quot;,&quot;fe6d29d6-b100-4d01-bc12-f92e35dad02b&quot;,&quot;0dfa29fb-fa5c-4007-a654-2191dc8e08fe&quot;,&quot;9a97b41e-b6eb-4c76-9839-11b31130bb85&quot;,&quot;191b902b-6271-4b86-baec-b5f0035959bc&quot;,&quot;41eb4ed2-a7d8-4de7-8359-a92544eacbe5&quot;,&quot;9a4404a5-c5d5-4c11-a4a7-53da87589990&quot;,&quot;edd77d72-0b87-483b-9407-742dd9601124&quot;,&quot;6be0e095-88c4-42f6-b9ea-d3decc9b53bd&quot;,&quot;88c14d9b-d477-41ac-afa2-2cffcd605c58&quot;,&quot;d4da37cf-0876-44ab-ac1f-e4a81ccb39dd&quot;,&quot;3238a2ec-77cf-400a-aa90-d7f00849dd86&quot;,&quot;b021fef4-d28e-4f37-b9e3-e520019c999a&quot;,&quot;64c9b94e-63d2-47d9-92e2-65facfa51f8a&quot;,&quot;dcb8d189-4cd5-4d0c-8d35-774945cf574d&quot;,&quot;ca50f777-7353-4e4c-a62e-043ed09283c3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6191,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;ad9263c5-e249-441e-9a7e-1bfaa0b8496b&quot;,&quot;title&quot;:&quot;GET/syscollector/000/processes&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:352,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        expected_state = res.body.data.items[0].state;\n        expected_ppid = res.body.data.items[0].ppid;\n        expected_egroup = res.body.data.items[0].egroup;\n        expected_euser = res.body.data.items[0].euser;\n        expected_fgroup = res.body.data.items[0].fgroup;\n        expected_name = res.body.data.items[0].name;\n        expected_nlwp = res.body.data.items[0].nlwp;\n        expected_pgrp = res.body.data.items[0].pgrp;\n        expected_priority = res.body.data.items[0].priority;\n        expected_rgroup = res.body.data.items[0].rgroup;\n        expected_ruser = res.body.data.items[0].ruser;\n        expected_sgroup = res.body.data.items[0].sgroup;\n        expected_suser = res.body.data.items[0].suser;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;49eacce6-e702-49bb-a18a-156487901851&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(processes_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e7efc032-5c32-431f-bf5f-dd5206eda7aa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?select=tty,sgroup,share,session,scan_id\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;tty&#x27;, &#x27;sgroup&#x27;, &#x27;share&#x27;, &#x27;session&#x27;, &#x27;scan&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3df3c2a6-be67-4232-a26d-3cd40647dbad&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:266,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;67eaf7ba-765a-44f1-91b0-737cc1dfecdf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;53979b1b-44f7-4a86-8bcd-654254c7ee9a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2f098b43-84ca-4e93-b1f4-4914ba5306a3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?search=\&quot; + expected_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].name.should.be.equal(expected_name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f06d54de-d5be-4b10-b1e7-f4df70890ab3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d6005013-7380-4387-aff6-3af761f6becf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?sort=-wrongParameter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1403);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1b0d41e3-449c-43ef-be3a-8bb7873456de&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: state&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Filter: state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:281,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?limit=2&amp;offset=1&amp;state=\&quot; + expected_state)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].state.should.be.equal(expected_state);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1b45ae7e-4d8d-4b5b-8c20-0baccd97bff4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: ppid&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Filter: ppid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?limit=2&amp;offset=1&amp;ppid=\&quot; + expected_ppid)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].ppid.should.be.equal(expected_ppid);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;09f7ebc4-3064-4f29-9d17-49495b3061fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: egroup&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Filter: egroup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?limit=2&amp;offset=1&amp;egroup=\&quot; + expected_egroup)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].egroup.should.be.equal(expected_egroup);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;987f8ee1-a324-46c0-86ff-88b322fe8c7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: euser&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Filter: euser&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:291,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?limit=2&amp;offset=1&amp;euser=\&quot; + expected_euser)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].euser.should.be.equal(expected_euser);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1a8f27a3-8d1f-40d6-803e-a94dc79f79a6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: fgroup&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Filter: fgroup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:286,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?limit=2&amp;offset=1&amp;fgroup=\&quot; + expected_fgroup)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].fgroup.should.be.equal(expected_fgroup);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8b39ab4f-b23d-480d-bbaa-e21f4168577d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: name&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Filter: name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:290,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?name=\&quot; + expected_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].name.should.be.equal(expected_name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0cbe9819-b612-4d30-b3e9-55ae06cbbc57&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: nlwp&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Filter: nlwp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?limit=2&amp;offset=1&amp;nlwp=\&quot; + expected_nlwp)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].nlwp.should.be.equal(expected_nlwp);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7227c405-6611-4679-b3ec-c4ed6b982a6d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: pgrp&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Filter: pgrp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?pgrp=\&quot; + expected_pgrp)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].pgrp.should.be.equal(expected_pgrp);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;88dfae78-995f-4a40-8155-c1d1f967768e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: priority&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Filter: priority&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?limit=2&amp;offset=1&amp;priority=\&quot; + expected_priority)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].priority.should.be.equal(expected_priority);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7e8a661b-4593-47ad-a143-e215195d46a2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: rgroup&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Filter: rgroup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:268,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?limit=2&amp;offset=1&amp;rgroup=\&quot; + expected_rgroup)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].rgroup.should.be.equal(expected_rgroup);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f8fd4b17-1da6-4015-a50a-b4f344a3b14b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: ruser&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Filter: ruser&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:268,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?limit=2&amp;offset=1&amp;ruser=\&quot; + expected_ruser)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].ruser.should.be.equal(expected_ruser);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;bb887d88-f9bc-4a40-a7c6-8183d923f254&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: sgroup&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Filter: sgroup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?limit=2&amp;offset=1&amp;sgroup=\&quot; + expected_sgroup)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].sgroup.should.be.equal(expected_sgroup);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c7f3927e-6dca-494f-ac20-704cfbfdf91f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: suser&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Filter: suser&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?limit=2&amp;offset=1&amp;suser=\&quot; + expected_suser)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].suser.should.be.equal(expected_suser);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4b8b983c-4ecf-4d2f-9f30-642fb30b3322&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/processes Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:284,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/processes?q=suser!=\&quot; + expected_suser)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(processes_properties);\n        res.body.data.items[0].suser.should.not.be.equal(expected_suser);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d1930649-e4a3-471f-940b-fdfda958eddc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e7efc032-5c32-431f-bf5f-dd5206eda7aa&quot;,&quot;3df3c2a6-be67-4232-a26d-3cd40647dbad&quot;,&quot;67eaf7ba-765a-44f1-91b0-737cc1dfecdf&quot;,&quot;53979b1b-44f7-4a86-8bcd-654254c7ee9a&quot;,&quot;2f098b43-84ca-4e93-b1f4-4914ba5306a3&quot;,&quot;f06d54de-d5be-4b10-b1e7-f4df70890ab3&quot;,&quot;d6005013-7380-4387-aff6-3af761f6becf&quot;,&quot;1b0d41e3-449c-43ef-be3a-8bb7873456de&quot;,&quot;1b45ae7e-4d8d-4b5b-8c20-0baccd97bff4&quot;,&quot;09f7ebc4-3064-4f29-9d17-49495b3061fa&quot;,&quot;987f8ee1-a324-46c0-86ff-88b322fe8c7a&quot;,&quot;1a8f27a3-8d1f-40d6-803e-a94dc79f79a6&quot;,&quot;8b39ab4f-b23d-480d-bbaa-e21f4168577d&quot;,&quot;0cbe9819-b612-4d30-b3e9-55ae06cbbc57&quot;,&quot;7227c405-6611-4679-b3ec-c4ed6b982a6d&quot;,&quot;88dfae78-995f-4a40-8155-c1d1f967768e&quot;,&quot;7e8a661b-4593-47ad-a143-e215195d46a2&quot;,&quot;f8fd4b17-1da6-4015-a50a-b4f344a3b14b&quot;,&quot;bb887d88-f9bc-4a40-a7c6-8183d923f254&quot;,&quot;c7f3927e-6dca-494f-ac20-704cfbfdf91f&quot;,&quot;4b8b983c-4ecf-4d2f-9f30-642fb30b3322&quot;,&quot;d1930649-e4a3-471f-940b-fdfda958eddc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5682,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;1b348018-0b32-4414-9947-d2737e9525c2&quot;,&quot;title&quot;:&quot;GET/syscollector/000/ports&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:273,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        expected_protocol = res.body.data.items[0].protocol;\n        expected_local_ip = res.body.data.items[0].local.ip;\n        expected_local_port = res.body.data.items[0].local.port;\n        expected_remote_ip = res.body.data.items[0].remote.ip;\n        expected_tx_queue = res.body.data.items[0].tx_queue;\n        expected_state = res.body.data.items[0].state;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7237bfd9-0059-4180-8c6b-58547fc5ac23&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(ports_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;be108985-b9c7-436e-a817-3bc03476b017&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:273,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?select=protocol,remote_ip,tx_queue,state\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;protocol&#x27;, &#x27;remote&#x27;, &#x27;tx_queue&#x27;, &#x27;state&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0f2e5965-db25-4e53-847c-e597ad46871d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ee28fee3-1f64-4d0e-b6ef-5e14e1dd3704&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;715c1bb4-74ac-455e-8f41-1b1312cab325&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8286c689-46f3-4141-8d41-86b307c9637e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?search=\&quot; + expected_remote_ip)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].remote.ip.should.be.equal(expected_remote_ip);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;de7ea54e-994f-432a-b84c-e6f1c7f68167&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;50006e6e-51e6-410e-aad3-e94ccc055c31&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?sort=-wrongParameter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1403);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;863b288c-76ae-451e-a25e-d47766539507&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: protocol&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Filter: protocol&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?protocol=\&quot; + expected_protocol)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].protocol.should.be.equal(expected_protocol);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4842944c-08b4-41ac-9305-0a43e22203c2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: local_ip&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Filter: local_ip&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?local_ip=\&quot; + expected_local_ip)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].local.ip.should.be.equal(expected_local_ip);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e9642a93-61a3-4b37-a63f-4e4c81dc94a0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: local_port&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Filter: local_port&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?local_port=\&quot; + expected_local_port)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].local.port.should.be.equal(expected_local_port);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;40767fca-9c6c-4c62-bc7a-26974ec394c7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: remote_ip&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Filter: remote_ip&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?remote_ip=\&quot; + expected_remote_ip)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].remote.ip.should.be.equal(expected_remote_ip);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;486543bb-6161-4c15-b4df-33d1d04b5da8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: tx_queue&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Filter: tx_queue&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?tx_queue=\&quot; + expected_tx_queue)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].tx_queue.should.be.equal(expected_tx_queue);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c219119b-c305-486f-ab6c-1cf276e9cc5b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: state&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Filter: state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?state=\&quot; + expected_state)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].state.should.be.equal(expected_state);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1b825565-39e2-4871-bda0-3720fd108eb8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/ports Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/ports?q=state=\&quot; + expected_state)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(ports_properties);\n        res.body.data.items[0].state.should.be.equal(expected_state);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;51272bb0-16ae-481e-8534-b8380c6802c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;be108985-b9c7-436e-a817-3bc03476b017&quot;,&quot;0f2e5965-db25-4e53-847c-e597ad46871d&quot;,&quot;ee28fee3-1f64-4d0e-b6ef-5e14e1dd3704&quot;,&quot;715c1bb4-74ac-455e-8f41-1b1312cab325&quot;,&quot;8286c689-46f3-4141-8d41-86b307c9637e&quot;,&quot;de7ea54e-994f-432a-b84c-e6f1c7f68167&quot;,&quot;50006e6e-51e6-410e-aad3-e94ccc055c31&quot;,&quot;863b288c-76ae-451e-a25e-d47766539507&quot;,&quot;4842944c-08b4-41ac-9305-0a43e22203c2&quot;,&quot;e9642a93-61a3-4b37-a63f-4e4c81dc94a0&quot;,&quot;40767fca-9c6c-4c62-bc7a-26974ec394c7&quot;,&quot;486543bb-6161-4c15-b4df-33d1d04b5da8&quot;,&quot;c219119b-c305-486f-ab6c-1cf276e9cc5b&quot;,&quot;1b825565-39e2-4871-bda0-3720fd108eb8&quot;,&quot;51272bb0-16ae-481e-8534-b8380c6802c9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3753,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;ec7cecc9-b110-45cc-bcf5-4b3a26c32540&quot;,&quot;title&quot;:&quot;GET/syscollector/000/netaddr&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        expected_iface = res.body.data.items[0].iface;\n        expected_proto = res.body.data.items[0].proto;\n        expected_address = res.body.data.items[0].address;\n        expected_broadcast = res.body.data.items[0].broadcast;\n        expected_netmask = res.body.data.items[0].netmask;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;58a2c722-0a58-4c01-b850-b17f42c8153f&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;45890494-a1bc-46f6-8bb7-82c8f87ab5ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?select=proto,netmask,broadcast\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;proto&#x27;, &#x27;netmask&#x27;, &#x27;broadcast&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5f20556a-1be8-4a0a-95e4-cfe34c5d81ed&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;302e24b7-199b-48bb-be5b-43babf7639e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;04f9fd63-25da-4c8e-a709-9db50c33a54b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;660e2a87-5ec0-43c3-8006-a7dc66e40506&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?search=\&quot; + expected_broadcast)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].broadcast.should.be.equal(expected_broadcast);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2157eb0f-4867-4056-a9fe-4c6361c6ed0e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a6a9d2e2-6888-41f9-a1e0-e3478f45ca5d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?sort=-wrongParameter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1403);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;40d0de18-1952-4f8b-ae52-22cb41a70eb6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: iface&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Filter: iface&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?iface=\&quot; + expected_iface)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].iface.should.be.equal(expected_iface);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;41f74587-fae2-48a8-848d-d8fdffaaa08e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: proto&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Filter: proto&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?proto=\&quot; + expected_proto)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].proto.should.be.equal(expected_proto);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;70d34845-ed40-49a9-a69b-417ab4125242&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: address&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Filter: address&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:284,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?address=\&quot; + expected_address)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].address.should.be.equal(expected_address);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f025e993-6a8f-4031-875c-1e1c0acd8c7d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: broadcast&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Filter: broadcast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:286,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?broadcast=\&quot; + expected_broadcast)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].broadcast.should.be.equal(expected_broadcast);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2c42bd1a-d90c-4ec0-9512-de855d951c64&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: netmask&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Filter: netmask&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?netmask=\&quot; + expected_netmask)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].netmask.should.be.equal(expected_netmask);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c43ed3e8-efad-4ca1-8df3-e7622e0532a6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netaddr Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netaddr?q=netmask=\&quot; + expected_netmask)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netaddr_properties);\n        res.body.data.items[0].netmask.should.be.equal(expected_netmask);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f666fa67-042f-4ecf-9ea5-02f14494a1f1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;45890494-a1bc-46f6-8bb7-82c8f87ab5ea&quot;,&quot;5f20556a-1be8-4a0a-95e4-cfe34c5d81ed&quot;,&quot;302e24b7-199b-48bb-be5b-43babf7639e2&quot;,&quot;04f9fd63-25da-4c8e-a709-9db50c33a54b&quot;,&quot;660e2a87-5ec0-43c3-8006-a7dc66e40506&quot;,&quot;2157eb0f-4867-4056-a9fe-4c6361c6ed0e&quot;,&quot;a6a9d2e2-6888-41f9-a1e0-e3478f45ca5d&quot;,&quot;40d0de18-1952-4f8b-ae52-22cb41a70eb6&quot;,&quot;41f74587-fae2-48a8-848d-d8fdffaaa08e&quot;,&quot;70d34845-ed40-49a9-a69b-417ab4125242&quot;,&quot;f025e993-6a8f-4031-875c-1e1c0acd8c7d&quot;,&quot;2c42bd1a-d90c-4ec0-9512-de855d951c64&quot;,&quot;c43ed3e8-efad-4ca1-8df3-e7622e0532a6&quot;,&quot;f666fa67-042f-4ecf-9ea5-02f14494a1f1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3518,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;4c131b6c-1ed0-469d-8ad8-65eecab9d8ea&quot;,&quot;title&quot;:&quot;GET/syscollector/000/netproto&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        expected_iface = res.body.data.items[0].iface;\n        expected_type = res.body.data.items[0].type;\n        expected_gateway = res.body.data.items[0].gateway;\n        expected_dhcp = res.body.data.items[0].dhcp;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c2dfd5f2-1426-4f42-b487-1454b1745e4c&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:281,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3197b6ff-17c3-4a99-adc3-73d90bda2745&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto?select=iface,gateway,dhcp\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;iface&#x27;, &#x27;gateway&#x27;, &#x27;dhcp&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;504e7437-7c9d-4cb5-ad1d-061eb473e8a8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;033f61e9-5f6c-4086-bdcd-a963e27cf2e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:287,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;dd968531-0b7c-4a12-942a-ab77f0a4f83d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d2f02e42-6657-44f7-8f99-801f6b63d32b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto?search=\&quot; + expected_dhcp)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        res.body.data.items[0].dhcp.should.be.equal(expected_dhcp);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;dc73440a-a770-4dcd-8593-15ab7504f0fd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b4740f2f-f91c-42d1-98f3-cbaa415bdc08&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto?sort=-wrongParameter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1403);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e44a3db4-3cf1-42b2-941e-e228fa2cce11&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: iface&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto Filter: iface&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:285,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto?iface=\&quot; + expected_iface)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        res.body.data.items[0].iface.should.be.equal(expected_iface);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;bace0c9c-cdfb-4346-979e-43d874e10a93&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: type&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto Filter: type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto?type=\&quot; + expected_type)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        res.body.data.items[0].type.should.be.equal(expected_type);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;971f97ce-3a6d-4b61-ab5c-e85bd9da0e67&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: gateway&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto Filter: gateway&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:284,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto?gateway=\&quot; + expected_gateway)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        res.body.data.items[0].gateway.should.be.equal(expected_gateway);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d7dd1b12-4a16-4e06-a37f-dd9af1e424c4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: dhcp&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto Filter: dhcp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto?dhcp=\&quot; + expected_dhcp)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netproto_properties);\n        res.body.data.items[0].dhcp.should.be.equal(expected_dhcp);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;af67914f-dc20-4184-9633-14f48eac292b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netproto Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:284,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netproto?q=dhcp!=\&quot; + expected_dhcp)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0665338e-067c-4ed7-9c63-99064a1c3302&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3197b6ff-17c3-4a99-adc3-73d90bda2745&quot;,&quot;504e7437-7c9d-4cb5-ad1d-061eb473e8a8&quot;,&quot;033f61e9-5f6c-4086-bdcd-a963e27cf2e0&quot;,&quot;dd968531-0b7c-4a12-942a-ab77f0a4f83d&quot;,&quot;d2f02e42-6657-44f7-8f99-801f6b63d32b&quot;,&quot;dc73440a-a770-4dcd-8593-15ab7504f0fd&quot;,&quot;b4740f2f-f91c-42d1-98f3-cbaa415bdc08&quot;,&quot;e44a3db4-3cf1-42b2-941e-e228fa2cce11&quot;,&quot;bace0c9c-cdfb-4346-979e-43d874e10a93&quot;,&quot;971f97ce-3a6d-4b61-ab5c-e85bd9da0e67&quot;,&quot;d7dd1b12-4a16-4e06-a37f-dd9af1e424c4&quot;,&quot;af67914f-dc20-4184-9633-14f48eac292b&quot;,&quot;0665338e-067c-4ed7-9c63-99064a1c3302&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3244,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;7a6ef0a3-adae-4954-96d7-e5225cbc96c7&quot;,&quot;title&quot;:&quot;GET/syscollector/000/netiface&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:292,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        expected_name = res.body.data.items[0].name;\n        expected_adapter = res.body.data.items[0].adapter;\n        expected_type = res.body.data.items[0].type;\n        expected_state = res.body.data.items[0].state;\n        expected_mtu = res.body.data.items[0].mtu;\n        expected_tx_packets = res.body.data.items[0].tx.packets;\n        expected_rx_packets = res.body.data.items[0].rx.packets;\n        expected_tx_bytes = res.body.data.items[0].tx.bytes;\n        expected_rx_bytes = res.body.data.items[0].rx.bytes;\n        expected_tx_errors = res.body.data.items[0].tx.errors;\n        expected_rx_errors = res.body.data.items[0].rx.errors;\n        expected_tx_dropped = res.body.data.items[0].tx.dropped;\n        expected_rx_dropped = res.body.data.items[0].rx.dropped;\n        expected_mac = res.body.data.items[0].mac;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;776de8ba-3578-4721-9a7a-eb5cd8366419&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:293,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;230a5a25-2fd7-46f4-98a0-75bfacf6053a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?select=type,rx_bytes,tx_errors,tx_dropped,mac\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.items[0].should.have.properties([&#x27;type&#x27;, &#x27;rx_bytes&#x27;, &#x27;tx&#x27;, &#x27;mac&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;517069c1-8e4d-4257-930f-7d61e8426603&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:287,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?select=wrongParam\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d7b91302-7f64-4a22-ba47-ce8a3d4cf482&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;10b29908-c9bb-4609-951c-0501cadbdb61&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:79,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?offset=0&amp;limit=1a\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(600);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9ed4f7bd-ce97-4a39-b495-6b06fbe72e59&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:317,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?search=\&quot; + expected_mac)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].mac.should.be.equal(expected_mac);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7bf2543e-e9ba-4885-a9ba-2dea3cf0315c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong filter&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Wrong filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:82,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?wrongFilter=value\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(604);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;902dbfb7-e9f7-461e-8577-3e6e975248f9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?sort=-wrongParameter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1403);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c2947c6c-3eaf-4756-82df-b38875be3d1d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: name&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Filter: name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:296,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?name=\&quot; + expected_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].name.should.be.equal(expected_name);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;129d5053-dde2-4fb7-bc63-c7691d7ebded&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: type&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Filter: type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:286,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?type=\&quot; + expected_type)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].type.should.be.equal(expected_type);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3e1795ca-49c8-48c4-a0e5-a65e82ef54ac&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: state&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Filter: state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?state=\&quot; + expected_state)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].state.should.be.equal(expected_state);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;debc1a37-e69d-4e08-9128-5e1b0725ef49&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: mtu&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Filter: mtu&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?mtu=\&quot; + expected_mtu)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].mtu.should.be.equal(expected_mtu);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3640eca9-4072-46ba-b66a-7ddb2478e760&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: tx_packets&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Filter: tx_packets&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?tx_packets=\&quot; + expected_tx_packets)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].tx.packets.should.be.equal(expected_tx_packets);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a4409fbd-c10c-4c0c-837a-a21fc7380a21&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: rx_packets&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Filter: rx_packets&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?rx_packets=\&quot; + expected_rx_packets)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].rx.packets.should.be.equal(expected_rx_packets);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e3cf7a04-ae48-4e34-869a-a97586e32593&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: tx_bytes&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Filter: tx_bytes&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?tx_bytes=\&quot; + expected_tx_bytes)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].tx.bytes.should.be.equal(expected_tx_bytes);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9eac946f-c862-4c7e-8dce-7170e01952dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: rx_bytes&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Filter: rx_bytes&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?rx_bytes=\&quot; + expected_rx_bytes)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].rx.bytes.should.be.equal(expected_rx_bytes);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1937abda-a929-4474-961a-29067699668d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: tx_errors&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Filter: tx_errors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?tx_errors=\&quot; + expected_tx_errors)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].tx.errors.should.be.equal(expected_tx_errors);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f38925af-819b-4b14-8516-f9db81477935&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: rx_errors&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Filter: rx_errors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:287,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?rx_errors=\&quot; + expected_rx_errors)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].rx.errors.should.be.equal(expected_rx_errors);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d605d204-9346-48cb-b4f2-4d9752d356d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: tx_dropped&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Filter: tx_dropped&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:292,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?tx_dropped=\&quot; + expected_tx_dropped)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].tx.dropped.should.be.equal(expected_tx_dropped);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f460333d-1f64-4eb0-a04e-ad09aa127554&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: rx_dropped&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Filter: rx_dropped&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:285,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?rx_dropped=\&quot; + expected_rx_dropped)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.items[0].should.have.properties(netiface_properties);\n        res.body.data.items[0].rx.dropped.should.be.equal(expected_rx_dropped);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ad83afdf-ad77-4fc0-b420-c60a3acd8148&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Query&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/000/netiface Query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:281,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/syscollector/\&quot; + agent_id + \&quot;/netiface?q=rx_dropped&gt;\&quot; + expected_rx_dropped)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e2d33039-8a36-4fd1-a4fb-c3be7ba64464&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;230a5a25-2fd7-46f4-98a0-75bfacf6053a&quot;,&quot;517069c1-8e4d-4257-930f-7d61e8426603&quot;,&quot;d7b91302-7f64-4a22-ba47-ce8a3d4cf482&quot;,&quot;10b29908-c9bb-4609-951c-0501cadbdb61&quot;,&quot;9ed4f7bd-ce97-4a39-b495-6b06fbe72e59&quot;,&quot;7bf2543e-e9ba-4885-a9ba-2dea3cf0315c&quot;,&quot;902dbfb7-e9f7-461e-8577-3e6e975248f9&quot;,&quot;c2947c6c-3eaf-4756-82df-b38875be3d1d&quot;,&quot;129d5053-dde2-4fb7-bc63-c7691d7ebded&quot;,&quot;3e1795ca-49c8-48c4-a0e5-a65e82ef54ac&quot;,&quot;debc1a37-e69d-4e08-9128-5e1b0725ef49&quot;,&quot;3640eca9-4072-46ba-b66a-7ddb2478e760&quot;,&quot;a4409fbd-c10c-4c0c-837a-a21fc7380a21&quot;,&quot;e3cf7a04-ae48-4e34-869a-a97586e32593&quot;,&quot;9eac946f-c862-4c7e-8dce-7170e01952dc&quot;,&quot;1937abda-a929-4474-961a-29067699668d&quot;,&quot;f38925af-819b-4b14-8516-f9db81477935&quot;,&quot;d605d204-9346-48cb-b4f2-4d9752d356d9&quot;,&quot;f460333d-1f64-4eb0-a04e-ad09aa127554&quot;,&quot;ad83afdf-ad77-4fc0-b420-c60a3acd8148&quot;,&quot;e2d33039-8a36-4fd1-a4fb-c3be7ba64464&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5554,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;68482d8a-70b9-4a0e-98bf-7d64331b3264&quot;,&quot;title&quot;:&quot;GET/syscollector/:agent_id/hotfixes&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_syscollector.js&quot;,&quot;file&quot;:&quot;/test/test_syscollector.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hotfixes \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;query = \&quot;agent 001 sql insert or ignore into sys_hotfixes(scan_id, scan_time, hotfix) values\&quot; +\n    \&quot;(1408519641, &#x27;2019/08/05 12:06:26&#x27;, &#x27;KB2533552&#x27;),\&quot; +\n    \&quot;(1408519641, &#x27;2019/08/05 12:06:26&#x27;, &#x27;KB2534366&#x27;),\&quot; +\n    \&quot;(1408519641, &#x27;2019/08/05 12:06:26&#x27;, &#x27;KB2562937&#x27;),\&quot; +\n    \&quot;(1408519641, &#x27;2019/08/05 12:06:26&#x27;, &#x27;KB2998812&#x27;),\&quot; +\n    \&quot;(1408519641, &#x27;2019/08/05 12:06:26&#x27;, &#x27;KB3004469&#x27;),\&quot; +\n    \&quot;(1408519641, &#x27;2019/08/05 12:06:26&#x27;, &#x27;KB3015428&#x27;);\&quot;\nspawn(&#x27;python3&#x27;, [wdb_script_path, &#x27;-q&#x27;, query])&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b2997b26-cbc1-482b-b0bb-075d3a21e3df&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hotfixes \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;query = \&quot;agent 001 sql delete from sys_hotfixes;\&quot;\nspawn(&#x27;python3&#x27;, [wdb_script_path, &#x27;-q&#x27;, query])&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ef5d5166-d657-4e9e-8504-b61979c4767c&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hotfixes Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/syscollector/\&quot; + agent_hotfixes + \&quot;/hotfixes\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err)\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;])\n        res.body.error.should.equal(0)\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;])\n        res.body.data.totalItems.should.be.above(0)\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(hotfixes_fields)\n        res.body.data.items[0].scan.should.have.properties(scan_fields)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0b060822-7774-4d6a-af60-2042e3293332&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hotfixes Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/syscollector/\&quot; + agent_hotfixes + \&quot;/hotfixes?select=hotfix\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err)\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;])\n        res.body.error.should.equal(0)\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;])\n        res.body.data.totalItems.should.be.above(0)\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;hotfix&#x27;])\n        done();\n    });run&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;592d35b0-53f0-4e40-829d-bcfae31ea403&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hotfixes Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:285,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/syscollector/\&quot; + agent_hotfixes + \&quot;/hotfixes?select=date\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err)\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;])\n        res.body.error.should.equal(1724)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;01771df4-4680-4b8a-9fd5-a14dd43b6687&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hotfixes Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/syscollector/\&quot; + agent_hotfixes + \&quot;/hotfixes?offset=1&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err)\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;])\n        res.body.error.should.equal(0)\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;])\n        res.body.data.totalItems.should.be.above(0)\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(hotfixes_fields)\n        res.body.data.items[0].scan.should.have.properties(scan_fields)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1b65f3da-2b19-4cc1-badb-555d04c0a3ce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong limit&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hotfixes Wrong limit&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:286,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/syscollector/\&quot; + agent_hotfixes + \&quot;/hotfixes?limit=1000000\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err)\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;])\n        res.body.error.should.equal(1405)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;06af9f58-4455-426d-be73-49c9b946a0e7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Sort -&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hotfixes Sort -&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/syscollector/\&quot; + agent_hotfixes + \&quot;/hotfixes?sort=-hotfix\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err)\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;])\n        res.body.error.should.equal(0)\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;])\n        res.body.data.totalItems.should.be.above(0)\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(hotfixes_fields)\n        res.body.data.items[0].scan.should.have.properties(scan_fields)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ef7da7ca-f540-4eac-9c8c-6dbc30f15ba9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Sort +&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hotfixes Sort +&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/syscollector/\&quot; + agent_hotfixes + \&quot;/hotfixes?sort=+hotfix\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err)\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;])\n        res.body.error.should.equal(0)\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;])\n        res.body.data.totalItems.should.be.above(0)\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(hotfixes_fields)\n        res.body.data.items[0].scan.should.have.properties(scan_fields)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9b255271-a900-493a-b489-416b22f94704&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hotfixes Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:285,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/syscollector/\&quot; + agent_hotfixes + \&quot;/hotfixes?search=KB2562937\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err)\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;])\n        res.body.error.should.equal(0)\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;])\n        res.body.data.totalItems.should.be.above(0)\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(hotfixes_fields)\n        res.body.data.items[0].scan.should.have.properties(scan_fields)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;af62c6e8-7833-4579-9e67-4d452416c49e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: hotfix&quot;,&quot;fullTitle&quot;:&quot;Syscollector GET/syscollector/:agent_id/hotfixes Filter: hotfix&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/syscollector/\&quot; + agent_hotfixes + \&quot;/hotfixes?hotfix=KB2562937\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err)\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;])\n        res.body.error.should.equal(0)\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;])\n        res.body.data.totalItems.should.be.above(0)\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(hotfixes_fields)\n        res.body.data.items[0].scan.should.have.properties(scan_fields)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;de02c63f-c9ff-4d3c-a456-ddf7e584f54f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0b060822-7774-4d6a-af60-2042e3293332&quot;,&quot;592d35b0-53f0-4e40-829d-bcfae31ea403&quot;,&quot;01771df4-4680-4b8a-9fd5-a14dd43b6687&quot;,&quot;1b65f3da-2b19-4cc1-badb-555d04c0a3ce&quot;,&quot;06af9f58-4455-426d-be73-49c9b946a0e7&quot;,&quot;ef7da7ca-f540-4eac-9c8c-6dbc30f15ba9&quot;,&quot;9b255271-a900-493a-b489-416b22f94704&quot;,&quot;af62c6e8-7833-4579-9e67-4d452416c49e&quot;,&quot;de02c63f-c9ff-4d3c-a456-ddf7e584f54f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2537,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:10000},&quot;copyrightYear&quot;:2020}" data-config="{&quot;reportFilename&quot;:&quot;syscollector&quot;,&quot;reportDir&quot;:&quot;/share&quot;,&quot;reportTitle&quot;:&quot;wazuh-api&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:true,&quot;enableCharts&quot;:true,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;/share/assets&quot;,&quot;jsonFile&quot;:&quot;/share/syscollector.json&quot;,&quot;htmlFile&quot;:&quot;/share/syscollector.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>