<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:11,&quot;tests&quot;:29,&quot;passes&quot;:29,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2020-06-08T12:17:22.794Z&quot;,&quot;end&quot;:&quot;2020-06-08T12:17:32.573Z&quot;,&quot;duration&quot;:9779,&quot;testsRegistered&quot;:29,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false,&quot;passPercentClass&quot;:&quot;success&quot;,&quot;pendingPercentClass&quot;:&quot;danger&quot;},&quot;suites&quot;:{&quot;uuid&quot;:&quot;c8c4f006-5cc1-4443-9f01-2cff3ff6a9ee&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;67e6dc35-fbd4-4a1a-924e-e4788d0926ae&quot;,&quot;title&quot;:&quot;Agents&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents_2.js&quot;,&quot;file&quot;:&quot;/test/test_agents_2.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8959cbd5-d8de-410f-9948-5a9f0d58cecf&quot;,&quot;title&quot;:&quot;PUT/agents/:agent_name&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents_2.js&quot;,&quot;file&quot;:&quot;/test/test_agents_2.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook: Request&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_name \&quot;before all\&quot; hook: Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:368,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.put(\&quot;/agents/testingNewAgent%2520Put\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;id&#x27;, &#x27;key&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.id.should.match(/^\\d+$/);\n    res.body.data.key.should.match(/^[a-zA-Z0-9=]+$/);\n    agent_id = res.body.data.id;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ee3a7321-8022-47ef-bfd1-918ec285c4ca&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_name \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/agents/\&quot; + agent_id + &#x27;?purge&#x27;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) return done(err);\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a00020dc-7a6b-46fc-bd7a-d4dbe1433a18&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_name Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .put(\&quot;/agents/testingNewAgentPut\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.data.should.have.properties([&#x27;id&#x27;, &#x27;key&#x27;]);\n                res.body.error.should.equal(0);\n                res.body.data.id.should.match(/^\\d+$/);\n                res.body.data.key.should.match(/^[a-zA-Z0-9=]+$/);\n                agent_id = res.body.data.id;\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c00b58ff-30f5-4dd7-9902-0106eb892057&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: Name already present&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_name Errors: Name already present&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .put(\&quot;/agents/testingNewAgentPut\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                if (is_auth_d_running()) res.body.error.should.equal(9008);\n                else                     res.body.error.should.equal(1705);\n                res.body.message.should.be.type(&#x27;string&#x27;);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;06ef9cf2-9ace-4346-a620-e5853f3aef86&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad agent name&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_name Params: Bad agent name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.put(\&quot;/agents/testingNewAgent!!\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(601);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c5c34bf2-92c0-4e80-a320-90a2a5399838&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: New character (%) in agent name&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_name Params: New character (%) in agent name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/name/testingNewAgent%2520Put\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;id&#x27;, &#x27;node_name&#x27;, &#x27;ip&#x27;, &#x27;dateAdd&#x27;, &#x27;status&#x27;, &#x27;registerIP&#x27;, &#x27;name&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.id.should.match(/^\\d+$/);\n    res.body.data.name.should.match(/^[a-zA-Z0-9_\\-.%]+$/);\n    agent_id = res.body.data.id;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6acad1a6-2ad2-4d63-9bec-13c3e018254b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c00b58ff-30f5-4dd7-9902-0106eb892057&quot;,&quot;06ef9cf2-9ace-4346-a620-e5853f3aef86&quot;,&quot;c5c34bf2-92c0-4e80-a320-90a2a5399838&quot;,&quot;6acad1a6-2ad2-4d63-9bec-13c3e018254b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:898,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;5835527b-f859-4837-96d8-081c781d3300&quot;,&quot;title&quot;:&quot;DELETE/agents/:agent_id&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents_2.js&quot;,&quot;file&quot;:&quot;/test/test_agents_2.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/:agent_id \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:312,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.put(\&quot;/agents/TestingDeleteAgent\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    agent_id = res.body.data.id;\n    setTimeout(function(){ \n        done();\n    }, 30)\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6e5723a2-bdb1-4e24-ab54-d25976382c0a&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/:agent_id Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:285,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .delete(\&quot;/agents/\&quot; + agent_id + &#x27;?purge&#x27;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.data.should.have.properties([&#x27;msg&#x27;, &#x27;affected_agents&#x27;]);\n                res.body.error.should.equal(0);\n                res.body.data.msg.should.be.type(&#x27;string&#x27;);\n                res.body.data.affected_agents[0].should.equal(agent_id);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;86a1b3f9-9146-45f0-a548-81482a5b03e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: ID is not present&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/:agent_id Errors: ID is not present&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .delete(\&quot;/agents/\&quot; + agent_id)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                if (is_auth_d_running()) res.body.data.failed_ids[0].error.code.should.equal(9011);\n                else                     res.body.data.failed_ids[0].error.code.should.equal(1701);\n                res.body.data.msg.should.be.type(&#x27;string&#x27;);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;53460c12-e3ed-4f5f-b17d-5c50aaf17087&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad agent id&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/:agent_id Params: Bad agent id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/agents/abc\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(600);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;92be5e72-1a87-48f2-bc7a-1e494dfd8f1e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;86a1b3f9-9146-45f0-a548-81482a5b03e0&quot;,&quot;53460c12-e3ed-4f5f-b17d-5c50aaf17087&quot;,&quot;92be5e72-1a87-48f2-bc7a-1e494dfd8f1e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:629,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;b94d3406-b759-487a-8bd8-d513d3300abd&quot;,&quot;title&quot;:&quot;POST/agents&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents_2.js&quot;,&quot;file&quot;:&quot;/test/test_agents_2.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8bafa37b-3561-4f6d-b25e-e038a662180c&quot;,&quot;title&quot;:&quot;Any&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents_2.js&quot;,&quot;file&quot;:&quot;/test/test_agents_2.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents Any \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/agents/\&quot; + agent_id + &#x27;?purge&#x27;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) return done(err);\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4cfbd28f-1872-4b29-a327-63350e8f063c&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents Any Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:300,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents\&quot;)\n                .send({&#x27;name&#x27;:&#x27;NewAgentPost&#x27;, &#x27;ip&#x27;:&#x27;any&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(200)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                    res.body.data.should.have.properties([&#x27;id&#x27;, &#x27;key&#x27;]);\n                    res.body.error.should.equal(0);\n                    res.body.data.id.should.match(/^\\d+$/);\n                    res.body.data.key.should.match(/^[0-9a-zA-Z=]+$/);\n                    agent_id = res.body.data.id;\n                    agent_key = res.body.data.key;\n                    setTimeout(function(){ \n                        done();\n                    }, 30)\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5dbc91dd-f5df-43b2-97ca-ef40bbf68450&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Check key&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents Any Check key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:301,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/\&quot; + agent_id + \&quot;/key\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.equal(agent_key);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;03e36b76-14fd-47d6-9c6d-1bbc142cc4c1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: Name already present&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents Any Errors: Name already present&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/agents\&quot;)\n.send({&#x27;name&#x27;:&#x27;NewAgentPost&#x27;, &#x27;ip&#x27;:&#x27;any&#x27;})\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    if (is_auth_d_running()) res.body.error.should.equal(9008);\n    else                     res.body.error.should.equal(1705);\n    res.body.message.should.be.type(&#x27;string&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;09225800-32b9-46f9-a427-621cef4b93b0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: Missing field name&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents Any Filters: Missing field name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:75,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents\&quot;)\n                .send({&#x27;ip&#x27;:&#x27;any&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(400)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                    res.body.error.should.equal(604);\n                    done();\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;92d56d9b-aeb8-4d52-ada2-0b10ab77327f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: Invalid field&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents Any Filters: Invalid field&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:75,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents\&quot;)\n                .send({&#x27;extraField&#x27;: &#x27;invalid&#x27;, &#x27;name&#x27;: &#x27;testagentpost&#x27;, &#x27;ip&#x27;:&#x27;any&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(400)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                    res.body.error.should.equal(604);\n                    done();\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e5222a9c-5a82-4f9b-9959-249f1e758391&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5dbc91dd-f5df-43b2-97ca-ef40bbf68450&quot;,&quot;03e36b76-14fd-47d6-9c6d-1bbc142cc4c1&quot;,&quot;09225800-32b9-46f9-a427-621cef4b93b0&quot;,&quot;92d56d9b-aeb8-4d52-ada2-0b10ab77327f&quot;,&quot;e5222a9c-5a82-4f9b-9959-249f1e758391&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1020,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;02f49f9f-db1e-410e-b9eb-b62808db71f2&quot;,&quot;title&quot;:&quot;IP Automatic&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents_2.js&quot;,&quot;file&quot;:&quot;/test/test_agents_2.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents IP Automatic \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/agents/\&quot; + agent_id + &#x27;?purge&#x27;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) return done(err);\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;dd8b36e4-001a-41a8-9860-86f2da5dae86&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request: Automatic IP&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents IP Automatic Request: Automatic IP&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:296,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents\&quot;)\n                .send({&#x27;name&#x27;:&#x27;NewAgentPost2&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(200)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                    res.body.data.should.have.properties([&#x27;id&#x27;, &#x27;key&#x27;]);\n                    res.body.error.should.equal(0);\n                    res.body.data.id.should.match(/^\\d+$/);\n                    res.body.data.key.should.match(/^[0-9a-zA-Z=]+$/);\n                    agent_id = res.body.data.id;\n                    setTimeout(function(){ \n                        done();\n                    }, 30)\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;bd477fce-4613-47b0-8799-6255dd2882cf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: Duplicated IP&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents IP Automatic Errors: Duplicated IP&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/agents\&quot;)\n.send({&#x27;name&#x27;:&#x27;NewAgentPost3&#x27;})\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    if (is_auth_d_running()) res.body.error.should.equal(9007);\n    else                     res.body.error.should.equal(1706);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;47617225-1051-420f-8e65-ecc05f2c586d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;bd477fce-4613-47b0-8799-6255dd2882cf&quot;,&quot;47617225-1051-420f-8e65-ecc05f2c586d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:565,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;a521fc06-02e4-4a23-bb52-25d1ac13d277&quot;,&quot;title&quot;:&quot;IP&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents_2.js&quot;,&quot;file&quot;:&quot;/test/test_agents_2.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after each\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents IP \&quot;after each\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (agent_id != 0){\n    request(common.url)\n    .delete(\&quot;/agents/\&quot; + agent_id + &#x27;?purge&#x27;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;,/json/)\n    .expect(200)\n    .end(function(err, res) {\n        if (err) return done(err);\n        done();\n      });\n}\nelse {\n    done();\n}&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9cf1f189-112a-4247-bdb2-c40b7c39b907&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents IP Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:273,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents\&quot;)\n                .send({&#x27;name&#x27;:&#x27;NewAgentPost4&#x27;, &#x27;ip&#x27;: &#x27;192.246.247.248&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(200)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                    res.body.error.should.equal(0);\n                    res.body.data.id.should.match(/^\\d+$/);\n                    res.body.data.key.should.match(/^[0-9a-zA-Z=]+$/);\n                    agent_id = res.body.data.id;\n                    done();\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;88583737-2532-4e33-9cd4-62975813759a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: Bad IP&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents IP Filters: Bad IP&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents\&quot;)\n                .send({&#x27;name&#x27;:&#x27;NewAgentPost4&#x27;, &#x27;ip&#x27;: &#x27;A.B.C.D&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(400)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                    res.body.error.should.equal(606);\n                    done();\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ae056464-17fc-419c-9e75-dd42c9cc9c9f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: Bad IP 2&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents IP Filters: Bad IP 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents\&quot;)\n                .send({&#x27;name&#x27;:&#x27;NewAgentPost4&#x27;, &#x27;ip&#x27;: &#x27;333.333.333.333&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(400)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                    res.body.error.should.equal(606);\n                    done();\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;66131af3-c9d0-43fd-8b92-f72d3c5c8122&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;88583737-2532-4e33-9cd4-62975813759a&quot;,&quot;ae056464-17fc-419c-9e75-dd42c9cc9c9f&quot;,&quot;66131af3-c9d0-43fd-8b92-f72d3c5c8122&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:427,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;a25e1b90-762f-4a8a-af1e-f417674ca540&quot;,&quot;title&quot;:&quot;POST/agents/insert&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents_2.js&quot;,&quot;file&quot;:&quot;/test/test_agents_2.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e575bc4a-8796-4475-9ae2-997e7ac970ee&quot;,&quot;title&quot;:&quot;Any&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents_2.js&quot;,&quot;file&quot;:&quot;/test/test_agents_2.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert Any \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/agents/\&quot; + agent_id + &#x27;?purge&#x27;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) return done(err);\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;579e8473-5fb9-4c5e-b8c7-378321e9ae22&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert Any Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:298,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents/insert\&quot;)\n                .send({&#x27;name&#x27;:&#x27;NewAgentPostInsert&#x27;, &#x27;ip&#x27;:&#x27;any&#x27;, &#x27;id&#x27;:&#x27;750&#x27;, &#x27;key&#x27;:&#x27;1abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghi64&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(200)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                    res.body.data.should.have.properties([&#x27;id&#x27;,&#x27;key&#x27;]);\n                    res.body.error.should.equal(0);\n                    res.body.data.id.should.match(/^\\d+$/);\n                    res.body.data.key.should.match(/^[a-zA-Z0-9=]+/);\n                    agent_id = res.body.data.id;\n                    setTimeout(function(){\n                        done();\n                    }, 30)\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;036a7a2e-2580-4996-8d08-f8e5506c7311&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Insert agent with force parameter (ID and name already presents)&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert Any Insert agent with force parameter (ID and name already presents)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:298,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents/insert\&quot;)\n                .send({&#x27;name&#x27;:&#x27;NewAgentPostInsert&#x27;, &#x27;ip&#x27;:&#x27;any&#x27;, &#x27;id&#x27;:&#x27;750&#x27;, &#x27;key&#x27;:&#x27;1abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghi64&#x27;, &#x27;force&#x27;: &#x27;0&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(200)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                    res.body.data.should.have.properties([&#x27;id&#x27;,&#x27;key&#x27;]);\n                    res.body.error.should.equal(0);\n                    res.body.data.id.should.match(/^\\d+$/);\n                    res.body.data.key.should.match(/^[a-zA-Z0-9=]+/);\n                    agent_id = res.body.data.id;\n                    setTimeout(function(){\n                        done();\n                    }, 30)\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e35edf3b-e568-41cd-bd03-46a41b7c3df6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: Name already present&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert Any Errors: Name already present&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:273,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/agents/insert\&quot;)\n.send({&#x27;name&#x27;:&#x27;NewAgentPostInsert&#x27;, &#x27;ip&#x27;:&#x27;any&#x27;, &#x27;id&#x27;:&#x27;751&#x27;, &#x27;key&#x27;:&#x27;1abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghi64&#x27;})\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    if (is_auth_d_running()) res.body.error.should.equal(9008);\n    else                     res.body.error.should.equal(1705);\n    res.body.message.should.be.type(&#x27;string&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;601deeb3-8feb-4bff-8629-08935f5de6a7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: ID already present&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert Any Errors: ID already present&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/agents/insert\&quot;)\n.send({&#x27;name&#x27;:&#x27;NewAgentPostInsert&#x27;, &#x27;ip&#x27;:&#x27;any&#x27;, &#x27;id&#x27;:&#x27;750&#x27;, &#x27;key&#x27;:&#x27;1abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghi64&#x27;})\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    if (is_auth_d_running()) res.body.error.should.equal(9012);\n    else                     res.body.error.should.equal(1708);\n    res.body.message.should.be.type(&#x27;string&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e9c76c3f-5f41-4da6-b62f-10c9ff5a4ae8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: Invalid key&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert Any Errors: Invalid key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/agents/insert\&quot;)\n.send({&#x27;name&#x27;:&#x27;NewAgentPostInsert&#x27;, &#x27;ip&#x27;:&#x27;any&#x27;, &#x27;id&#x27;:&#x27;750&#x27;, &#x27;key&#x27;:&#x27;short&#x27;})\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1709);\n    res.body.message.should.be.type(&#x27;string&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e6b57033-6931-4e68-9d90-45b538677085&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: Missing fields&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert Any Filters: Missing fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:79,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents/insert\&quot;)\n                .send({&#x27;ip&#x27;:&#x27;any&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(400)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                    res.body.error.should.equal(604);\n                    done();\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9e050483-36d6-44f1-b470-08f7786583f9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: Invalid field&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert Any Filters: Invalid field&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents/insert\&quot;)\n                .send({&#x27;extraField&#x27;: &#x27;invalid&#x27;, &#x27;name&#x27;:&#x27;NewAgentPostInsert&#x27;, &#x27;ip&#x27;:&#x27;any&#x27;, &#x27;id&#x27;:&#x27;750&#x27;, &#x27;key&#x27;:&#x27;1abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghi64&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(400)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                    res.body.error.should.equal(604);\n                    done();\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b38707c2-77fc-4a7f-8516-fee63a409202&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;036a7a2e-2580-4996-8d08-f8e5506c7311&quot;,&quot;e35edf3b-e568-41cd-bd03-46a41b7c3df6&quot;,&quot;601deeb3-8feb-4bff-8629-08935f5de6a7&quot;,&quot;e9c76c3f-5f41-4da6-b62f-10c9ff5a4ae8&quot;,&quot;e6b57033-6931-4e68-9d90-45b538677085&quot;,&quot;9e050483-36d6-44f1-b470-08f7786583f9&quot;,&quot;b38707c2-77fc-4a7f-8516-fee63a409202&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1580,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;bb8effc1-7a49-4288-87d6-3496c479539b&quot;,&quot;title&quot;:&quot;IP Automatic&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents_2.js&quot;,&quot;file&quot;:&quot;/test/test_agents_2.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert IP Automatic \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/agents/\&quot; + agent_id + &#x27;?purge&#x27;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) return done(err);\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9d1e7c8d-2fd3-4c35-ae07-0c299316ffef&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request: Automatic IP&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert IP Automatic Request: Automatic IP&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents/insert\&quot;)\n                .send({&#x27;name&#x27;:&#x27;NewAgentPostInsert&#x27;, &#x27;id&#x27;:&#x27;755&#x27;, &#x27;key&#x27;:&#x27;1abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghi64&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(200)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                    res.body.data.should.have.properties([&#x27;id&#x27;, &#x27;key&#x27;]);\n                    res.body.error.should.equal(0);\n                    res.body.data.id.should.match(/^\\d+$/);\n                    res.body.data.key.should.match(/^[a-zA-Z0-9=]+/);\n                    agent_id = res.body.data.id;\n                    done();\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;eb18524c-e2fa-488a-abf7-b37f8f50d117&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: Duplicated IP&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert IP Automatic Errors: Duplicated IP&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/agents/insert\&quot;)\n.send({&#x27;name&#x27;:&#x27;NewAgentPostInsert3&#x27;, &#x27;id&#x27;:&#x27;756&#x27;, &#x27;key&#x27;:&#x27;1abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghi64&#x27;})\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    if (is_auth_d_running()) res.body.error.should.equal(9007);\n    else                     res.body.error.should.equal(1706);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ea9d57a3-e65f-449b-83dd-1712958f7b91&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;eb18524c-e2fa-488a-abf7-b37f8f50d117&quot;,&quot;ea9d57a3-e65f-449b-83dd-1712958f7b91&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:551,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;b3330f04-2f7d-46db-9d28-4280fab14110&quot;,&quot;title&quot;:&quot;IP&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents_2.js&quot;,&quot;file&quot;:&quot;/test/test_agents_2.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after each\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert IP \&quot;after each\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (agent_id != 0){\n    request(common.url)\n    .delete(\&quot;/agents/\&quot; + agent_id + &#x27;?purge&#x27;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;,/json/)\n    .expect(200)\n    .end(function(err, res) {\n        if (err) return done(err);\n        done();\n      });\n}\nelse {\n    done();\n}&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c1b988cf-d7d5-48cd-83d7-9d1189a73b51&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert IP Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents/insert\&quot;)\n                .send({&#x27;name&#x27;:&#x27;NewAgentPostInsert4&#x27;, &#x27;ip&#x27;:&#x27;192.246.247.249&#x27;, &#x27;id&#x27;:&#x27;760&#x27;, &#x27;key&#x27;:&#x27;1abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghi64&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(200)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                    // res.body.data.should.have.properties([&#x27;id&#x27;, &#x27;key&#x27;]);\n                    res.body.error.should.equal(0);\n                    res.body.data.id.should.match(/^\\d+$/);\n                    res.body.data.key.should.match(/^[a-zA-Z0-9=]+/);\n                    agent_id = res.body.data.id;\n                    done();\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9525d730-dd2b-4760-afd4-74d3f2cb6482&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: Bad IP&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert IP Filters: Bad IP&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents/insert\&quot;)\n                .send({&#x27;name&#x27;:&#x27;NewAgentPostInsert&#x27;, &#x27;ip&#x27;:&#x27;192.246.247.d&#x27;, &#x27;id&#x27;:&#x27;760&#x27;, &#x27;key&#x27;:&#x27;1abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghi64&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(400)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                    res.body.error.should.equal(606);\n                    done();\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;bd6713a1-f465-427d-8b7a-f7a6b6b3d07b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: Bad IP 2&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/insert IP Filters: Bad IP 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .post(\&quot;/agents/insert\&quot;)\n                .send({&#x27;name&#x27;:&#x27;NewAgentPostInsert4&#x27;, &#x27;ip&#x27;:&#x27;333.333.333.333&#x27;, &#x27;id&#x27;:&#x27;760&#x27;, &#x27;key&#x27;:&#x27;1abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghi64&#x27;})\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;,/json/)\n                .expect(400)\n                .end(function(err,res){\n                    if (err) return done(err);\n                    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                    res.body.error.should.equal(606);\n                    done();\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6ead59e9-a194-46bd-a699-57359bd29a10&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9525d730-dd2b-4760-afd4-74d3f2cb6482&quot;,&quot;bd6713a1-f465-427d-8b7a-f7a6b6b3d07b&quot;,&quot;6ead59e9-a194-46bd-a699-57359bd29a10&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:425,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:10000},&quot;copyrightYear&quot;:2020}" data-config="{&quot;reportFilename&quot;:&quot;agents2&quot;,&quot;reportDir&quot;:&quot;/share&quot;,&quot;reportTitle&quot;:&quot;wazuh-api&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:true,&quot;enableCharts&quot;:true,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;/share/assets&quot;,&quot;jsonFile&quot;:&quot;/share/agents2.json&quot;,&quot;htmlFile&quot;:&quot;/share/agents2.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>