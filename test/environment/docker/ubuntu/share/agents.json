{
  "stats": {
    "suites": 28,
    "tests": 155,
    "passes": 152,
    "pending": 0,
    "failures": 3,
    "start": "2020-06-08T12:16:13.175Z",
    "end": "2020-06-08T12:17:12.452Z",
    "duration": 59277,
    "testsRegistered": 155,
    "passPercent": 98.1,
    "pendingPercent": 0,
    "other": 0,
    "hasOther": false,
    "skipped": 0,
    "hasSkipped": false,
    "passPercentClass": "success",
    "pendingPercentClass": "danger"
  },
  "suites": {
    "uuid": "11998f6d-49c4-485e-ad71-3d1bd05f4731",
    "title": "",
    "fullFile": "",
    "file": "",
    "beforeHooks": [],
    "afterHooks": [],
    "tests": [],
    "suites": [
      {
        "uuid": "3723cbd4-8864-45b9-83a9-d30979dd333f",
        "title": "Agents",
        "fullFile": "/wazuh-api/test/test_agents.js",
        "file": "/test/test_agents.js",
        "beforeHooks": [],
        "afterHooks": [],
        "tests": [],
        "suites": [
          {
            "uuid": "3e5ec7f7-ee0d-464c-b645-4343b8ff836a",
            "title": "GET/agents",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [
              {
                "title": "\"before all\" hook",
                "fullTitle": "Agents GET/agents \"before all\" hook",
                "timedOut": false,
                "duration": 97,
                "pass": false,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/version\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n  expected_version=\"Wazuh \"+String(res.body.data);\n  done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "cf7f0b6c-3e44-48db-b015-9fcc612fdb9d",
                "isHook": true,
                "skipped": false
              },
              {
                "title": "\"before all\" hook",
                "fullTitle": "Agents GET/agents \"before all\" hook",
                "timedOut": false,
                "duration": 274,
                "pass": false,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array);\n    expected_os_platform = res.body.data.items[0].os.platform;\n    expected_os_version = res.body.data.items[0].os.version;\n    expected_manager_host = res.body.data.items[0].manager;\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "e261e296-410b-40f4-9572-07f76e1449eb",
                "isHook": true,
                "skipped": false
              }
            ],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents GET/agents Request",
                "timedOut": false,
                "duration": 273,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].should.have.properties(manager_properties);\n    res.body.data.items[1].should.have.properties(agent_properties);\n    res.body.data.items[0].os.should.have.properties(agent_os_properties);\n    res.body.data.items[1].os.should.have.properties(agent_os_properties);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "bc72d247-4194-4186-a49e-b9e99ca54613",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Pagination",
                "fullTitle": "Agents GET/agents Pagination",
                "timedOut": false,
                "duration": 276,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?offset=0&limit=1\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n    res.body.data.items[0].should.have.properties(manager_properties);\n    res.body.data.items[0].id.should.have.equal('000');\n    res.body.data.items[0].status.should.have.equal('Active');\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "ba51db33-0345-4dc9-b695-4a86d5f538d3",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Retrieve all elements with limit=0",
                "fullTitle": "Agents GET/agents Retrieve all elements with limit=0",
                "timedOut": false,
                "duration": 271,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?limit=0\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1406);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "473ed57e-fabc-4a1e-8a5d-e9645da8597f",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Sort",
                "fullTitle": "Agents GET/agents Sort",
                "timedOut": false,
                "duration": 273,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?sort=-id\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array);\n    res.body.data.items[0].id.should.equal('003');\n    res.body.data.items[0].should.have.properties(agent_properties);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "5ff20373-8cb3-4378-8315-ca6dd5f1f44c",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Wrong Sort",
                "fullTitle": "Agents GET/agents Wrong Sort",
                "timedOut": false,
                "duration": 270,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?sort=-wrongParameter\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1403);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "eeac6c26-55e1-4cc6-aa32-bd62aba91b01",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Search",
                "fullTitle": "Agents GET/agents Search",
                "timedOut": false,
                "duration": 278,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?search=001\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array);\n    res.body.data.items[0].id.should.be.equal(\"001\");\n    res.body.data.items[0].should.have.properties(agent_properties);\n    res.body.data.items[0].os.should.have.properties(agent_os_properties);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "98f915c1-db39-4ca6-b8d1-07009cdb4463",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Selector",
                "fullTitle": "Agents GET/agents Selector",
                "timedOut": false,
                "duration": 275,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?select=dateAdd,mergedSum\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].should.have.properties(['dateAdd', 'id']);\n    res.body.data.items[1].should.have.properties(['dateAdd', 'mergedSum', 'id']);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "e84d8988-eaa6-4874-aac1-d78b1c8c4b79",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Not allowed selector",
                "fullTitle": "Agents GET/agents Not allowed selector",
                "timedOut": false,
                "duration": 273,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?select=wrongParam\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1724);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "e1ea9eb0-bfec-453e-a343-de6e0ab329e1",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Version",
                "fullTitle": "Agents GET/agents Version",
                "timedOut": false,
                "duration": 277,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?version=\"+expected_version.replace(/\\s/g, ''))\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].should.have.properties(['version']);\n    res.body.data.items[0].version.should.be.equal(expected_version);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "ea747b2c-eed8-48cc-aebb-5956e12a0996",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Os.platform",
                "fullTitle": "Agents GET/agents Os.platform",
                "timedOut": false,
                "duration": 272,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?os.platform=\" + expected_os_platform)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].os.should.have.properties(['platform']);\n    res.body.data.items[0].os.platform.should.be.equal(expected_os_platform);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "54878931-8178-4bff-97a7-43593df0fca3",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Os.version",
                "fullTitle": "Agents GET/agents Os.version",
                "timedOut": false,
                "duration": 271,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?os.version=\" + expected_os_version)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].os.should.have.properties(['version']);\n    res.body.data.items[0].os.version.should.be.equal(expected_os_version);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "844b575f-c1c8-4c1d-b172-15ca826fbfb2",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "ManagerHost",
                "fullTitle": "Agents GET/agents ManagerHost",
                "timedOut": false,
                "duration": 274,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?manager=\" + expected_manager_host)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].os.should.have.properties(['version']);\n    res.body.data.items[0].manager.should.be.equal(expected_manager_host);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "7f41870b-768f-4c4c-a3e0-0c4a75f45209",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filters: status",
                "fullTitle": "Agents GET/agents Filters: status",
                "timedOut": false,
                "duration": 277,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?status=aCtIvE\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].should.have.properties(['status', 'ip', 'id', 'name']);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "4cddff45-0d62-4c0a-ab23-6be80bc1044a",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filters: status 2",
                "fullTitle": "Agents GET/agents Filters: status 2",
                "timedOut": false,
                "duration": 271,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents?status=aCtIvE,neverconnected\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(['status', 'ip', 'id', 'name']);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "72e37d69-3cac-4c4a-a69a-d492d1372117",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filters: Invalid filter",
                "fullTitle": "Agents GET/agents Filters: Invalid filter",
                "timedOut": false,
                "duration": 77,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?random\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(604);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "09fd0ad7-d8da-47a6-8d81-c6f3acdfc2ec",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filters: Invalid filter - Extra field",
                "fullTitle": "Agents GET/agents Filters: Invalid filter - Extra field",
                "timedOut": false,
                "duration": 80,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents?status=aCtIvE&random\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(604);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "16e25d7c-6f75-41c3-b9a0-efe250bf79fe",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filters: older_than",
                "fullTitle": "Agents GET/agents Filters: older_than",
                "timedOut": false,
                "duration": 281,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents?older_than=1s\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(['status', 'ip', 'id', 'name']);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "813850f5-9fa3-45a9-9fa3-ef40bacb8873",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filters: group",
                "fullTitle": "Agents GET/agents Filters: group",
                "timedOut": false,
                "duration": 278,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents?group=default\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties(['items','totalItems']);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.items[0].group.should.be.instanceof(Array);\n        res.body.data.items[0].group[0].should.be.equal('default');\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "6f73750d-2e92-4114-a138-f4f53fea953d",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Select: single field",
                "fullTitle": "Agents GET/agents Select: single field",
                "timedOut": false,
                "duration": 288,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents?select=lastKeepAlive\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(['id', 'lastKeepAlive']);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "c39af7af-5b84-48be-9207-5345a28e48c8",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Select: multiple fields",
                "fullTitle": "Agents GET/agents Select: multiple fields",
                "timedOut": false,
                "duration": 282,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents?select=status,os.platform,os.version\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(['id', 'status', 'os']);\n        res.body.data.items[0].os.should.have.properties(['version','platform']);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "c2dd60e4-4e40-4d8a-bce5-8bd883a02163",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Select: wrong field",
                "fullTitle": "Agents GET/agents Select: wrong field",
                "timedOut": false,
                "duration": 279,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents?select=wrong_field\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties(['error', 'message']);\n        res.body.error.should.equal(1724);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "814136d6-c447-4916-a893-8e121d5984ab",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Select: invalid character",
                "fullTitle": "Agents GET/agents Select: invalid character",
                "timedOut": false,
                "duration": 79,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents?select=invalidñcharacter\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties(['error', 'message']);\n        res.body.error.should.equal(619);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "d2c6a10c-569e-4659-bfcb-fbc5abb9fde7",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filters: query",
                "fullTitle": "Agents GET/agents Filters: query",
                "timedOut": false,
                "duration": 274,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents?q=group=default;lastKeepAlive<1d\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties(['items','totalItems']);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.items[0].group[0].should.be.equal('default');\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "7c45bdf2-2f18-4a32-9660-ad23f45ebdb2",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "bc72d247-4194-4186-a49e-b9e99ca54613",
              "ba51db33-0345-4dc9-b695-4a86d5f538d3",
              "473ed57e-fabc-4a1e-8a5d-e9645da8597f",
              "5ff20373-8cb3-4378-8315-ca6dd5f1f44c",
              "eeac6c26-55e1-4cc6-aa32-bd62aba91b01",
              "98f915c1-db39-4ca6-b8d1-07009cdb4463",
              "e84d8988-eaa6-4874-aac1-d78b1c8c4b79",
              "e1ea9eb0-bfec-453e-a343-de6e0ab329e1",
              "ea747b2c-eed8-48cc-aebb-5956e12a0996",
              "54878931-8178-4bff-97a7-43593df0fca3",
              "844b575f-c1c8-4c1d-b172-15ca826fbfb2",
              "7f41870b-768f-4c4c-a3e0-0c4a75f45209",
              "4cddff45-0d62-4c0a-ab23-6be80bc1044a",
              "72e37d69-3cac-4c4a-a69a-d492d1372117",
              "09fd0ad7-d8da-47a6-8d81-c6f3acdfc2ec",
              "16e25d7c-6f75-41c3-b9a0-efe250bf79fe",
              "813850f5-9fa3-45a9-9fa3-ef40bacb8873",
              "6f73750d-2e92-4114-a138-f4f53fea953d",
              "c39af7af-5b84-48be-9207-5345a28e48c8",
              "c2dd60e4-4e40-4d8a-bce5-8bd883a02163",
              "814136d6-c447-4916-a893-8e121d5984ab",
              "d2c6a10c-569e-4659-bfcb-fbc5abb9fde7",
              "7c45bdf2-2f18-4a32-9660-ad23f45ebdb2"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 5749,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "614b1a58-d0f3-4a52-a577-ffde0b704af2",
            "title": "GET/agents/summary",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents GET/agents/summary Request",
                "timedOut": false,
                "duration": 279,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/summary\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.have.properties(['Active', 'Total', 'Disconnected', 'Never connected']);\n    res.body.data['Active'].should.be.above(0);\n    res.body.data['Total'].should.be.an.integer;\n    res.body.data['Disconnected'].should.be.an.integer;\n    res.body.data['Never connected'].should.be.an.integer;\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "098fe2e8-5d30-4cf1-a38e-31ac02c2ce09",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "098fe2e8-5d30-4cf1-a38e-31ac02c2ce09"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 279,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "1da1cf3a-2232-4eb4-9288-134f0fc66c94",
            "title": "GET/agents/summary/os",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents GET/agents/summary/os Request",
                "timedOut": false,
                "duration": 283,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get('/agents/summary/os')\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function(err, res) {\n        if (err) return done(err);\n        res.body.error.should.equal(0);\n        res.body.should.have.properties(['error','data']);\n        res.body.data.should.have.properties(['totalItems','items']);\n        res.body.data.items.should.be.instanceof(Array);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "98008438-80c0-4d43-b16c-5a60d0d1590d",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "98008438-80c0-4d43-b16c-5a60d0d1590d"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 283,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "6e27e5b3-def8-421b-9c8a-c49e94156cda",
            "title": "GET/agents/outdated",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [
              {
                "title": "\"before all\" hook",
                "fullTitle": "Agents GET/agents/outdated \"before all\" hook",
                "timedOut": false,
                "duration": 319,
                "pass": false,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/manager/info\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        manager_version = res.body.data.version;\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "ffa1fe14-4971-4a5d-bd9f-b859be1c4c2a",
                "isHook": true,
                "skipped": false
              }
            ],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents GET/agents/outdated Request",
                "timedOut": false,
                "duration": 677,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/outdated\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.have.properties(['items','totalItems']);\n    res.body.data.items.should.be.instanceOf(Array);\n    res.body.data.items[0].should.have.properties(['version','id','name']);\n    res.body.data.items[0].should.not.be.eql(manager_version);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "328a2f22-01a8-43f7-9baf-d52af6441272",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "328a2f22-01a8-43f7-9baf-d52af6441272"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 677,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "5f99156b-6258-4db1-96b3-73f3b94b3436",
            "title": "GET/agents/:agent_id",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request (manager)",
                "fullTitle": "Agents GET/agents/:agent_id Request (manager)",
                "timedOut": false,
                "duration": 673,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.Object;\n    res.body.data.id.should.equal(\"000\");\n    res.body.data.should.have.properties(manager_properties);\n    res.body.data.os.should.have.properties(agent_os_properties);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "0a817e13-59e2-445c-a6dd-5c76ed32c1f5",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request (agent)",
                "fullTitle": "Agents GET/agents/:agent_id Request (agent)",
                "timedOut": false,
                "duration": 493,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/001\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.Object;\n    res.body.data.id.should.equal(\"001\");\n    res.body.data.should.have.properties(agent_properties);\n    res.body.data.os.should.have.properties(agent_os_properties);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "56d201d3-14f1-4221-bd67-15e93ce49f68",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Selector",
                "fullTitle": "Agents GET/agents/:agent_id Selector",
                "timedOut": false,
                "duration": 361,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/001?select=dateAdd,mergedSum\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.have.properties(['dateAdd', 'mergedSum']);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "a30ae015-44bb-4250-8b59-77ad3bfe4748",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Not allowed selector",
                "fullTitle": "Agents GET/agents/:agent_id Not allowed selector",
                "timedOut": false,
                "duration": 276,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/001?select=wrongParam\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1724);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "b6bd9a6c-eaae-4741-a574-d21be01c6bc3",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad agent id",
                "fullTitle": "Agents GET/agents/:agent_id Params: Bad agent id",
                "timedOut": false,
                "duration": 90,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/abc\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(600);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "149e1927-b80c-40a3-9a1f-c0e714105aa4",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Errors: No agent",
                "fullTitle": "Agents GET/agents/:agent_id Errors: No agent",
                "timedOut": false,
                "duration": 331,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/9999999\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1701);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "d089c9fd-0aa1-4c1f-9f8a-44d96faf14b5",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Select",
                "fullTitle": "Agents GET/agents/:agent_id Select",
                "timedOut": false,
                "duration": 277,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000?select=lastKeepAlive,id,ip,status\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.have.properties(['lastKeepAlive','id','ip','status']);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "8891f769-19d9-4d78-9a72-062d9458eaaf",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Select: wrong field",
                "fullTitle": "Agents GET/agents/:agent_id Select: wrong field",
                "timedOut": false,
                "duration": 285,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000?select=wrong_field\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1724);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "fceaa247-c424-49f3-833f-fec0371666cd",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "0a817e13-59e2-445c-a6dd-5c76ed32c1f5",
              "56d201d3-14f1-4221-bd67-15e93ce49f68",
              "a30ae015-44bb-4250-8b59-77ad3bfe4748",
              "b6bd9a6c-eaae-4741-a574-d21be01c6bc3",
              "149e1927-b80c-40a3-9a1f-c0e714105aa4",
              "d089c9fd-0aa1-4c1f-9f8a-44d96faf14b5",
              "8891f769-19d9-4d78-9a72-062d9458eaaf",
              "fceaa247-c424-49f3-833f-fec0371666cd"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 2786,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "0c3ff076-a3f2-4808-ad59-5f04475fd829",
            "title": "GET/agents/name/:agent_name",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [
              {
                "title": "\"before all\" hook",
                "fullTitle": "Agents GET/agents/name/:agent_name \"before all\" hook",
                "timedOut": false,
                "duration": 275,
                "pass": false,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/001\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.data.should.have.properties(agent_properties);\n    res.body.error.should.equal(0);\n    expected_name = res.body.data.name;\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "0384fb83-0f7a-443a-bb86-8dbb630f4c56",
                "isHook": true,
                "skipped": false
              }
            ],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents GET/agents/name/:agent_name Request",
                "timedOut": false,
                "duration": 272,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/name/\"+expected_name)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.Object;\n    res.body.data.should.have.properties(agent_properties);\n    res.body.data.os.should.have.properties(agent_os_properties);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "33b39826-ee3b-448a-9ac4-36199064a6bb",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Wrong name",
                "fullTitle": "Agents GET/agents/name/:agent_name Wrong name",
                "timedOut": false,
                "duration": 269,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/name/non_existent_agent\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1701);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "70eed0f9-3c80-4463-a777-fc48c154c9c0",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Selector",
                "fullTitle": "Agents GET/agents/name/:agent_name Selector",
                "timedOut": false,
                "duration": 267,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/name/\"+expected_name+\"?select=dateAdd,mergedSum,os.name\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.Object;\n    res.body.data.should.have.properties(['mergedSum','dateAdd','os']);\n    res.body.data.os.should.have.properties(['name']);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "21779019-a27b-4163-9267-04886bd13d1b",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Not allowed selector",
                "fullTitle": "Agents GET/agents/name/:agent_name Not allowed selector",
                "timedOut": false,
                "duration": 269,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/name/\"+expected_name+\"?select=wrongField\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1724);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "c4b0e6c8-a451-41e1-941a-8fff0a7a6200",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "33b39826-ee3b-448a-9ac4-36199064a6bb",
              "70eed0f9-3c80-4463-a777-fc48c154c9c0",
              "21779019-a27b-4163-9267-04886bd13d1b",
              "c4b0e6c8-a451-41e1-941a-8fff0a7a6200"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 1077,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "c424026e-7599-4a70-a115-24168a419965",
            "title": "GET/agents/:agent_id/key",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents GET/agents/:agent_id/key Request",
                "timedOut": false,
                "duration": 267,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/001/key\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.type('string');\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "469cc82d-d552-4584-a1f1-a60726d0fbb5",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad agent id",
                "fullTitle": "Agents GET/agents/:agent_id/key Params: Bad agent id",
                "timedOut": false,
                "duration": 76,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/abc/key\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(600);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "521ccd15-6a35-4b2b-91b8-5c6bcb391b33",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Errors: No key",
                "fullTitle": "Agents GET/agents/:agent_id/key Errors: No key",
                "timedOut": false,
                "duration": 265,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/999999/key\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1701);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "0588ebda-7113-4971-9693-d5aede234074",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "469cc82d-d552-4584-a1f1-a60726d0fbb5",
              "521ccd15-6a35-4b2b-91b8-5c6bcb391b33",
              "0588ebda-7113-4971-9693-d5aede234074"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 608,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "b156b024-557e-4f0f-beea-6ef55feae921",
            "title": "PUT/agents/groups/:group_id",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents PUT/agents/groups/:group_id Request",
                "timedOut": false,
                "duration": 265,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .put(\"/agents/groups/webserver\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.error.should.equal(0);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "dd5fe8c8-49d6-472d-8ed7-1a3ccaa4d6ee",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad group name",
                "fullTitle": "Agents PUT/agents/groups/:group_id Params: Bad group name",
                "timedOut": false,
                "duration": 76,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.put(\"/agents/groups/!group\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(601);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "2253c912-bcf7-4130-b429-25ba75b7bd50",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Group already exists",
                "fullTitle": "Agents PUT/agents/groups/:group_id Params: Group already exists",
                "timedOut": false,
                "duration": 264,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.put(\"/agents/groups/webserver\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1711);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "1195ddef-a510-4410-bdee-11f1e3ee7a6d",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "dd5fe8c8-49d6-472d-8ed7-1a3ccaa4d6ee",
              "2253c912-bcf7-4130-b429-25ba75b7bd50",
              "1195ddef-a510-4410-bdee-11f1e3ee7a6d"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 605,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "aaadfb1b-833b-448d-a847-74ac343f9c82",
            "title": "PUT/agents/:agent_id/group/:group_id",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [
              {
                "title": "\"before all\" hook",
                "fullTitle": "Agents PUT/agents/:agent_id/group/:group_id \"before all\" hook",
                "timedOut": false,
                "duration": 266,
                "pass": false,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .put(\"/agents/groups/dmz\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "409a5149-e3da-477d-88c7-c9d5030f1b41",
                "isHook": true,
                "skipped": false
              }
            ],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents PUT/agents/:agent_id/group/:group_id Request",
                "timedOut": false,
                "duration": 266,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .put(\"/agents/001/group/webserver\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.error.should.equal(0);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "9ccc3a22-8678-44eb-b40f-87572e265a8c",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad agent name",
                "fullTitle": "Agents PUT/agents/:agent_id/group/:group_id Params: Bad agent name",
                "timedOut": false,
                "duration": 77,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.put(\"/agents/001!/group/webserver\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(600);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "902d1370-b5bc-4e16-aa0e-96ed0feadab4",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Agent does not exist",
                "fullTitle": "Agents PUT/agents/:agent_id/group/:group_id Params: Agent does not exist",
                "timedOut": false,
                "duration": 266,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.put(\"/agents/1568/group/webserver\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1701);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "c5d9960e-d720-4be7-ad6d-65e42df6672e",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Replace parameter",
                "fullTitle": "Agents PUT/agents/:agent_id/group/:group_id Params: Replace parameter",
                "timedOut": false,
                "duration": 267,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.put(\"/agents/001/group/dmz?force_single_group\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "a446b003-0c52-45c2-a9fa-e9946e917c2e",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "9ccc3a22-8678-44eb-b40f-87572e265a8c",
              "902d1370-b5bc-4e16-aa0e-96ed0feadab4",
              "c5d9960e-d720-4be7-ad6d-65e42df6672e",
              "a446b003-0c52-45c2-a9fa-e9946e917c2e"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 876,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "acd59ace-e064-45e9-9592-a4e4a201202f",
            "title": "POST/agents/groups/:group_id/files/:file_name",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [
              {
                "title": "\"before all\" hook",
                "fullTitle": "Agents POST/agents/groups/:group_id/files/:file_name \"before all\" hook",
                "timedOut": false,
                "duration": 263,
                "pass": false,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .put(\"/agents/groups/testsagentconf\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "75d540f3-8b2e-4115-831b-9b3962fc905f",
                "isHook": true,
                "skipped": false
              }
            ],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents POST/agents/groups/:group_id/files/:file_name Request",
                "timedOut": false,
                "duration": 280,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .post(\"/agents/groups/testsagentconf/files/agent.conf\")\n            .auth(common.credentials.user, common.credentials.password)\n            .set('Content-Type', 'application/xml')\n            .send(agent_xml)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.error.should.equal(0);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "fa81db0e-236e-4fd2-a0ca-0a27def9551c",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "ErrorOnBadGroup",
                "fullTitle": "Agents POST/agents/groups/:group_id/files/:file_name ErrorOnBadGroup",
                "timedOut": false,
                "duration": 270,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .post(\"/agents/groups/asdfg/files/agent.conf\")\n            .auth(common.credentials.user, common.credentials.password)\n            .set('Content-Type', 'application/xml')\n            .send(agent_xml)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'message']);\n                res.body.error.should.equal(1710);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "118bcaeb-f154-4ad0-ae70-ea65f90c727b",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "ErrorOnEmptyConf",
                "fullTitle": "Agents POST/agents/groups/:group_id/files/:file_name ErrorOnEmptyConf",
                "timedOut": false,
                "duration": 76,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.post(\"/agents/groups/testsagentconf/files/agent.conf\")\n.auth(common.credentials.user, common.credentials.password)\n.set('Content-Type', 'application/xml')\n.send(\"\")\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(703);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "d655343a-7d13-401d-bec0-7c0628d4353c",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "OnlyAgentConfAllowed",
                "fullTitle": "Agents POST/agents/groups/:group_id/files/:file_name OnlyAgentConfAllowed",
                "timedOut": false,
                "duration": 264,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .post(\"/agents/groups/testsagentconf/files/aaaaaa\")\n            .auth(common.credentials.user, common.credentials.password)\n            .set('Content-Type', 'application/xml')\n            .send(agent_xml)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'message']);\n                res.body.error.should.equal(1111);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "39814ebe-043a-48c3-a405-0ca2385e1f93",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "InvalidConfDetected",
                "fullTitle": "Agents POST/agents/groups/:group_id/files/:file_name InvalidConfDetected",
                "timedOut": false,
                "duration": 77,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .post(\"/agents/groups/testsagentconf/files/agent.conf\")\n            .auth(common.credentials.user, common.credentials.password)\n            .set('Content-Type', 'application/xml')\n            .send(invalid_xml)\n            .expect(\"Content-type\",/json/)\n            .expect(400)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'message']);\n                res.body.error.should.equal(703);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "7619d8e7-0690-42f5-93bd-4ed1868f65b1",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "WrongConfDetected",
                "fullTitle": "Agents POST/agents/groups/:group_id/files/:file_name WrongConfDetected",
                "timedOut": false,
                "duration": 273,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .post(\"/agents/groups/testsagentconf/files/agent.conf\")\n            .auth(common.credentials.user, common.credentials.password)\n            .set('Content-Type', 'application/xml')\n            .send(wrong_xml)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'message']);\n                res.body.error.should.equal(1114);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "c64a9c4c-c770-4c2f-8a00-35492453da2b",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "TooBigXML",
                "fullTitle": "Agents POST/agents/groups/:group_id/files/:file_name TooBigXML",
                "timedOut": false,
                "duration": 1643,
                "state": "failed",
                "pass": false,
                "fail": true,
                "pending": false,
                "code": "big_xml = agent_xml.repeat(600)\n            request(common.url)\n            .post(\"/agents/groups/testsagentconf/files/agent.conf\")\n            .auth(common.credentials.user, common.credentials.password)\n            .set('Content-Type', 'application/xml')\n            .send(big_xml)\n            .expect(\"Content-type\",/json/)\n            .expect(400)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'message']);\n                res.body.error.should.equal(701);\n                done();\n            });",
                "err": {
                  "message": "Error: expected 400 \"Bad Request\", got 200 \"OK\"",
                  "estack": "Error: expected 400 \"Bad Request\", got 200 \"OK\"\n    at Test._assertStatus (node_modules/supertest/lib/test.js:268:12)\n    at Test._assertFunction (node_modules/supertest/lib/test.js:283:11)\n    at Test.assert (node_modules/supertest/lib/test.js:173:18)\n    at localAssert (node_modules/supertest/lib/test.js:131:12)\n    at /wazuh-api/node_modules/supertest/lib/test.js:128:5\n    at Test.Request.callback (node_modules/superagent/lib/node/index.js:716:12)\n    at /wazuh-api/node_modules/superagent/lib/node/index.js:916:18\n    at IncomingMessage.<anonymous> (node_modules/superagent/lib/node/parsers/json.js:19:7)\n    at endReadableNT (_stream_readable.js:1221:12)\n    at processTicksAndRejections (internal/process/task_queues.js:84:21)"
                },
                "isRoot": false,
                "uuid": "dc817ca5-5c76-4ea8-91c9-2cd2db610173",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "fa81db0e-236e-4fd2-a0ca-0a27def9551c",
              "118bcaeb-f154-4ad0-ae70-ea65f90c727b",
              "d655343a-7d13-401d-bec0-7c0628d4353c",
              "39814ebe-043a-48c3-a405-0ca2385e1f93",
              "7619d8e7-0690-42f5-93bd-4ed1868f65b1",
              "c64a9c4c-c770-4c2f-8a00-35492453da2b"
            ],
            "failures": [
              "dc817ca5-5c76-4ea8-91c9-2cd2db610173"
            ],
            "pending": [],
            "skipped": [],
            "duration": 2883,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "b6bf599a-24d4-4cd9-b162-194d77e02b31",
            "title": "GET/agents/no_group",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [
              {
                "title": "\"before all\" hook",
                "fullTitle": "Agents GET/agents/no_group \"before all\" hook",
                "timedOut": false,
                "duration": 336,
                "pass": false,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .put(\"/agents/\" + agent_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        agent_id = res.body.data.id;\n        setTimeout(function(){\n            done();\n        }, 30)\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "2be412c6-791f-49f2-a6b4-3ee14297c87b",
                "isHook": true,
                "skipped": false
              }
            ],
            "afterHooks": [
              {
                "title": "\"after all\" hook",
                "fullTitle": "Agents GET/agents/no_group \"after all\" hook",
                "timedOut": false,
                "duration": 276,
                "pass": false,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .delete(\"/agents/\" + agent_id + '?purge')\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "92cc56f6-92e6-4b4b-b12e-c1b018972400",
                "isHook": true,
                "skipped": false
              }
            ],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents GET/agents/no_group Request",
                "timedOut": false,
                "duration": 280,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/no_group\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.array;\n        res.body.data.should.have.properties(['items', 'totalItems']);\n        res.body.data.totalItems.should.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(['ip', 'id', 'name']);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "3b3fefa2-78f9-4df6-9342-3cc8ad970e94",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Pagination",
                "fullTitle": "Agents GET/agents/no_group Pagination",
                "timedOut": false,
                "duration": 285,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/no_group?offset=0&limit=1\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.array;\n        res.body.data.should.have.properties(['items', 'totalItems']);\n        res.body.data.totalItems.should.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(['ip', 'id', 'name']);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "719566bc-de1e-4129-a751-e4507fb061be",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Retrieve all elements with limit=0",
                "fullTitle": "Agents GET/agents/no_group Retrieve all elements with limit=0",
                "timedOut": false,
                "duration": 280,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/no_group?limit=0\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'message']);\n        res.body.error.should.equal(1406);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "fbb1b21c-e1ab-4f3d-8653-59cb95305ad5",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Sort",
                "fullTitle": "Agents GET/agents/no_group Sort",
                "timedOut": false,
                "duration": 271,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/no_group?sort=-id\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.array;\n        res.body.data.should.have.properties(['items', 'totalItems']);\n        res.body.data.totalItems.should.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(['ip', 'id', 'name']);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "899f2bd6-7bce-4b95-9702-bef193f6eff5",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Search",
                "fullTitle": "Agents GET/agents/no_group Search",
                "timedOut": false,
                "duration": 282,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/no_group?search=\" + agent_id)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.array;\n        res.body.data.should.have.properties(['items', 'totalItems']);\n        res.body.data.totalItems.should.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(['ip', 'id', 'name']);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "333be944-3441-4093-bf85-8d9be132faa2",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Select",
                "fullTitle": "Agents GET/agents/no_group Select",
                "timedOut": false,
                "duration": 272,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/no_group?select=name\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.array;\n        res.body.data.should.have.properties(['items', 'totalItems']);\n        res.body.data.totalItems.should.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(['name']);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "288b1359-e883-48d9-8d1f-9126ce56655f",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Wrong select",
                "fullTitle": "Agents GET/agents/no_group Wrong select",
                "timedOut": false,
                "duration": 269,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/no_group?select=worng_select\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'message']);\n        res.body.error.should.equal(1724);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "2ccfb5af-7749-40d1-a74f-cb8e585be1f8",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filter: status",
                "fullTitle": "Agents GET/agents/no_group Filter: status",
                "timedOut": false,
                "duration": 276,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/no_group?status=never%20connected\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties(['items','totalItems']);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "6cd93a5b-4456-4297-be43-f70b7238ecf2",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "3b3fefa2-78f9-4df6-9342-3cc8ad970e94",
              "719566bc-de1e-4129-a751-e4507fb061be",
              "fbb1b21c-e1ab-4f3d-8653-59cb95305ad5",
              "899f2bd6-7bce-4b95-9702-bef193f6eff5",
              "333be944-3441-4093-bf85-8d9be132faa2",
              "288b1359-e883-48d9-8d1f-9126ce56655f",
              "2ccfb5af-7749-40d1-a74f-cb8e585be1f8",
              "6cd93a5b-4456-4297-be43-f70b7238ecf2"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 2215,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "58074c50-641b-40c8-a7d9-0c38a1df8b0f",
            "title": "GET/agents/groups",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents GET/agents/groups Request",
                "timedOut": false,
                "duration": 280,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.array;\n    res.body.data.should.have.properties(['totalItems','items']);\n    res.body.data.items[0].should.have.properties(['count','mergedSum','configSum','name']);\n    res.body.data.items.should.be.instanceOf(Array);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "b86e78c6-fa0a-4a8d-a6fe-a45c55d97b74",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Retrieve all elements with limit=0",
                "fullTitle": "Agents GET/agents/groups Retrieve all elements with limit=0",
                "timedOut": false,
                "duration": 277,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/groups?limit=0\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'message']);\n        res.body.error.should.equal(1406);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "502cd3f0-e663-4ee7-8565-a3301d2faaaf",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Hash algorithm",
                "fullTitle": "Agents GET/agents/groups Hash algorithm",
                "timedOut": false,
                "duration": 287,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups?hash=sha256\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.have.properties(['totalItems','items']);\n    res.body.data.items[0].should.have.properties(['count','mergedSum','configSum','name']);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "13af1d9f-cbe2-4782-9124-41613a636ac2",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Wrong Hash algorithm",
                "fullTitle": "Agents GET/agents/groups Wrong Hash algorithm",
                "timedOut": false,
                "duration": 276,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups?hash=aaaaaa\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1723);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "361c0b5e-7295-4bdd-860c-5ad9f9352eb7",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filters: query 1",
                "fullTitle": "Agents GET/agents/groups Filters: query 1",
                "timedOut": false,
                "duration": 278,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups?q=name~def,name=dmz\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.data.should.be.an.array;\n    res.body.data.should.have.properties(['totalItems','items']);\n    res.body.data.items.should.be.instanceOf(Array);\n    res.body.data.items[0].should.have.properties(['count','mergedSum','configSum','name']);\n    res.body.data.totalItems.should.equal(2);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "a648be95-5f62-4dc1-b4f5-cdf721c849a9",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filters: query 2",
                "fullTitle": "Agents GET/agents/groups Filters: query 2",
                "timedOut": false,
                "duration": 275,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups?q=name=dmz,name=default\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.data.should.be.an.array;\n    res.body.data.should.have.properties(['totalItems','items']);\n    res.body.data.items.should.be.instanceOf(Array);\n    res.body.data.items[0].should.have.properties(['count','mergedSum','configSum','name']);\n    res.body.data.totalItems.should.equal(2);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "e4db1195-25e5-4a14-8306-70ac7e5f6887",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filters: query 3",
                "fullTitle": "Agents GET/agents/groups Filters: query 3",
                "timedOut": false,
                "duration": 290,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups?q=name~def;count>0\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.data.should.be.an.array;\n    res.body.data.should.have.properties(['totalItems','items']);\n    res.body.data.items.should.be.instanceOf(Array);\n    res.body.data.items[0].should.have.properties(['count','mergedSum','configSum','name']);\n    res.body.data.totalItems.should.equal(1);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "197a55d7-ef2a-40e5-9224-d20d1248afc5",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "b86e78c6-fa0a-4a8d-a6fe-a45c55d97b74",
              "502cd3f0-e663-4ee7-8565-a3301d2faaaf",
              "13af1d9f-cbe2-4782-9124-41613a636ac2",
              "361c0b5e-7295-4bdd-860c-5ad9f9352eb7",
              "a648be95-5f62-4dc1-b4f5-cdf721c849a9",
              "e4db1195-25e5-4a14-8306-70ac7e5f6887",
              "197a55d7-ef2a-40e5-9224-d20d1248afc5"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 1963,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "4db31974-3f0b-44f4-a557-83e979da3e34",
            "title": "GET/agents/groups/:group_id",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents GET/agents/groups/:group_id Request",
                "timedOut": false,
                "duration": 275,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .get(\"/agents/groups/webserver\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.data.should.have.properties(['totalItems', 'items']);\n                res.body.error.should.equal(0);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "9bde01aa-3552-4201-b81a-cdf38ec83bad",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad group name",
                "fullTitle": "Agents GET/agents/groups/:group_id Params: Bad group name",
                "timedOut": false,
                "duration": 77,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups/web!-ña\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(601);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "31aea2f7-a6f2-40d8-b0cf-d64bb678de02",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Retrieve all elements with limit=0",
                "fullTitle": "Agents GET/agents/groups/:group_id Retrieve all elements with limit=0",
                "timedOut": false,
                "duration": 282,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/groups/webserver?limit=0\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'message']);\n        res.body.error.should.equal(1406);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "24127527-0c7f-45da-b8f5-bdb650355275",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Select",
                "fullTitle": "Agents GET/agents/groups/:group_id Select",
                "timedOut": false,
                "duration": 283,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups/webserver?select=lastKeepAlive,version\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties(['totalItems', 'items']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "a71745e0-6dcd-446f-b267-f631a2aa2127",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filter: status",
                "fullTitle": "Agents GET/agents/groups/:group_id Filter: status",
                "timedOut": false,
                "duration": 282,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups/webserver?status=Active,Disconnected\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties(['totalItems', 'items']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "b710e974-1aab-40ae-9ae7-3fe2ff607cbd",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "9bde01aa-3552-4201-b81a-cdf38ec83bad",
              "31aea2f7-a6f2-40d8-b0cf-d64bb678de02",
              "24127527-0c7f-45da-b8f5-bdb650355275",
              "a71745e0-6dcd-446f-b267-f631a2aa2127",
              "b710e974-1aab-40ae-9ae7-3fe2ff607cbd"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 1199,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "40546c8e-f265-430c-9f9f-4b42cfdfe71e",
            "title": "GET/agents/groups/:group_id/configuration",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [
              {
                "title": "\"before all\" hook",
                "fullTitle": "Agents GET/agents/groups/:group_id/configuration \"before all\" hook",
                "timedOut": false,
                "duration": 1,
                "pass": false,
                "fail": false,
                "pending": false,
                "code": "// write a configuration example\nvar agent_conf_example = \"\\\n<agent_config name=\\\"agent_name\\\">\\\n    <localfile>\\\n        <location>/var/log/my.log</location>\\\n        <log_format>syslog</log_format>\\\n    </localfile>\\\n</agent_config>\\\n\";\nvar config_path = common.ossec_path+'/etc/shared/webserver/agent.conf';\nfs.writeFile(config_path, agent_conf_example, (err) => {\n    if (err) return done(err);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "0e1f2dc3-69a4-4e21-9db7-da9186d507d7",
                "isHook": true,
                "skipped": false
              }
            ],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents GET/agents/groups/:group_id/configuration Request",
                "timedOut": false,
                "duration": 274,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .get(\"/agents/groups/webserver/configuration\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.data.should.have.properties(['totalItems', 'items']);\n                res.body.error.should.equal(0);\n                res.body.data.items[0].should.have.properties(['config','filters']);\n                res.body.data.items[0].config.should.have.properties(['localfile']);\n                res.body.data.items[0].filters.should.have.properties(['name']);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "8f686108-3d04-4d97-988b-646116e01f96",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad group name",
                "fullTitle": "Agents GET/agents/groups/:group_id/configuration Params: Bad group name",
                "timedOut": false,
                "duration": 77,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups/wñ!/configuration\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(601);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "67e1dc48-3941-4da5-9640-57c97386e2f6",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Retrieve all elements with limit=0",
                "fullTitle": "Agents GET/agents/groups/:group_id/configuration Retrieve all elements with limit=0",
                "timedOut": false,
                "duration": 287,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/groups/webserver/configuration?limit=0\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'message']);\n        res.body.error.should.equal(1406);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "affb5841-d16c-4cc8-ab88-457f5a24eb14",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "8f686108-3d04-4d97-988b-646116e01f96",
              "67e1dc48-3941-4da5-9640-57c97386e2f6",
              "affb5841-d16c-4cc8-ab88-457f5a24eb14"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 638,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "82a417eb-7b10-4db7-87b7-72808b76cb6b",
            "title": "GET/agents/groups/:group_id/files",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents GET/agents/groups/:group_id/files Request",
                "timedOut": false,
                "duration": 279,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .get(\"/agents/groups/webserver/files\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.error.should.equal(0);\n                res.body.data.items[0].should.have.properties(['hash','filename']);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "041f9aa5-0776-4ff6-ba27-0575c043f80c",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad group name",
                "fullTitle": "Agents GET/agents/groups/:group_id/files Params: Bad group name",
                "timedOut": false,
                "duration": 102,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups/wñ!/files\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(601);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "49e0dc78-691c-4da7-9b6b-10f9843c48ec",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Retrieve all elements with limit=0",
                "fullTitle": "Agents GET/agents/groups/:group_id/files Retrieve all elements with limit=0",
                "timedOut": false,
                "duration": 286,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/groups/webserver/files?limit=0\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'message']);\n        res.body.error.should.equal(1406);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "31ecc497-03cc-4797-ac80-3d1312a04337",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Hash algorithm",
                "fullTitle": "Agents GET/agents/groups/:group_id/files Hash algorithm",
                "timedOut": false,
                "duration": 285,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups/webserver/files?hash=sha256\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.have.properties(['totalItems','items']);\n    res.body.data.items[0].should.have.properties(['hash','filename']);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "c0401340-047a-49bc-b54f-360afe4c78e3",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Wrong Hash algorithm",
                "fullTitle": "Agents GET/agents/groups/:group_id/files Wrong Hash algorithm",
                "timedOut": false,
                "duration": 286,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups/webserver/files?hash=aaaaaa\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1723);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "e88f7bcb-563c-4754-be9d-b95b53d1a1c6",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "041f9aa5-0776-4ff6-ba27-0575c043f80c",
              "49e0dc78-691c-4da7-9b6b-10f9843c48ec",
              "31ecc497-03cc-4797-ac80-3d1312a04337",
              "c0401340-047a-49bc-b54f-360afe4c78e3",
              "e88f7bcb-563c-4754-be9d-b95b53d1a1c6"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 1238,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "a7a1f230-56b9-4a81-b460-9f56a753d42f",
            "title": "GET/agents/groups/:group_id/files/:filename",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents GET/agents/groups/:group_id/files/:filename Request",
                "timedOut": false,
                "duration": 272,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .get(\"/agents/groups/webserver/files/agent.conf\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.error.should.equal(0);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "f8f96d32-6c8e-4c01-bf70-5b9e9cf9c4f4",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "UsingFormatAgentConfXML",
                "fullTitle": "Agents GET/agents/groups/:group_id/files/:filename UsingFormatAgentConfXML",
                "timedOut": false,
                "duration": 277,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .get(\"/agents/groups/webserver/files/agent.conf?format=xml\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.data.should.be.type('string');\n                res.body.error.should.equal(0);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "ebe1cca7-a33d-4d40-8600-36bbd0c5d2af",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "UsingFormatAgentConfJSON",
                "fullTitle": "Agents GET/agents/groups/:group_id/files/:filename UsingFormatAgentConfJSON",
                "timedOut": false,
                "duration": 277,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .get(\"/agents/groups/webserver/files/agent.conf?format=json\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.data.should.be.an.Object\n                res.body.error.should.equal(0);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "971a4b85-08bb-4ae1-87a1-721ea0668aad",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "UsingFormatRootcheckXML",
                "fullTitle": "Agents GET/agents/groups/:group_id/files/:filename UsingFormatRootcheckXML",
                "timedOut": false,
                "duration": 286,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .get(\"/agents/groups/default/files/cis_debian_linux_rcl.txt?format=xml\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.data.should.be.an.Object\n                res.body.error.should.equal(0);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "dbc0f6bc-ae66-4162-8484-e9c2804bdd85",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "UsingFormatRootcheckJSON",
                "fullTitle": "Agents GET/agents/groups/:group_id/files/:filename UsingFormatRootcheckJSON",
                "timedOut": false,
                "duration": 335,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .get(\"/agents/groups/default/files/cis_debian_linux_rcl.txt?format=json\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.data.should.be.an.Object\n                res.body.error.should.equal(0);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "b80c4164-2571-4e69-9046-916abbddd6d9",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad group name",
                "fullTitle": "Agents GET/agents/groups/:group_id/files/:filename Params: Bad group name",
                "timedOut": false,
                "duration": 89,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/groups/wñ!/files/cis_debian_linux_rcl.txt\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(601);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "863ba01f-ac49-46fb-8d58-deee807d1b76",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "f8f96d32-6c8e-4c01-bf70-5b9e9cf9c4f4",
              "ebe1cca7-a33d-4d40-8600-36bbd0c5d2af",
              "971a4b85-08bb-4ae1-87a1-721ea0668aad",
              "dbc0f6bc-ae66-4162-8484-e9c2804bdd85",
              "b80c4164-2571-4e69-9046-916abbddd6d9",
              "863ba01f-ac49-46fb-8d58-deee807d1b76"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 1536,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "8c231c59-fa5f-439b-ac2f-232902659338",
            "title": "POST/agents/groups/:group_id/configuration",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [
              {
                "title": "\"before all\" hook",
                "fullTitle": "Agents POST/agents/groups/:group_id/configuration \"before all\" hook",
                "timedOut": false,
                "duration": 288,
                "pass": false,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .put(\"/agents/groups/testsagentconf2\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "c7d8a1a5-3e2a-4bce-a928-dfc1e8362768",
                "isHook": true,
                "skipped": false
              }
            ],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents POST/agents/groups/:group_id/configuration Request",
                "timedOut": false,
                "duration": 351,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .post(\"/agents/groups/testsagentconf2/configuration\")\n            .auth(common.credentials.user, common.credentials.password)\n            .set('Content-Type', 'application/xml')\n            .send(agent_xml)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.error.should.equal(0);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "fb202e8a-883a-4171-a712-b76afa13400b",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "ErrorOnBadGroup",
                "fullTitle": "Agents POST/agents/groups/:group_id/configuration ErrorOnBadGroup",
                "timedOut": false,
                "duration": 301,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.post(\"/agents/groups/asdfg/configuration\")\n.auth(common.credentials.user, common.credentials.password)\n.set('Content-Type', 'application/xml')\n.send(agent_xml)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1710);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "dd682e6e-c6a1-4c69-8316-9138f2dfde3f",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "ErrorOnEmptyConf",
                "fullTitle": "Agents POST/agents/groups/:group_id/configuration ErrorOnEmptyConf",
                "timedOut": false,
                "duration": 131,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.post(\"/agents/groups/testsagentconf2/configuration\")\n.auth(common.credentials.user, common.credentials.password)\n.set('Content-Type', 'application/xml')\n.send(\"\")\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(703);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "6529a401-df40-40ba-9404-da7e6b6ab7e3",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "InvalidConfDetected",
                "fullTitle": "Agents POST/agents/groups/:group_id/configuration InvalidConfDetected",
                "timedOut": false,
                "duration": 116,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .post(\"/agents/groups/testsagentconf2/configuration\")\n            .auth(common.credentials.user, common.credentials.password)\n            .set('Content-Type', 'application/xml')\n            .send(invalid_xml)\n            .expect(\"Content-type\",/json/)\n            .expect(400)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'message']);\n                res.body.error.should.equal(703);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "9f73dd50-1ea6-471c-af59-ea593e3c6cd1",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "WrongConfDetected",
                "fullTitle": "Agents POST/agents/groups/:group_id/configuration WrongConfDetected",
                "timedOut": false,
                "duration": 329,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .post(\"/agents/groups/testsagentconf2/configuration\")\n            .auth(common.credentials.user, common.credentials.password)\n            .set('Content-Type', 'application/xml')\n            .send(wrong_xml)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'message']);\n                res.body.error.should.equal(1114);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "73ffeb6d-6082-4088-a674-35c406350578",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "TooBigXML",
                "fullTitle": "Agents POST/agents/groups/:group_id/configuration TooBigXML",
                "timedOut": false,
                "duration": 1730,
                "state": "failed",
                "pass": false,
                "fail": true,
                "pending": false,
                "code": "big_xml = agent_xml.repeat(600)\n            request(common.url)\n            .post(\"/agents/groups/testsagentconf2/configuration\")\n            .auth(common.credentials.user, common.credentials.password)\n            .set('Content-Type', 'application/xml')\n            .send(big_xml)\n            .expect(\"Content-type\",/json/)\n            .expect(400)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'message']);\n                res.body.error.should.equal(701);\n                done();\n            });",
                "err": {
                  "message": "Error: expected 400 \"Bad Request\", got 200 \"OK\"",
                  "estack": "Error: expected 400 \"Bad Request\", got 200 \"OK\"\n    at Test._assertStatus (node_modules/supertest/lib/test.js:268:12)\n    at Test._assertFunction (node_modules/supertest/lib/test.js:283:11)\n    at Test.assert (node_modules/supertest/lib/test.js:173:18)\n    at localAssert (node_modules/supertest/lib/test.js:131:12)\n    at /wazuh-api/node_modules/supertest/lib/test.js:128:5\n    at Test.Request.callback (node_modules/superagent/lib/node/index.js:716:12)\n    at /wazuh-api/node_modules/superagent/lib/node/index.js:916:18\n    at IncomingMessage.<anonymous> (node_modules/superagent/lib/node/parsers/json.js:19:7)\n    at endReadableNT (_stream_readable.js:1221:12)\n    at processTicksAndRejections (internal/process/task_queues.js:84:21)"
                },
                "isRoot": false,
                "uuid": "6ede237f-ae60-4703-803b-3b4331093d6d",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "fb202e8a-883a-4171-a712-b76afa13400b",
              "dd682e6e-c6a1-4c69-8316-9138f2dfde3f",
              "6529a401-df40-40ba-9404-da7e6b6ab7e3",
              "9f73dd50-1ea6-471c-af59-ea593e3c6cd1",
              "73ffeb6d-6082-4088-a674-35c406350578"
            ],
            "failures": [
              "6ede237f-ae60-4703-803b-3b4331093d6d"
            ],
            "pending": [],
            "skipped": [],
            "duration": 2958,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "b48b5f56-6c95-4089-af1f-70aee22c6207",
            "title": "DELETE/agents/:agent_id/group",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents DELETE/agents/:agent_id/group Request",
                "timedOut": false,
                "duration": 268,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .delete(\"/agents/001/group\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.error.should.equal(0);\n                res.body.data.should.be.type('string');\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "091ab41d-0879-4454-918c-69522bedad91",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Errors: ID is not present",
                "fullTitle": "Agents DELETE/agents/:agent_id/group Errors: ID is not present",
                "timedOut": false,
                "duration": 274,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .delete(\"/agents/54952/group\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'message']);\n                res.body.error.should.equal(1701);\n                res.body.message.should.be.type('string');\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "2fc0bd43-5a5d-4f02-92fa-77123d0c0750",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad agent id",
                "fullTitle": "Agents DELETE/agents/:agent_id/group Params: Bad agent id",
                "timedOut": false,
                "duration": 76,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.delete(\"/agents/abc/group\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(600);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "57c21ef6-1ce0-4d5f-a606-05245e22b90f",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "091ab41d-0879-4454-918c-69522bedad91",
              "2fc0bd43-5a5d-4f02-92fa-77123d0c0750",
              "57c21ef6-1ce0-4d5f-a606-05245e22b90f"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 618,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "867c5092-cab8-4f61-a6be-c698d2152980",
            "title": "DELETE/agents/:agent_id/group/:group_id",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [
              {
                "title": "\"before all\" hook",
                "fullTitle": "Agents DELETE/agents/:agent_id/group/:group_id \"before all\" hook",
                "timedOut": false,
                "duration": 272,
                "pass": false,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .put(\"/agents/001/group/dmz\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "52a5229b-9bc5-49cb-a826-0a35783b0f25",
                "isHook": true,
                "skipped": false
              }
            ],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents DELETE/agents/:agent_id/group/:group_id Request",
                "timedOut": false,
                "duration": 267,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .delete(\"/agents/001/group/dmz\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.error.should.equal(0);\n                res.body.data.should.be.type('string');\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "6e69406c-9d58-47cb-b31f-92bb66a04c9a",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Errors: ID is not present",
                "fullTitle": "Agents DELETE/agents/:agent_id/group/:group_id Errors: ID is not present",
                "timedOut": false,
                "duration": 264,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .delete(\"/agents/54952/group/webserver\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'message']);\n                res.body.error.should.equal(1701);\n                res.body.message.should.be.type('string');\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "a73d9e56-a096-461f-8deb-867c180059a1",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Errors: Group is not present",
                "fullTitle": "Agents DELETE/agents/:agent_id/group/:group_id Errors: Group is not present",
                "timedOut": false,
                "duration": 264,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .delete(\"/agents/001/group/adsdfdfs\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'message']);\n                res.body.error.should.equal(1734);\n                res.body.message.should.be.type('string');\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "467341df-ffcf-4c67-be67-eb55d38acd04",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad agent id",
                "fullTitle": "Agents DELETE/agents/:agent_id/group/:group_id Params: Bad agent id",
                "timedOut": false,
                "duration": 77,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.delete(\"/agents/abc/group/webserver\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(600);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "3bbdcc44-4c68-4f22-b95b-c87c01e08a8e",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad group id",
                "fullTitle": "Agents DELETE/agents/:agent_id/group/:group_id Params: Bad group id",
                "timedOut": false,
                "duration": 264,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.delete(\"/agents/001/group/aaaaaaaa\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1734);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "94ff99ab-478a-4e56-b8e9-9eb4e55ee6f5",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "6e69406c-9d58-47cb-b31f-92bb66a04c9a",
              "a73d9e56-a096-461f-8deb-867c180059a1",
              "467341df-ffcf-4c67-be67-eb55d38acd04",
              "3bbdcc44-4c68-4f22-b95b-c87c01e08a8e",
              "94ff99ab-478a-4e56-b8e9-9eb4e55ee6f5"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 1136,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "793f4f2c-6a72-4875-8c2c-bead722e9164",
            "title": "DELETE/agents/groups/:group_id",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents DELETE/agents/groups/:group_id Request",
                "timedOut": false,
                "duration": 265,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n            .delete(\"/agents/groups/webserver\")\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\"Content-type\",/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties(['error', 'data']);\n                res.body.error.should.equal(0);\n                done();\n            });",
                "err": {},
                "isRoot": false,
                "uuid": "a5aecf74-1f7b-4978-bf0e-7b19a0c2e4d6",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad group id",
                "fullTitle": "Agents DELETE/agents/groups/:group_id Params: Bad group id",
                "timedOut": false,
                "duration": 76,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.delete(\"/agents/groups/webserverñ\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(601);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "5addb651-fc7e-4c2d-828d-0d9a892dd441",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "a5aecf74-1f7b-4978-bf0e-7b19a0c2e4d6",
              "5addb651-fc7e-4c2d-828d-0d9a892dd441"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 341,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "8fa203b1-b529-41e4-b632-cb26d2ce43ab",
            "title": "DELETE/agents",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [
              {
                "title": "\"before all\" hook",
                "fullTitle": "Agents DELETE/agents \"before all\" hook",
                "timedOut": false,
                "duration": 266,
                "pass": false,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .put(\"/agents/agentToDelete\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        agent1_id = res.body.data.id;\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "f18c009d-c590-4795-adae-800d832a7359",
                "isHook": true,
                "skipped": false
              },
              {
                "title": "\"before all\" hook",
                "fullTitle": "Agents DELETE/agents \"before all\" hook",
                "timedOut": false,
                "duration": 266,
                "pass": false,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n                .put(\"/agents/agentToDelete2\")\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\"Content-type\", /json/)\n                .expect(200)\n                .end(function (err, res) {\n                    if (err) throw err;\n                    agent2_id = res.body.data.id;\n                    done();\n                });",
                "err": {},
                "isRoot": false,
                "uuid": "96060cc7-4f06-4d5e-8c10-3d19433c4a37",
                "isHook": true,
                "skipped": false
              }
            ],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents DELETE/agents Request",
                "timedOut": false,
                "duration": 76,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .delete(\"/agents\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'message']);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "512e407a-f6a3-4555-8f3f-66c6dc8befbe",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filter: older_than, status and ids",
                "fullTitle": "Agents DELETE/agents Filter: older_than, status and ids",
                "timedOut": false,
                "duration": 3810,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "setTimeout(function(){\n    request(common.url)\n        .delete(\"/agents?purge&ids=\" + agent1_id + \"&older_than=1s&status=neverconnected\")\n        .auth(common.credentials.user, common.credentials.password)\n        .expect(\"Content-type\", /json/)\n        .expect(200)\n        .end(function (err, res) {\n            if (err) return done(err);\n            res.body.should.have.properties(['error', 'data']);\n            res.body.data.should.have.properties(['affected_agents', 'msg', 'older_than']);\n            if ('failed_ids' in res.body.data && res.body.data.failed_ids.length > 0)\n                console.log(res.body.data.failed_ids[0].error);\n            res.body.data.msg.should.equal(\"All selected agents were removed\");\n            res.body.data.affected_agents[0].should.equal(agent1_id);\n            res.body.data.affected_agents.should.have.lengthOf(1);\n            res.body.error.should.equal(0);\n            setTimeout(function(){\n                done();\n            }, 30)\n        });\n}, 3500);",
                "err": {},
                "isRoot": false,
                "uuid": "c36597e6-0883-470a-b4c4-2628d26f3d9d",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Errors: Get deleted agent",
                "fullTitle": "Agents DELETE/agents Errors: Get deleted agent",
                "timedOut": false,
                "duration": 306,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/\" + agent1_id)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'message']);\n        res.body.error.should.equal(1701);\n        setTimeout(function(){\n            done();\n        }, 30)\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "57cf8bc0-2343-4676-b98b-5fd2eddcb02c",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Filter: older_than",
                "fullTitle": "Agents DELETE/agents Filter: older_than",
                "timedOut": false,
                "duration": 276,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .delete(\"/agents?older_than=1s&purge&status=neverconnected\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'data']);\n        res.body.data.should.have.properties(['affected_agents', 'msg', 'older_than']);\n        res.body.data.msg.should.equal(\"All selected agents were removed\");\n        res.body.data.affected_agents[0].should.equal(agent2_id);\n        res.body.error.should.equal(0);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "3a26c16c-f3d5-4dbc-95ef-83228f061206",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "512e407a-f6a3-4555-8f3f-66c6dc8befbe",
              "c36597e6-0883-470a-b4c4-2628d26f3d9d",
              "57cf8bc0-2343-4676-b98b-5fd2eddcb02c",
              "3a26c16c-f3d5-4dbc-95ef-83228f061206"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 4468,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "baf48c62-a7d6-4475-a8a0-9523d31df967",
            "title": "GET/agents/stats/distinct",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents GET/agents/stats/distinct Request",
                "timedOut": false,
                "duration": 267,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/stats/distinct\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.items[0].should.have.properties(fields);\n        res.body.data.items[0].os.should.have.properties(agent_os_properties);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "5abd88cb-0e03-4a60-9743-53d1d403415a",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Pagination",
                "fullTitle": "Agents GET/agents/stats/distinct Pagination",
                "timedOut": false,
                "duration": 270,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/stats/distinct?offset=0&limit=1\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(fields);\n        res.body.data.items[0].os.should.have.properties(agent_os_properties);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "dddc0d46-9a43-4cad-9a8d-e7ea747b9c3a",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Retrieve all elements with limit=0",
                "fullTitle": "Agents GET/agents/stats/distinct Retrieve all elements with limit=0",
                "timedOut": false,
                "duration": 263,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/stats/distinct?limit=0\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'message']);\n        res.body.error.should.equal(1406);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "4358d772-a103-42e2-9b6a-09f02b4e88f2",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Sort",
                "fullTitle": "Agents GET/agents/stats/distinct Sort",
                "timedOut": false,
                "duration": 269,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/stats/distinct?sort=-node_name\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(fields);\n        res.body.data.items[0].os.should.have.properties(agent_os_properties);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "a3bd9131-9759-460a-8e2a-b7d9cf65bcf4",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Search",
                "fullTitle": "Agents GET/agents/stats/distinct Search",
                "timedOut": false,
                "duration": 265,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/stats/distinct?search=linux\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(fields);\n        res.body.data.items[0].os.should.have.properties(agent_os_properties);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "f907d59f-69d2-48bd-9a9c-a4fa78920513",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Select",
                "fullTitle": "Agents GET/agents/stats/distinct Select",
                "timedOut": false,
                "duration": 264,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/stats/distinct?select=os.platform\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'data']);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(['os']);\n        res.body.data.items[0].os.should.have.properties(['platform']);\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "8b9e6aa3-3deb-45e7-b97c-2134caaf19b8",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Wrong select",
                "fullTitle": "Agents GET/agents/stats/distinct Wrong select",
                "timedOut": false,
                "duration": 265,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n    .get(\"/agents/stats/distinct?select=wrong_field\")\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\"Content-type\", /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties(['error', 'message']);\n        res.body.error.should.equal(1724);\n        res.body.message.should.be.instanceof(String)\n        done();\n    });",
                "err": {},
                "isRoot": false,
                "uuid": "e037b84c-acf1-478a-a746-08e5e8906303",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "5abd88cb-0e03-4a60-9743-53d1d403415a",
              "dddc0d46-9a43-4cad-9a8d-e7ea747b9c3a",
              "4358d772-a103-42e2-9b6a-09f02b4e88f2",
              "a3bd9131-9759-460a-8e2a-b7d9cf65bcf4",
              "f907d59f-69d2-48bd-9a9c-a4fa78920513",
              "8b9e6aa3-3deb-45e7-b97c-2134caaf19b8",
              "e037b84c-acf1-478a-a746-08e5e8906303"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 1863,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "50b03a7d-156d-4f38-87db-d6204ec404da",
            "title": "GET/agents/:agent/config/:component/:configuration",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request-Agent-Client",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Agent-Client",
                "timedOut": false,
                "duration": 275,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/002/config/agent/client\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n\t\t\t\tres.body.data.should.have.properties('client');\n\t\t\t\tres.body.data.client.should.have.properties(['crypto_method', 'remote_conf', 'auto_restart',\n\t\t\t\t'server', 'config-profile', 'time-reconnect', 'notify_time']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "00e7e5c1-e41a-4bdf-a4d5-1d6b3430afd5",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Agent-Buffer",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Agent-Buffer",
                "timedOut": false,
                "duration": 4277,
                "state": "failed",
                "pass": false,
                "fail": true,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/001/config/agent/buffer\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('buffer');\n\t\t\t\tres.body.data.buffer.should.have.properties(['disabled',\n\t\t\t\t'queue_size', 'events_per_second']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {
                  "message": "AssertionError: expected Object {\n  error: 1116,\n  message: 'Requested component configuration does not exist'\n} to have property data",
                  "estack": "AssertionError: expected Object {\n  error: 1116,\n  message: 'Requested component configuration does not exist'\n} to have property data\n    at Assertion.fail (node_modules/should/cjs/should.js:258:17)\n    at Assertion.value [as properties] (node_modules/should/cjs/should.js:335:19)\n    at Test.<anonymous> (test/test_agents.js:2375:38)\n    at Test.assert (node_modules/supertest/lib/test.js:181:6)\n    at localAssert (node_modules/supertest/lib/test.js:131:12)\n    at /wazuh-api/node_modules/supertest/lib/test.js:128:5\n    at Test.Request.callback (node_modules/superagent/lib/node/index.js:716:12)\n    at /wazuh-api/node_modules/superagent/lib/node/index.js:916:18\n    at IncomingMessage.<anonymous> (node_modules/superagent/lib/node/parsers/json.js:19:7)\n    at endReadableNT (_stream_readable.js:1221:12)\n    at processTicksAndRejections (internal/process/task_queues.js:84:21)"
                },
                "isRoot": false,
                "uuid": "c433a1c2-2cf1-436c-829e-49831280c395",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Agent-Labels",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Agent-Labels",
                "timedOut": false,
                "duration": 272,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/002/config/agent/labels\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    // res.body.data.shoul.have.properties('labels'); // empty list\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "70b23ec9-f46f-4ae3-86e3-0295679763ce",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Agent-Internal",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Agent-Internal",
                "timedOut": false,
                "duration": 272,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/002/config/agent/internal\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('internal');\n\t\t\t\tres.body.data.internal.should.have.properties(['monitord', 'remoted',\n\t\t\t\t'agent']);\n\t\t\t\tres.body.data.internal.monitord.should.have.properties(['daily_rotations',\n\t\t\t\t'day_wait', 'keep_log_days', 'compress', 'size_rotate', 'rotate_log']);\n\t\t\t\tres.body.data.internal.remoted.should.have.properties('request_rto_msec',\n\t\t\t\t'recv_counter_flush', 'request_pool', 'comp_average_printout',\n\t\t\t\t'verify_msg_id', 'max_attempts');\n\t\t\t\tres.body.data.internal.agent.should.have.properties('normal_level',\n\t\t\t\t'min_eps', 'recv_timeout', 'state_interval', 'warn_level', 'debug', 'tolerance');\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "c55c72e3-d3a5-4f63-83b3-887b7e432660",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Agentless-Agentless",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Agentless-Agentless",
                "timedOut": false,
                "duration": 268,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/agentless/agentless\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('agentless'); // returns an array\n    res.body.data.agentless[0].should.have.properties(['state', 'host',\n    'frequency', 'arguments', 'type', 'port']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "f5c6f472-9d09-4aa9-b8bb-422b4af956a7",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Analysis-Global",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Analysis-Global",
                "timedOut": false,
                "duration": 267,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/analysis/global\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties(['global']);\n    res.body.data.global.should.have.properties(['email_notification', 'max_output_size',\n    'alerts_log', 'zeromq_output', 'host_information', 'jsonout_output', 'rotate_interval',\n    'rootkit_detection', 'integrity_checking', 'memory_size', 'logall', 'prelude_output',\n    'stats', 'white_list', 'logall_json']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "f2798bb2-8775-4089-a89b-c141e069df8a",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Analysis-Active-response",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Analysis-Active-response",
                "timedOut": false,
                "duration": 270,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/analysis/active_response\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    // res.body.data.should.have.properties(['active_response']); // empty list\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "b83df369-e45c-40ae-b139-2bd5583d0290",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Analysis-Alerts",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Analysis-Alerts",
                "timedOut": false,
                "duration": 281,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/analysis/alerts\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties(['alerts']);\n    res.body.data.alerts.should.have.properties(['email_alert_level', 'log_alert_level']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "20363ce7-a0d4-483d-a529-525e1e94e8bf",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Analysis-Command",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Analysis-Command",
                "timedOut": false,
                "duration": 267,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/analysis/command\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('command');\n    res.body.data.command[0].should.have.properties(['executable', 'timeout_allowed',\n    'name', 'expect']);\n    res.body.data.command[1].should.have.properties(['executable', 'timeout_allowed',\n    'name']);\n    res.body.data.command[2].should.have.properties(['executable', 'timeout_allowed',\n    'name', 'expect']);\n    res.body.data.command[3].should.have.properties(['executable', 'timeout_allowed',\n    'name', 'expect']);\n    res.body.data.command[4].should.have.properties(['executable', 'timeout_allowed',\n    'name', 'expect']);\n    res.body.data.command[5].should.have.properties(['executable', 'timeout_allowed',\n    'name', 'expect']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "a6b5c0f9-d5c2-43a2-afcb-d4f15ac2268e",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Analysis-Internal",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Analysis-Internal",
                "timedOut": false,
                "duration": 269,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/analysis/internal\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('internal');\n    res.body.data.internal.should.have.properties(['analysisd']);\n    res.body.data.internal.analysisd.should.have.properties(['label_cache_maxage',\n    'stats_percent_diff', 'show_hidden_labels', 'decoder_order_size',\n    'min_rotate_interval', 'stats_mindiff', 'log_fw', 'rlimit_nofile', 'fts_list_size',\n    'debug', 'fts_min_size_for_str', 'default_timeframe', 'stats_maxdiff']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "ef0ba7ee-3232-478b-a3d6-b33ce3cc1ddb",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Auth-Auth",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Auth-Auth",
                "timedOut": false,
                "duration": 269,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/auth/auth\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('auth');\n    res.body.data.auth.should.have.properties(['purge', 'ssl_auto_negotiate', 'ciphers',\n    'force_insert', 'ssl_verify_host', 'limit_maxagents', 'force_time',\n    'ssl_manager_key', 'disabled', 'ssl_manager_cert', 'use_source_ip',\n    'use_password', 'port']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "b073f6a0-893c-4299-8808-1db46b3aec8f",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Com-Active-response",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Com-Active-response",
                "timedOut": false,
                "duration": 274,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/002/config/com/active-response\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties(['active-response']);\n    res.body.data['active-response'].should.have.properties(['disabled', 'ca_store']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "7943846d-675e-4d31-bfb2-04a3a4047da8",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Com-Internal",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Com-Internal",
                "timedOut": false,
                "duration": 270,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/002/config/com/internal\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties(['internal']);\n    res.body.data.internal.should.have.properties(['execd']);\n    res.body.data.internal.execd.should.have.properties(['request_timeout', 'max_restart_lock']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "f3c5695a-e634-4e21-b569-1261b9a7b2a8",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Csyslog-Csyslog",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Csyslog-Csyslog",
                "timedOut": false,
                "duration": 267,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/csyslog/csyslog\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties(['syslog_output']);\n    res.body.data['syslog_output'][0].should.have.properties(['format',\n    'level', 'use_fqdn', 'port', 'server']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "937f13ed-0bd9-4f14-aaf6-f9575a4610a1",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Integrator-Integration",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Integrator-Integration",
                "timedOut": false,
                "duration": 267,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/integrator/integration\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('integration');\n    res.body.data.integration[0].should.have.properties(['alert_format', 'hook_url',\n    'group', 'name', 'level']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "537c65e3-788e-447a-bbf4-441b5efc21ae",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Logcollector-Localfile",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Logcollector-Localfile",
                "timedOut": false,
                "duration": 271,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/002/config/logcollector/localfile\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('localfile');\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "001b3304-1c2f-4391-ad30-faa781b2119e",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Logcollector-Socket",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Logcollector-Socket",
                "timedOut": false,
                "duration": 272,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/002/config/logcollector/socket\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    // res.body.should.have.properties(['error', 'data']); // data property is empty\n    // res.body.data.should.have.properties(['socket']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "d1a97086-a11e-43b3-af6f-10f892e4b78c",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Logcollector-Internal",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Logcollector-Internal",
                "timedOut": false,
                "duration": 272,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/002/config/logcollector/internal\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('internal');\n    res.body.data.internal.should.have.properties('logcollector');\n\t\t\t\tres.body.data.internal.logcollector.should.have.properties(['open_attempts', 'input_threads',\n    'vcheck_files', 'max_files', 'sock_fail_time', 'queue_size', 'max_lines', 'remote_commands',\n    'loop_timeout', 'debug', 'open_attempts']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "51aeceab-233e-44d9-9b7e-4bc75f949e5c",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Mail-Global",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Mail-Global",
                "timedOut": false,
                "duration": 266,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/mail/global\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('global');\n    res.body.data.global.should.have.properties(['email_maxperhour', 'email_to',\n    'email_from', 'smtp_server']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "47ed5b4c-11dd-47a3-88a4-3fb20f2d49d8",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Mail-Alerts",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Mail-Alerts",
                "timedOut": false,
                "duration": 271,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/mail/alerts\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    // res.body.should.have.properties(['error', 'data']); // data property is empty\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "795072a0-718f-414f-b080-f5d8d4f3f6cb",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Mail-Internal",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Mail-Internal",
                "timedOut": false,
                "duration": 269,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/mail/internal\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('internal');\n    res.body.data.internal.should.have.properties('mail');\n    res.body.data.internal.mail.should.have.properties(['strict_checking',\n    'grouping']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "e94a0732-83b0-4902-a406-89730f79671d",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Monitor-Internal",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Monitor-Internal",
                "timedOut": false,
                "duration": 270,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/monitor/internal\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('monitord');\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "e092b206-a3ad-4280-85b4-c39de1d4a5cb",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Request-Remote",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Request-Remote",
                "timedOut": false,
                "duration": 266,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/request/remote\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('remote');\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "728b318d-055e-4912-9569-70da9b454ace",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Request-Internal",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Request-Internal",
                "timedOut": false,
                "duration": 268,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/000/config/request/internal\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties('internal');\n    res.body.data.internal.should.have.properties('remoted');\n    res.body.data.internal.remoted.should.have.properties(['request_timeout', 'pass_empty_keyfile',\n    'recv_timeout', 'request_rto_sec', 'request_rto_msec', 'response_timeout', 'sender_pool', 'recv_counter_flush',\n    'request_pool', 'comp_average_printout', 'shared_reload', 'merge_shared', 'rlimit_nofile',\n    'verify_msg_id', 'max_attempts']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "d92825c6-32ec-4504-9aaf-32fc401459d7",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Syscheck-Syscheck",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Syscheck-Syscheck",
                "timedOut": false,
                "duration": 273,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/002/config/syscheck/syscheck\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties(['syscheck']);\n    res.body.data.syscheck.should.have.properties(['ignore', 'skip_nfs', 'directories',\n    'scan_on_start', 'disabled', 'frequency', 'whodata', 'nodiff']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "df19f1eb-b27a-4769-b583-96b54028e79a",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Syscheck-Rootcheck",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Syscheck-Rootcheck",
                "timedOut": false,
                "duration": 270,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/002/config/syscheck/rootcheck\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties(['rootcheck']);\n    res.body.data.rootcheck.should.have.properties(['check_unixaudit', 'check_sys', 'rootkit_trojans',\n    'skip_nfs', 'check_if', 'check_pids', 'check_dev', 'check_ports', 'disabled', 'rootkit_files',\n    // 'frequency', 'scanall', 'check_trojans', 'base_directory', 'check_files', 'system_audit']); // base directory value is empty, this cause an error, system_audit is optional\n    'frequency', 'scanall', 'check_trojans', 'check_files']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "e81abeb6-a2c8-4f1c-baa7-18c25af414da",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Syscheck-Internal",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Syscheck-Internal",
                "timedOut": false,
                "duration": 272,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/002/config/syscheck/internal\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties(['internal']);\n    res.body.data.internal.should.have.properties(['syscheck', 'rootcheck']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "6cb412b8-6cee-4345-a82e-ffa75a3fed01",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request-Wmodules-Wmodules",
                "fullTitle": "Agents GET/agents/:agent/config/:component/:configuration Request-Wmodules-Wmodules",
                "timedOut": false,
                "duration": 273,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/agents/002/config/wmodules/wmodules\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties(['wmodules']);\n    //res.body.data.wmodules.should.have.properties(['open-scap', 'cis-cat',\n    //'osquery', 'syscollector', 'database', 'wazuh_download']);\n    res.body.data.wmodules[0].should.have.properties(['open-scap']);\n    res.body.data.wmodules[1].should.have.properties(['cis-cat']);\n    res.body.data.wmodules[2].should.have.properties(['osquery']);\n    res.body.data.wmodules[3].should.have.properties(['syscollector']);\n    res.body.error.should.equal(0);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "962c0d19-b963-49a6-8864-c317a1e39a69",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "00e7e5c1-e41a-4bdf-a4d5-1d6b3430afd5",
              "70b23ec9-f46f-4ae3-86e3-0295679763ce",
              "c55c72e3-d3a5-4f63-83b3-887b7e432660",
              "f5c6f472-9d09-4aa9-b8bb-422b4af956a7",
              "f2798bb2-8775-4089-a89b-c141e069df8a",
              "b83df369-e45c-40ae-b139-2bd5583d0290",
              "20363ce7-a0d4-483d-a529-525e1e94e8bf",
              "a6b5c0f9-d5c2-43a2-afcb-d4f15ac2268e",
              "ef0ba7ee-3232-478b-a3d6-b33ce3cc1ddb",
              "b073f6a0-893c-4299-8808-1db46b3aec8f",
              "7943846d-675e-4d31-bfb2-04a3a4047da8",
              "f3c5695a-e634-4e21-b569-1261b9a7b2a8",
              "937f13ed-0bd9-4f14-aaf6-f9575a4610a1",
              "537c65e3-788e-447a-bbf4-441b5efc21ae",
              "001b3304-1c2f-4391-ad30-faa781b2119e",
              "d1a97086-a11e-43b3-af6f-10f892e4b78c",
              "51aeceab-233e-44d9-9b7e-4bc75f949e5c",
              "47ed5b4c-11dd-47a3-88a4-3fb20f2d49d8",
              "795072a0-718f-414f-b080-f5d8d4f3f6cb",
              "e94a0732-83b0-4902-a406-89730f79671d",
              "e092b206-a3ad-4280-85b4-c39de1d4a5cb",
              "728b318d-055e-4912-9569-70da9b454ace",
              "d92825c6-32ec-4504-9aaf-32fc401459d7",
              "df19f1eb-b27a-4769-b583-96b54028e79a",
              "e81abeb6-a2c8-4f1c-baa7-18c25af414da",
              "6cb412b8-6cee-4345-a82e-ffa75a3fed01",
              "962c0d19-b963-49a6-8864-c317a1e39a69"
            ],
            "failures": [
              "c433a1c2-2cf1-436c-829e-49831280c395"
            ],
            "pending": [],
            "skipped": [],
            "duration": 11578,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "ba459a3e-f9a8-4c4a-9c74-3bacab264b0c",
            "title": "PUT/agents/restart",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents PUT/agents/restart Request",
                "timedOut": false,
                "duration": 296,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "this.timeout(common.timeout);\nrequest(common.url)\n.put(\"/agents/restart\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.type('string');\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "4d7939ba-e24a-47ec-8310-67dd072011fb",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "4d7939ba-e24a-47ec-8310-67dd072011fb"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 296,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "4035f944-fa12-4428-a58d-b68bdf2eef7d",
            "title": "PUT/agents/:agent_id/restart",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents PUT/agents/:agent_id/restart Request",
                "timedOut": false,
                "duration": 4276,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "this.timeout(common.timeout);\nrequest(common.url)\n.put(\"/agents/001/restart\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.type('object');\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "7c7fbe57-7ad4-4e9b-a5e7-5b027f9ef787",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad agent id",
                "fullTitle": "Agents PUT/agents/:agent_id/restart Params: Bad agent id",
                "timedOut": false,
                "duration": 88,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.put(\"/agents/abc/restart\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(600);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "1338f25c-3ccb-45fd-b674-b7302b60e851",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request",
                "fullTitle": "Agents PUT/agents/:agent_id/restart Request",
                "timedOut": false,
                "duration": 271,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "this.timeout(common.timeout);\nrequest(common.url)\n.put(\"/agents/000/restart\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties(['msg', 'failed_ids', 'affected_agents']);\n    res.body.data.failed_ids[0].error.code.should.equal(1703);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "7a54e688-a93e-4dcb-815f-3e7ca4ffa77b",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "7c7fbe57-7ad4-4e9b-a5e7-5b027f9ef787",
              "1338f25c-3ccb-45fd-b674-b7302b60e851",
              "7a54e688-a93e-4dcb-815f-3e7ca4ffa77b"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 4635,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "53a81718-01e7-43d7-9f57-9c4dff0eacf7",
            "title": "POST/agents/restart",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents POST/agents/restart Request",
                "timedOut": false,
                "duration": 1981,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "this.timeout(common.timeout);\nrequest(common.url)\n.post(\"/agents/restart\")\n.auth(common.credentials.user, common.credentials.password)\n.send({ 'ids': ['002']})\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.type('object');\n    res.body.data.should.have.properties(['msg', 'affected_agents']);\n    res.body.data.affected_agents[0].should.equal('002');\n    res.body.data.msg.should.equal('All selected agents were restarted');\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "94e04e01-5d9b-4999-b72c-5f901900deb0",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: A good id and a bad one",
                "fullTitle": "Agents POST/agents/restart Params: A good id and a bad one",
                "timedOut": false,
                "duration": 298,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "this.timeout(common.timeout);\nrequest(common.url)\n.post(\"/agents/restart\")\n.auth(common.credentials.user, common.credentials.password)\n.send({ 'ids': ['002', '005']})\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.type('object');\n    res.body.data.should.have.properties(['msg', 'affected_agents', 'failed_ids']);\n    res.body.data.affected_agents[0].should.equal('002');\n    res.body.data.failed_ids[0].id.should.equal('005');\n    res.body.data.failed_ids[0].error.code.should.equal(1701);\n    res.body.data.msg.should.equal('Some agents were not restarted');\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "9123fd09-1a6b-4feb-a37c-0f4bc26e54e7",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad agent id",
                "fullTitle": "Agents POST/agents/restart Params: Bad agent id",
                "timedOut": false,
                "duration": 78,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.post(\"/agents/restart\")\n.auth(common.credentials.user, common.credentials.password)\n.send({ 'ids': ['abc']})\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(616);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "967f9e3a-91d0-4ff8-950a-b7faa9af3430",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Request",
                "fullTitle": "Agents POST/agents/restart Request",
                "timedOut": false,
                "duration": 275,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "this.timeout(common.timeout);\nrequest(common.url)\n.post(\"/agents/restart\")\n.auth(common.credentials.user, common.credentials.password)\n.send({ 'ids': ['000']})\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.data.should.have.properties(['msg', 'failed_ids', 'affected_agents']);\n    res.body.data.failed_ids[0].error.code.should.equal(1703);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "76516556-ef45-4692-88c6-e2d2fe867923",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "94e04e01-5d9b-4999-b72c-5f901900deb0",
              "9123fd09-1a6b-4feb-a37c-0f4bc26e54e7",
              "967f9e3a-91d0-4ff8-950a-b7faa9af3430",
              "76516556-ef45-4692-88c6-e2d2fe867923"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 2632,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "efc43d23-5170-4346-8675-bcc298a0c839",
            "title": "PUT/agents/groups/:group_id/restart",
            "fullFile": "/wazuh-api/test/test_agents.js",
            "file": "/test/test_agents.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Agents PUT/agents/groups/:group_id/restart Request",
                "timedOut": false,
                "duration": 305,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "this.timeout(common.timeout);\nrequest(common.url)\n.put(\"/agents/groups/default/restart\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.type('object');\n    res.body.data.should.have.properties(['msg', 'affected_agents']);\n    res.body.data.affected_agents.sort().should.be.eql(['001', '002'].sort());\n    res.body.data.msg.should.equal('Some agents were not restarted');\n    res.body.data.failed_ids[0].id.should.equal('003');\n    res.body.data.failed_ids[0].error.code.should.equal(1735);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "de765b04-51be-4a22-9239-60e0b7fc8120",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad group id",
                "fullTitle": "Agents PUT/agents/groups/:group_id/restart Params: Bad group id",
                "timedOut": false,
                "duration": 277,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.put(\"/agents/groups/wrong-group/restart\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1751);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "8045fa46-ee1a-4287-aed3-0c58e1b0f528",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Group without agents",
                "fullTitle": "Agents PUT/agents/groups/:group_id/restart Group without agents",
                "timedOut": false,
                "duration": 262,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.put(\"/agents/groups/dmz/restart\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1751);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "69cff259-fffb-4d2c-96af-a61c59fa4eb3",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "de765b04-51be-4a22-9239-60e0b7fc8120",
              "8045fa46-ee1a-4287-aed3-0c58e1b0f528",
              "69cff259-fffb-4d2c-96af-a61c59fa4eb3"
            ],
            "failures": [],
            "pending": [],
            "skipped": [],
            "duration": 844,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          }
        ],
        "passes": [],
        "failures": [],
        "pending": [],
        "skipped": [],
        "duration": 0,
        "root": false,
        "rootEmpty": false,
        "_timeout": 10000
      }
    ],
    "passes": [],
    "failures": [],
    "pending": [],
    "skipped": [],
    "duration": 0,
    "root": true,
    "rootEmpty": true,
    "_timeout": 10000
  },
  "copyrightYear": 2020
}