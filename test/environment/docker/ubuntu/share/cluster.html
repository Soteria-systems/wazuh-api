<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:17,&quot;tests&quot;:115,&quot;passes&quot;:114,&quot;pending&quot;:0,&quot;failures&quot;:1,&quot;start&quot;:&quot;2020-06-08T12:17:33.520Z&quot;,&quot;end&quot;:&quot;2020-06-08T12:18:12.720Z&quot;,&quot;duration&quot;:39200,&quot;testsRegistered&quot;:115,&quot;passPercent&quot;:99.1,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false,&quot;passPercentClass&quot;:&quot;success&quot;,&quot;pendingPercentClass&quot;:&quot;danger&quot;},&quot;suites&quot;:{&quot;uuid&quot;:&quot;c92ff25c-92cc-43c4-91a6-d26033103187&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;56bd7816-fe42-44c1-9fe0-2124eee23c7d&quot;,&quot;title&quot;:&quot;Cluster&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;599fbc7d-561a-4e10-a8d2-f40e9ed2f705&quot;,&quot;title&quot;:&quot;GET/cluster/nodes&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:295,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;, &#x27;ip&#x27;, &#x27;version&#x27;, &#x27;type&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9c574fa1-8432-41d5-95e4-60c7cbc46e40&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;, &#x27;ip&#x27;, &#x27;version&#x27;, &#x27;type&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7c3385cd-1c87-477c-a032-a5cbe8c1164d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Retrieve all elements with limit=0&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes Retrieve all elements with limit=0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:287,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/nodes?limit=0\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1406);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;34afb7a3-121f-4062-9918-c4e60dad944f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Sort&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:288,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes?sort=-name\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;, &#x27;ip&#x27;, &#x27;version&#x27;, &#x27;type&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8c41ca2d-04d1-48d5-b9bf-8defca853fe5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes?search=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;, &#x27;ip&#x27;, &#x27;version&#x27;, &#x27;type&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;76e06c48-77ef-4626-9773-cdc1edb82f72&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Select&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes Select&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes?select=name,version\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;, &#x27;version&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9cf4efaf-3dc2-4bd6-a9bf-733e6783cf69&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Select 2&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes Select 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes?select=type\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;type&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5832064d-94aa-445a-9aa6-e8594a1d45da&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong select&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes Wrong select&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes?select=wrong_field\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        res.body.message.should.be.instanceof(String)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;28c8f7f3-0840-4a07-b58b-5f409df8f685&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: type&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes Filters: type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes?type=master\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;, &#x27;ip&#x27;, &#x27;version&#x27;, &#x27;type&#x27;]);\n        res.body.data.items[0].type.should.be.equal(&#x27;master&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c1c78759-5447-4bf6-9c9f-b2fb648ea4a4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: query 1&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes Filters: query 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:273,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes?q=name~worker&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;, &#x27;ip&#x27;, &#x27;version&#x27;, &#x27;type&#x27;]);\n        res.body.data.items[0].type.should.be.equal(&#x27;worker&#x27;);\n        res.body.data.totalItems.should.equal(2)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;314982c1-dc7c-43e1-b4ab-6f3093b5d7af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: query 2&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes Filters: query 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\nrequest(common.url)\n.get(\&quot;/cluster/nodes?q=name=worker-1\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;, /json/)\n.expect(200)\n.end(function (err, res) {\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n    res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n    res.body.data.items[0].should.have.properties([&#x27;name&#x27;, &#x27;ip&#x27;, &#x27;version&#x27;, &#x27;type&#x27;]);\n    res.body.data.items[0].type.should.be.equal(&#x27;worker&#x27;);\n    res.body.data.items[0].name.should.be.equal(&#x27;worker-1&#x27;);\n    res.body.data.totalItems.should.equal(1)\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7b6b1b1a-4ba3-4d7e-b5af-5f6c437c1853&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: invalid type&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes Filters: invalid type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes?type=wrong_type\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1728);\n        res.body.message.should.be.instanceof(String)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;aee15016-fc8b-4fa9-bcda-5648133263f0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9c574fa1-8432-41d5-95e4-60c7cbc46e40&quot;,&quot;7c3385cd-1c87-477c-a032-a5cbe8c1164d&quot;,&quot;34afb7a3-121f-4062-9918-c4e60dad944f&quot;,&quot;8c41ca2d-04d1-48d5-b9bf-8defca853fe5&quot;,&quot;76e06c48-77ef-4626-9773-cdc1edb82f72&quot;,&quot;9cf4efaf-3dc2-4bd6-a9bf-733e6783cf69&quot;,&quot;5832064d-94aa-445a-9aa6-e8594a1d45da&quot;,&quot;28c8f7f3-0840-4a07-b58b-5f409df8f685&quot;,&quot;c1c78759-5447-4bf6-9c9f-b2fb648ea4a4&quot;,&quot;314982c1-dc7c-43e1-b4ab-6f3093b5d7af&quot;,&quot;7b6b1b1a-4ba3-4d7e-b5af-5f6c437c1853&quot;,&quot;aee15016-fc8b-4fa9-bcda-5648133263f0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3376,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;8f8c049a-c7c0-4545-87f6-6861e8fc71bb&quot;,&quot;title&quot;:&quot;GET/cluster/:node_id/stats&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/stats \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:281,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes/\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        expected_name = res.body.data.items[0].name;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;53918e26-c0ea-4bdc-982b-eae4ce105fb3&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Cluster stats&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/stats Cluster stats&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:292,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/\&quot; + expected_name + \&quot;/stats\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        done();\n    });&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Object { error: 1308, message: &#x27;Stats file has not been created yet&#x27; } to have property data&quot;,&quot;estack&quot;:&quot;AssertionError: expected Object { error: 1308, message: &#x27;Stats file has not been created yet&#x27; } to have property data\n    at Assertion.fail (node_modules/should/cjs/should.js:258:17)\n    at Assertion.value [as properties] (node_modules/should/cjs/should.js:335:19)\n    at Test.&lt;anonymous&gt; (test/test_cluster.js:285:42)\n    at Test.assert (node_modules/supertest/lib/test.js:181:6)\n    at localAssert (node_modules/supertest/lib/test.js:131:12)\n    at /wazuh-api/node_modules/supertest/lib/test.js:128:5\n    at Test.Request.callback (node_modules/superagent/lib/node/index.js:716:12)\n    at /wazuh-api/node_modules/superagent/lib/node/index.js:916:18\n    at IncomingMessage.&lt;anonymous&gt; (node_modules/superagent/lib/node/parsers/json.js:19:7)\n    at endReadableNT (_stream_readable.js:1221:12)\n    at processTicksAndRejections (internal/process/task_queues.js:84:21)&quot;},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8355e72e-fa4a-45ec-8e9e-b36dd7bba5d8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Unexisting node stats&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/stats Unexisting node stats&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/unexisting_node/stats\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(3022);\n        res.body.message.should.be.instanceof(String)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;15505ef1-0883-402e-af77-b05fc3582258&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Analysisd stats (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/stats Analysisd stats (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/master/stats/analysisd\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;archives_queue_size&#x27;, &#x27;events_dropped&#x27;,\n                                              &#x27;rule_matching_queue_usage&#x27;, &#x27;alerts_queue_size&#x27;,\n                                              &#x27;event_queue_usage&#x27;, &#x27;events_edps&#x27;, &#x27;hostinfo_events_decoded&#x27;,\n                                              &#x27;syscollector_events_decoded&#x27;, &#x27;rootcheck_edps&#x27;, &#x27;events_processed&#x27;,\n                                              &#x27;firewall_queue_usage&#x27;, &#x27;alerts_queue_usage&#x27;, &#x27;firewall_queue_size&#x27;,\n                                              &#x27;alerts_written&#x27;, &#x27;firewall_written&#x27;, &#x27;syscheck_queue_size&#x27;,\n                                              &#x27;events_received&#x27;, &#x27;rootcheck_queue_usage&#x27;, &#x27;rootcheck_events_decoded&#x27;,\n                                              &#x27;rootcheck_queue_size&#x27;, &#x27;syscheck_edps&#x27;, &#x27;fts_written&#x27;,\n                                              &#x27;syscheck_queue_usage&#x27;, &#x27;other_events_edps&#x27;, &#x27;statistical_queue_usage&#x27;,\n                                              &#x27;hostinfo_edps&#x27;, &#x27;hostinfo_queue_usage&#x27;, &#x27;syscheck_events_decoded&#x27;,\n                                              &#x27;syscollector_queue_usage&#x27;, &#x27;archives_queue_usage&#x27;, &#x27;statistical_queue_size&#x27;,\n                                              &#x27;total_events_decoded&#x27;, &#x27;hostinfo_queue_size&#x27;, &#x27;syscollector_queue_size&#x27;,\n                                              &#x27;rule_matching_queue_size&#x27;, &#x27;other_events_decoded&#x27;, &#x27;event_queue_size&#x27;,\n                                              &#x27;syscollector_edps&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c0ab1604-4bb9-470e-aa3d-6368ecb87890&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Analysisd stats (worker-1)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/stats Analysisd stats (worker-1)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/worker-1/stats/analysisd\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;archives_queue_size&#x27;, &#x27;events_dropped&#x27;,\n                                              &#x27;rule_matching_queue_usage&#x27;, &#x27;alerts_queue_size&#x27;,\n                                              &#x27;event_queue_usage&#x27;, &#x27;events_edps&#x27;, &#x27;hostinfo_events_decoded&#x27;,\n                                              &#x27;syscollector_events_decoded&#x27;, &#x27;rootcheck_edps&#x27;, &#x27;events_processed&#x27;,\n                                              &#x27;firewall_queue_usage&#x27;, &#x27;alerts_queue_usage&#x27;, &#x27;firewall_queue_size&#x27;,\n                                              &#x27;alerts_written&#x27;, &#x27;firewall_written&#x27;, &#x27;syscheck_queue_size&#x27;,\n                                              &#x27;events_received&#x27;, &#x27;rootcheck_queue_usage&#x27;, &#x27;rootcheck_events_decoded&#x27;,\n                                              &#x27;rootcheck_queue_size&#x27;, &#x27;syscheck_edps&#x27;, &#x27;fts_written&#x27;,\n                                              &#x27;syscheck_queue_usage&#x27;, &#x27;other_events_edps&#x27;, &#x27;statistical_queue_usage&#x27;,\n                                              &#x27;hostinfo_edps&#x27;, &#x27;hostinfo_queue_usage&#x27;, &#x27;syscheck_events_decoded&#x27;,\n                                              &#x27;syscollector_queue_usage&#x27;, &#x27;archives_queue_usage&#x27;, &#x27;statistical_queue_size&#x27;,\n                                              &#x27;total_events_decoded&#x27;, &#x27;hostinfo_queue_size&#x27;, &#x27;syscollector_queue_size&#x27;,\n                                              &#x27;rule_matching_queue_size&#x27;, &#x27;other_events_decoded&#x27;, &#x27;event_queue_size&#x27;,\n                                              &#x27;syscollector_edps&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;93512dad-39e4-43e4-abbb-83bd024c2c5a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Analysisd stats (worker-2)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/stats Analysisd stats (worker-2)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/worker-2/stats/analysisd\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;archives_queue_size&#x27;, &#x27;events_dropped&#x27;,\n                                              &#x27;rule_matching_queue_usage&#x27;, &#x27;alerts_queue_size&#x27;,\n                                              &#x27;event_queue_usage&#x27;, &#x27;events_edps&#x27;, &#x27;hostinfo_events_decoded&#x27;,\n                                              &#x27;syscollector_events_decoded&#x27;, &#x27;rootcheck_edps&#x27;, &#x27;events_processed&#x27;,\n                                              &#x27;firewall_queue_usage&#x27;, &#x27;alerts_queue_usage&#x27;, &#x27;firewall_queue_size&#x27;,\n                                              &#x27;alerts_written&#x27;, &#x27;firewall_written&#x27;, &#x27;syscheck_queue_size&#x27;,\n                                              &#x27;events_received&#x27;, &#x27;rootcheck_queue_usage&#x27;, &#x27;rootcheck_events_decoded&#x27;,\n                                              &#x27;rootcheck_queue_size&#x27;, &#x27;syscheck_edps&#x27;, &#x27;fts_written&#x27;,\n                                              &#x27;syscheck_queue_usage&#x27;, &#x27;other_events_edps&#x27;, &#x27;statistical_queue_usage&#x27;,\n                                              &#x27;hostinfo_edps&#x27;, &#x27;hostinfo_queue_usage&#x27;, &#x27;syscheck_events_decoded&#x27;,\n                                              &#x27;syscollector_queue_usage&#x27;, &#x27;archives_queue_usage&#x27;, &#x27;statistical_queue_size&#x27;,\n                                              &#x27;total_events_decoded&#x27;, &#x27;hostinfo_queue_size&#x27;, &#x27;syscollector_queue_size&#x27;,\n                                              &#x27;rule_matching_queue_size&#x27;, &#x27;other_events_decoded&#x27;, &#x27;event_queue_size&#x27;,\n                                              &#x27;syscollector_edps&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e5353a2a-88bb-4abb-a57e-5cfc73658858&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Remoted stats (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/stats Remoted stats (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/master/stats/remoted\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        \n        res.body.data.should.have.properties([&#x27;discarded_count&#x27;, &#x27;msg_sent&#x27;, &#x27;queue_size&#x27;,\n                                              &#x27;ctrl_msg_count&#x27;, &#x27;evt_count&#x27;, &#x27;tcp_sessions&#x27;,\n                                              &#x27;total_queue_size&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7bec9841-f603-495a-82dd-336bed0e4a2c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Remoted stats (worker-1)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/stats Remoted stats (worker-1)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/worker-1/stats/remoted\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;discarded_count&#x27;, &#x27;msg_sent&#x27;, &#x27;queue_size&#x27;,\n                                              &#x27;ctrl_msg_count&#x27;, &#x27;evt_count&#x27;, &#x27;tcp_sessions&#x27;,\n                                              &#x27;total_queue_size&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8035d531-2084-4fa7-8ce6-5a42bcb70a5c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Remoted stats (worker-2)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/stats Remoted stats (worker-2)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:288,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/worker-2/stats/remoted\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;discarded_count&#x27;, &#x27;msg_sent&#x27;, &#x27;queue_size&#x27;,\n                                              &#x27;ctrl_msg_count&#x27;, &#x27;evt_count&#x27;, &#x27;tcp_sessions&#x27;,\n                                              &#x27;total_queue_size&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;cc3252af-6114-4fa3-8eeb-2c76bc011d68&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;15505ef1-0883-402e-af77-b05fc3582258&quot;,&quot;c0ab1604-4bb9-470e-aa3d-6368ecb87890&quot;,&quot;93512dad-39e4-43e4-abbb-83bd024c2c5a&quot;,&quot;e5353a2a-88bb-4abb-a57e-5cfc73658858&quot;,&quot;7bec9841-f603-495a-82dd-336bed0e4a2c&quot;,&quot;8035d531-2084-4fa7-8ce6-5a42bcb70a5c&quot;,&quot;cc3252af-6114-4fa3-8eeb-2c76bc011d68&quot;],&quot;failures&quot;:[&quot;8355e72e-fa4a-45ec-8e9e-b36dd7bba5d8&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2228,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;a25de27f-27d7-4502-ad85-e82aa41e3a25&quot;,&quot;title&quot;:&quot;GET/cluster/:node_id/logs&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/logs Request (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:326,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/logs\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.totalItems.should.be.instanceof(Number);\n        res.body.data.items[0].should.have.properties([&#x27;timestamp&#x27;, &#x27;tag&#x27;, &#x27;level&#x27;, &#x27;description&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3220bae8-95e8-456b-8f00-c6bb69f2417d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request (worker-1)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/logs Request (worker-1)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/worker-1/logs\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.totalItems.should.be.instanceof(Number);\n        res.body.data.items[0].should.have.properties([&#x27;timestamp&#x27;, &#x27;tag&#x27;, &#x27;level&#x27;, &#x27;description&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;35ca0b64-afc4-4ca9-bbdc-0df0a1200045&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request (worker-2)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/logs Request (worker-2)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/worker-2/logs\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.totalItems.should.be.instanceof(Number);\n        res.body.data.items[0].should.have.properties([&#x27;timestamp&#x27;, &#x27;tag&#x27;, &#x27;level&#x27;, &#x27;description&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c76a3e83-8805-46b4-806f-adb60c3146ad&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/logs Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:322,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/logs?offset=1&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.totalItems.should.be.instanceof(Number);\n        res.body.data.items[0].should.have.properties([&#x27;timestamp&#x27;, &#x27;tag&#x27;, &#x27;level&#x27;, &#x27;description&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e0a35fe7-6b3b-4879-8048-7bf2d6f830a0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Sort&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/logs Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:315,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/logs?sort=timestamp\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.totalItems.should.be.instanceof(Number);\n        res.body.data.items[0].should.have.properties([&#x27;timestamp&#x27;, &#x27;tag&#x27;, &#x27;level&#x27;, &#x27;description&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2354d459-38f2-4db4-a366-40388e046c3e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/logs Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:324,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/logs?search=analysisd&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.totalItems.should.be.instanceof(Number);\n        res.body.data.items[0].should.have.properties([&#x27;timestamp&#x27;, &#x27;tag&#x27;, &#x27;level&#x27;, &#x27;description&#x27;]);\n        res.body.data.items[0].tag.should.be.equal(&#x27;ossec-analysisd&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c4323752-1f28-4630-a4f0-bcad5558c7bb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: type_log&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/logs Filters: type_log&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:323,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/logs?type_log=info&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.totalItems.should.be.instanceof(Number);\n        res.body.data.items[0].should.have.properties([&#x27;timestamp&#x27;, &#x27;tag&#x27;, &#x27;level&#x27;, &#x27;description&#x27;]);\n        res.body.data.items[0].level.should.be.equal(&#x27;info&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;76829b13-f443-4ac4-8158-aa3c5aa3e393&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: category&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/logs Filters: category&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:333,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/logs?category=ossec-execd&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.totalItems.should.be.instanceof(Number);\n        res.body.data.items[0].should.have.properties([&#x27;timestamp&#x27;, &#x27;tag&#x27;, &#x27;level&#x27;, &#x27;description&#x27;]);\n        res.body.data.items[0].tag.should.be.equal(&#x27;ossec-execd&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ae8292db-aa6e-4fb4-8410-39e058c5b7d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: query 1&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/logs Filters: query 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:334,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/logs?q=tag=ossec-analysisd;level=info&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.totalItems.should.be.instanceof(Number);\n        res.body.data.items[0].should.have.properties([&#x27;timestamp&#x27;, &#x27;tag&#x27;, &#x27;level&#x27;, &#x27;description&#x27;]);\n        res.body.data.items[0].tag.should.be.equal(&#x27;ossec-analysisd&#x27;);\n        res.body.data.items[0].level.should.be.equal(&#x27;info&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;684b861f-7413-43f6-93b9-dbbb2ac4680f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: query 2&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/logs Filters: query 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:333,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/logs?q=tag=ossec-analysisd;level=info&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.totalItems.should.be.instanceof(Number);\n        res.body.data.items[0].should.have.properties([&#x27;timestamp&#x27;, &#x27;tag&#x27;, &#x27;level&#x27;, &#x27;description&#x27;]);\n        res.body.data.items[0].tag.should.be.equal(&#x27;ossec-analysisd&#x27;);\n        res.body.data.items[0].level.should.be.equal(&#x27;info&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4269610a-fb94-490f-be89-bdd87aa1c10c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: query 3&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/logs Filters: query 3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:323,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/logs?q=tag~ossec;level=info&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.totalItems.should.be.instanceof(Number);\n        res.body.data.items[0].should.have.properties([&#x27;timestamp&#x27;, &#x27;tag&#x27;, &#x27;level&#x27;, &#x27;description&#x27;]);\n        res.body.data.items[0].tag.should.startWith(&#x27;ossec&#x27;);\n        res.body.data.items[0].level.should.be.equal(&#x27;info&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;938d0811-fbf0-4529-8c26-be4f209b3376&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: wrong query&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/logs Filters: wrong query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:80,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/logs?q=ossec\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(622);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7a52acf8-145d-4bee-a573-9c96b38cc8c7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3220bae8-95e8-456b-8f00-c6bb69f2417d&quot;,&quot;35ca0b64-afc4-4ca9-bbdc-0df0a1200045&quot;,&quot;c76a3e83-8805-46b4-806f-adb60c3146ad&quot;,&quot;e0a35fe7-6b3b-4879-8048-7bf2d6f830a0&quot;,&quot;2354d459-38f2-4db4-a366-40388e046c3e&quot;,&quot;c4323752-1f28-4630-a4f0-bcad5558c7bb&quot;,&quot;76829b13-f443-4ac4-8158-aa3c5aa3e393&quot;,&quot;ae8292db-aa6e-4fb4-8410-39e058c5b7d6&quot;,&quot;684b861f-7413-43f6-93b9-dbbb2ac4680f&quot;,&quot;4269610a-fb94-490f-be89-bdd87aa1c10c&quot;,&quot;938d0811-fbf0-4529-8c26-be4f209b3376&quot;,&quot;7a52acf8-145d-4bee-a573-9c96b38cc8c7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3574,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;23934a8d-e0dd-40fa-8295-e6318042c630&quot;,&quot;title&quot;:&quot;GET/cluster/nodes/:node_name&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes/:node_name \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes/\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        expected_name = res.body.data.items[0].name;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a236e5dd-7de4-4920-bc6d-736703b805c3&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes/:node_name Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes/\&quot; + expected_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;name&#x27;, &#x27;ip&#x27;, &#x27;version&#x27;, &#x27;type&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6b356411-7bbe-4f69-a158-351189f47c42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request wrong name&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/nodes/:node_name Request wrong name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:273,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes/wrong_name\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1730);\n        res.body.message.should.be.instanceof(String)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e7ec237e-b3b1-415d-9ca7-5d2a5373b1e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6b356411-7bbe-4f69-a158-351189f47c42&quot;,&quot;e7ec237e-b3b1-415d-9ca7-5d2a5373b1e5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:556,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;2432e338-5494-45e3-8b31-932615d8d117&quot;,&quot;title&quot;:&quot;GET/cluster/status&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/status Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/status\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;running&#x27;, &#x27;enabled&#x27;]);\n        res.body.data.running.should.be.instanceof(String);\n        res.body.data.enabled.should.be.instanceof(String);\n        res.body.data.running.should.be.equal(\&quot;yes\&quot;);\n        res.body.data.enabled.should.be.equal(\&quot;yes\&quot;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1da06737-80c8-4f71-b10e-d1145bd77521&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1da06737-80c8-4f71-b10e-d1145bd77521&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:269,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;efb46bca-fe54-41b2-9ab6-a8f334e4ee80&quot;,&quot;title&quot;:&quot;GET/cluster/config&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/config Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:263,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/config\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;disabled&#x27;, &#x27;hidden&#x27;, &#x27;name&#x27;, &#x27;node_name&#x27;, &#x27;bind_addr&#x27;, &#x27;node_type&#x27;, &#x27;key&#x27;, &#x27;nodes&#x27;, &#x27;port&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;69b3a5a9-1135-4145-8647-dd8b48d0889b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;69b3a5a9-1135-4145-8647-dd8b48d0889b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:263,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;2574a051-d0f9-49b8-93aa-2d6a79c1cae3&quot;,&quot;title&quot;:&quot;GET/cluster/healthcheck&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/healthcheck \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:287,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/nodes/\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        expected_name_master = res.body.data.items[0].name;\n        expected_name_worker = res.body.data.items[1].name;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;275b3f6b-03a9-4ea8-93f4-d07fa4c44252&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/healthcheck Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:297,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/healthcheck\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;nodes&#x27;, &#x27;n_connected_nodes&#x27;]);\n        res.body.data.n_connected_nodes.should.be.above(0)\n        res.body.data.nodes.should.have.properties([expected_name_worker, expected_name_master]);\n        // master\n        res.body.data.nodes[expected_name_master].should.have.properties([&#x27;info&#x27;]);\n        res.body.data.nodes[expected_name_master].info.should.have.properties([&#x27;ip&#x27;, &#x27;version&#x27;, &#x27;type&#x27;, &#x27;name&#x27;, &#x27;n_active_agents&#x27;]);\n        res.body.data.nodes[expected_name_master].info.n_active_agents.should.be.instanceof(Number)\n        res.body.data.nodes[expected_name_master].info.name.should.be.equal(expected_name_master);\n        res.body.data.nodes[expected_name_master].info.type.should.be.equal(&#x27;master&#x27;);\n\n        // worker\n        res.body.data.nodes[expected_name_worker].should.have.properties([&#x27;info&#x27;, &#x27;status&#x27;]);\n        res.body.data.nodes[expected_name_worker].info.should.have.properties([&#x27;ip&#x27;, &#x27;version&#x27;, &#x27;type&#x27;, &#x27;name&#x27;, &#x27;n_active_agents&#x27;]);\n        res.body.data.nodes[expected_name_worker].info.n_active_agents.should.be.instanceof(Number)\n        res.body.data.nodes[expected_name_worker].info.name.should.be.equal(expected_name_worker);\n        res.body.data.nodes[expected_name_worker].info.type.should.be.equal(&#x27;worker&#x27;);\n        res.body.data.nodes[expected_name_worker].status.should.have.properties([&#x27;last_sync_agentinfo&#x27;, &#x27;sync_integrity_free&#x27;, &#x27;last_sync_agentgroups&#x27;, &#x27;last_sync_integrity&#x27;, &#x27;sync_agentinfo_free&#x27;, &#x27;sync_extravalid_free&#x27;]);\n        res.body.data.nodes[expected_name_worker].status.last_sync_agentinfo.should.have.properties([&#x27;date_start_master&#x27;, &#x27;date_end_master&#x27;, &#x27;total_agentinfo&#x27;]);\n        res.body.data.nodes[expected_name_worker].status.last_sync_agentinfo.total_agentinfo.should.be.instanceof(Number);\n        res.body.data.nodes[expected_name_worker].status.sync_integrity_free.should.be.instanceof(Boolean);\n        res.body.data.nodes[expected_name_worker].status.last_sync_agentgroups.should.have.properties([&#x27;date_end_master&#x27;, &#x27;date_start_master&#x27;, &#x27;total_agentgroups&#x27;]);\n        res.body.data.nodes[expected_name_worker].status.last_sync_agentgroups.total_agentgroups.should.be.instanceof(Number);\n        res.body.data.nodes[expected_name_worker].status.sync_agentinfo_free.should.be.instanceof(Boolean);\n        res.body.data.nodes[expected_name_worker].status.sync_extravalid_free.should.be.instanceof(Boolean);\n        res.body.data.nodes[expected_name_worker].status.last_sync_integrity.should.have.properties([&#x27;total_files&#x27;, &#x27;date_end_master&#x27;, &#x27;date_start_master&#x27;]);\n        res.body.data.nodes[expected_name_worker].status.last_sync_integrity.total_files.should.have.properties([&#x27;shared&#x27;, &#x27;missing&#x27;, &#x27;extra_valid&#x27;, &#x27;extra&#x27;]);\n        res.body.data.nodes[expected_name_worker].status.last_sync_integrity.total_files.shared.should.be.instanceof(Number);\n        res.body.data.nodes[expected_name_worker].status.last_sync_integrity.total_files.missing.should.be.instanceof(Number);\n        res.body.data.nodes[expected_name_worker].status.last_sync_integrity.total_files.extra_valid.should.be.instanceof(Number);\n        res.body.data.nodes[expected_name_worker].status.last_sync_integrity.total_files.extra.should.be.instanceof(Number);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;bf5b751a-a322-4471-ab1d-c528be268acf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: node name&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/healthcheck Filter: node name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:577,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/healthcheck?node=\&quot; + expected_name_worker)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;nodes&#x27;, &#x27;n_connected_nodes&#x27;]);\n        res.body.data.n_connected_nodes.should.be.above(0)\n        res.body.data.nodes.should.have.properties([expected_name_worker]);\n\n        // worker\n        res.body.data.nodes[expected_name_worker].should.have.properties([&#x27;info&#x27;, &#x27;status&#x27;]);\n        res.body.data.nodes[expected_name_worker].info.should.have.properties([&#x27;ip&#x27;, &#x27;version&#x27;, &#x27;type&#x27;, &#x27;name&#x27;, &#x27;n_active_agents&#x27;]);\n        res.body.data.nodes[expected_name_worker].info.n_active_agents.should.be.instanceof(Number)\n        res.body.data.nodes[expected_name_worker].info.name.should.be.equal(expected_name_worker);\n        res.body.data.nodes[expected_name_worker].info.type.should.be.equal(&#x27;worker&#x27;);\n        res.body.data.nodes[expected_name_worker].status.should.have.properties([&#x27;last_sync_agentinfo&#x27;, &#x27;sync_integrity_free&#x27;, &#x27;last_sync_agentgroups&#x27;, &#x27;last_sync_integrity&#x27;, &#x27;sync_agentinfo_free&#x27;, &#x27;sync_extravalid_free&#x27;]);\n        res.body.data.nodes[expected_name_worker].status.last_sync_agentinfo.should.have.properties([&#x27;date_start_master&#x27;, &#x27;date_end_master&#x27;, &#x27;total_agentinfo&#x27;]);\n        res.body.data.nodes[expected_name_worker].status.last_sync_agentinfo.total_agentinfo.should.be.instanceof(Number);\n        res.body.data.nodes[expected_name_worker].status.sync_integrity_free.should.be.instanceof(Boolean);\n        res.body.data.nodes[expected_name_worker].status.last_sync_agentgroups.should.have.properties([&#x27;date_end_master&#x27;, &#x27;date_start_master&#x27;, &#x27;total_agentgroups&#x27;]);\n        res.body.data.nodes[expected_name_worker].status.last_sync_agentgroups.total_agentgroups.should.be.instanceof(Number);\n        res.body.data.nodes[expected_name_worker].status.sync_agentinfo_free.should.be.instanceof(Boolean);\n        res.body.data.nodes[expected_name_worker].status.sync_extravalid_free.should.be.instanceof(Boolean);\n        res.body.data.nodes[expected_name_worker].status.last_sync_integrity.should.have.properties([&#x27;total_files&#x27;, &#x27;date_end_master&#x27;, &#x27;date_start_master&#x27;]);\n        res.body.data.nodes[expected_name_worker].status.last_sync_integrity.total_files.should.have.properties([&#x27;shared&#x27;, &#x27;missing&#x27;, &#x27;extra_valid&#x27;, &#x27;extra&#x27;]);\n        res.body.data.nodes[expected_name_worker].status.last_sync_integrity.total_files.shared.should.be.instanceof(Number);\n        res.body.data.nodes[expected_name_worker].status.last_sync_integrity.total_files.missing.should.be.instanceof(Number);\n        res.body.data.nodes[expected_name_worker].status.last_sync_integrity.total_files.extra_valid.should.be.instanceof(Number);\n        res.body.data.nodes[expected_name_worker].status.last_sync_integrity.total_files.extra.should.be.instanceof(Number);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f85ea842-2f22-414f-83af-ab9631ff8eab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;bf5b751a-a322-4471-ab1d-c528be268acf&quot;,&quot;f85ea842-2f22-414f-83af-ab9631ff8eab&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:874,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;ad744ad7-5c2f-49df-911b-5f68cd1e474b&quot;,&quot;title&quot;:&quot;POST/cluster/:node_id/files&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:708,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/master/files?path=\&quot; + path_ossec_conf)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.string;\n        ossec_conf_content_master = res.body.data\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;80b84dfa-13b0-4371-aa99-3459ff7f975b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:694,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/worker-1/files?path=\&quot; + path_ossec_conf)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.string;\n        ossec_conf_content_worker = res.body.data\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d894f402-e424-46fe-afa0-b2f45cb241f5&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Upload ossec.conf (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload ossec.conf (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:660,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_ossec_conf + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(ossec_conf_content_master)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;91a0465a-0448-4dab-abbd-e248c36598a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload ossec.conf (worker)&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload ossec.conf (worker)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:393,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/worker-1/files?path=\&quot; + path_ossec_conf + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(ossec_conf_content_worker)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e0a05d05-b4bc-4444-b14b-3792532a3c8e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload new rules&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload new rules&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:316,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_rules + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!-- Local rules --&gt;\\n  &lt;!-- Modify it at your will. --&gt;\\n  &lt;!-- Example --&gt;\\n  &lt;group name=\\\&quot;local,\\\&quot;&gt;\\n    &lt;!--   NEW RULE    --&gt;\\n    &lt;rule id=\\\&quot;111111\\\&quot; level=\\\&quot;5\\\&quot;&gt;\\n      &lt;if_sid&gt;5716&lt;/if_sid&gt;\\n      &lt;srcip&gt;1.1.1.1&lt;/srcip&gt;\\n      &lt;description&gt;sshd: authentication failed from IP 1.1.1.1.&lt;/description&gt;\\n      &lt;group&gt;authentication_failed,pci_dss_10.2.4,pci_dss_10.2.5,&lt;/group&gt;\\n    &lt;/rule&gt;\\n  &lt;/group&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;56cf95f1-f7b6-4b30-8f5d-fe2084bda3b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload rules (overwrite=true)&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload rules (overwrite=true)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_rules + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!-- Local rules --&gt;\\n  &lt;!-- Modify it at your will. --&gt;\\n  &lt;!-- Example --&gt;\\n  &lt;group name=\\\&quot;local,\\\&quot;&gt;\\n    &lt;!--   NEW RULE    --&gt;\\n    &lt;rule id=\\\&quot;111111\\\&quot; level=\\\&quot;5\\\&quot;&gt;\\n      &lt;if_sid&gt;5716&lt;/if_sid&gt;\\n      &lt;srcip&gt;1.1.1.1&lt;/srcip&gt;\\n      &lt;description&gt;sshd: authentication failed from IP 1.1.1.1.&lt;/description&gt;\\n      &lt;group&gt;authentication_failed,pci_dss_10.2.4,pci_dss_10.2.5,&lt;/group&gt;\\n    &lt;/rule&gt;\\n  &lt;/group&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c3add7f4-d498-4e10-8488-f00629c0e568&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload rules (overwrite=false)&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload rules (overwrite=false)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_rules + \&quot;&amp;overwrite=false\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!-- Local rules --&gt;\\n  &lt;!-- Modify it at your will. --&gt;\\n  &lt;!-- Example --&gt;\\n  &lt;group name=\\\&quot;local,\\\&quot;&gt;\\n    &lt;!--   NEW RULE    --&gt;\\n    &lt;rule id=\\\&quot;111111\\\&quot; level=\\\&quot;5\\\&quot;&gt;\\n      &lt;if_sid&gt;5716&lt;/if_sid&gt;\\n      &lt;srcip&gt;1.1.1.1&lt;/srcip&gt;\\n      &lt;description&gt;sshd: authentication failed from IP 1.1.1.1.&lt;/description&gt;\\n      &lt;group&gt;authentication_failed,pci_dss_10.2.4,pci_dss_10.2.5,&lt;/group&gt;\\n    &lt;/rule&gt;\\n  &lt;/group&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1905);\n    res.body.message.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3c482455-9207-48e3-a24f-affa77640807&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload new decoder&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload new decoder&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_decoders + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!-- NEW Local Decoders --&gt;\\n  &lt;!-- Modify it at your will. --&gt;\\n  &lt;decoder name=\\\&quot;local_decoder_example\\\&quot;&gt;\\n    &lt;program_name&gt;NEW DECODER&lt;/program_name&gt;\\n  &lt;/decoder&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;46f2ea34-5f2d-4829-8989-ed96da74c2a0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload decoder (overwrite=true)&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload decoder (overwrite=true)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_decoders + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!-- NEW Local Decoders --&gt;\\n  &lt;!-- Modify it at your will. --&gt;\\n  &lt;decoder name=\\\&quot;local_decoder_example\\\&quot;&gt;\\n    &lt;program_name&gt;NEW DECODER&lt;/program_name&gt;\\n  &lt;/decoder&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f4c771a1-93f6-4d6a-9b3f-1ee8113054b1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload decoder (without overwrite parameter)&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload decoder (without overwrite parameter)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_decoders)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!-- NEW Local Decoders --&gt;\\n  &lt;!-- Modify it at your will. --&gt;\\n  &lt;decoder name=\\\&quot;local_decoder_example\\\&quot;&gt;\\n    &lt;program_name&gt;NEW DECODER&lt;/program_name&gt;\\n  &lt;/decoder&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1905);\n    res.body.message.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ee2a6a52-91fa-4828-beba-4c4d0c52f650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload new list&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload new list&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_lists + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/octet-stream\&quot;)\n.send(\&quot;test-wazuh-w:write\\ntest-wazuh-r:read\\ntest-wazuh-a:attribute\\ntest-wazuh-x:execute\\ntest-wazuh-c:command\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9623cf7b-6172-4b97-87cd-ce7f9755823f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload list (overwrite=true)&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload list (overwrite=true)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_lists + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/octet-stream\&quot;)\n.send(\&quot;test-wazuh-w:write\\ntest-wazuh-r:read\\ntest-wazuh-a:attribute\\ntest-wazuh-x:execute\\ntest-wazuh-c:command\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a7ee0f04-078e-408b-8f4c-0b2721dbb661&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload list (overwrite=false)&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload list (overwrite=false)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_lists + \&quot;&amp;overwrite=false\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/octet-stream\&quot;)\n.send(\&quot;test-wazuh-w:write\\ntest-wazuh-r:read\\ntest-wazuh-a:attribute\\ntest-wazuh-x:execute\\ntest-wazuh-c:command\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1905);\n    res.body.message.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;482ad722-0f91-4852-a03b-46852dbf357f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload corrupted ossec.conf (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload corrupted ossec.conf (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_ossec_conf + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!--  Wazuh - Manager --&gt;\\n  &lt;ossec_config&gt;\\n    &lt;global&gt;\\n      &lt;jsonout_output&gt;&lt;&lt;&lt;&lt;yes&lt;/jsonout_output&gt;\\n      &lt;alerts_log&gt;yes&lt;/alerts_log&gt;\\n      &lt;logall&gt;no&lt;/logall&gt;\\n      &lt;logall_json&gt;no&lt;/logall_json&gt;\\n      &lt;email_notification&gt;no&lt;/email_notification&gt;\\n      &lt;smtp_server&gt;smtp.example.wazuh.com&lt;/smtp_server&gt;\\n      &lt;email_from&gt;ossecm@example.wazuh.com&lt;/email_from&gt;\\n      &lt;email_to&gt;recipient@example.wazuh.com&lt;/email_to&gt;\\n      &lt;email_maxperhour&gt;12&lt;/email_maxperhour&gt;\\n      &lt;email_log_source&gt;alerts.log&lt;/email_log_source&gt;\\n      &lt;queue_size&gt;131072&lt;/queue_size&gt;\\n    &lt;/global&gt;\\n  &lt;/ossec_config&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(703);\n    res.body.message.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;60147005-88b3-4ef5-b45a-fcb4ded4e66d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload corrupted ossec.conf (worker)&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload corrupted ossec.conf (worker)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/worker-1/files?path=\&quot; + path_ossec_conf + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!--  Wazuh - Manager --&gt;\\n  &lt;ossec_config&gt;\\n    &lt;global&gt;\\n      &lt;jsonout_output&gt;&lt;&lt;&lt;&lt;yes&lt;/jsonout_output&gt;\\n      &lt;alerts_log&gt;yes&lt;/alerts_log&gt;\\n      &lt;logall&gt;no&lt;/logall&gt;\\n      &lt;logall_json&gt;no&lt;/logall_json&gt;\\n      &lt;email_notification&gt;no&lt;/email_notification&gt;\\n      &lt;smtp_server&gt;smtp.example.wazuh.com&lt;/smtp_server&gt;\\n      &lt;email_from&gt;ossecm@example.wazuh.com&lt;/email_from&gt;\\n      &lt;email_to&gt;recipient@example.wazuh.com&lt;/email_to&gt;\\n      &lt;email_maxperhour&gt;12&lt;/email_maxperhour&gt;\\n      &lt;email_log_source&gt;alerts.log&lt;/email_log_source&gt;\\n      &lt;queue_size&gt;131072&lt;/queue_size&gt;\\n    &lt;/global&gt;\\n  &lt;/ossec_config&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(703);\n    res.body.message.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a221b8a1-671c-4e14-add8-e02eea4ba443&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload malformed rules&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload malformed rules&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_rules + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!--   NEW RULE    --&gt;\\n    &lt;rule id=\\\&quot;100001111\\\&quot; level=\\\&quot;5\\\&quot;&gt;\\n      &lt;if_sid&gt;5716&lt;/if_sid&gt;\\n      &lt;srcip&gt;1.1.1.1&lt;/srcip&gt;\\n      &lt;description&gt;sshd: authentication failed from IP 1.1.1.1.&lt;/description&gt;\\n      &lt;group&gt;authentication_failed,pci_dss_10.2.4,pci_dss_10.2.5,&lt;/group&gt;\\n    &lt;/rule&gt;\\n  &lt;/group&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(703);\n    res.body.message.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;cf1cdce4-7d8a-4ae8-8638-c41eaefb55aa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload rules to unexisting node&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload rules to unexisting node&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:304,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/TESTNODE001/files?path=\&quot; + path_rules)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!-- Local rules --&gt;\\n  &lt;!-- Modify it at your will. --&gt;\\n  &lt;!-- Example --&gt;\\n  &lt;group name=\\\&quot;local,\\\&quot;&gt;\\n    &lt;!--   NEW RULE    --&gt;\\n    &lt;rule id=\\\&quot;100001111\\\&quot; level=\\\&quot;5\\\&quot;&gt;\\n      &lt;if_sid&gt;5716&lt;/if_sid&gt;\\n      &lt;srcip&gt;1.1.1.1&lt;/srcip&gt;\\n      &lt;description&gt;sshd: authentication failed from IP 1.1.1.1.&lt;/description&gt;\\n      &lt;group&gt;authentication_failed,pci_dss_10.2.4,pci_dss_10.2.5,&lt;/group&gt;\\n    &lt;/rule&gt;\\n  &lt;/group&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(3022);\n    res.body.message.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;042d09c8-bf65-46e1-af3f-ebdb530beb82&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload malformed decoder&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload malformed decoder&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_decoders + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!-- NEW Local Decoders --&gt;\\n  &lt;!-- Modify it at your will. --&gt;\\n  &lt;decoder name=\\\&quot;local_decoder_example\\\&quot;&gt;\\n    &lt;program_name&gt;NEW &lt;DECODER&lt;/program_name&gt;\\n  &lt;/decoder&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(703);\n    res.body.message.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a7051972-a419-41c7-ad56-3723ba35a1ad&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload decoder to unexisting node&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload decoder to unexisting node&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:287,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/TESTNODE001/files?path=\&quot; + path_decoders)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!-- NEW Local Decoders --&gt;\\n  &lt;!-- Modify it at your will. --&gt;\\n  &lt;decoder name=\\\&quot;local_decoder_example\\\&quot;&gt;\\n    &lt;program_name&gt;NEW DECODER&lt;/program_name&gt;\\n  &lt;/decoder&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(3022);\n    res.body.message.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;17a4fb7a-9a17-4a16-9031-78ba34694140&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload malformed list&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload malformed list&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:79,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_lists + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/octet-stream\&quot;)\n.send(\&quot;:write\\ntest-wazuh-r:read\\ntest-wazuh-a:attribute\\ntest-wazuh-x:execute\\ntest-wazuh-c:command\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(705);\n    res.body.message.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;59f34f38-8bdf-4a48-85d0-fd7d8ced4db8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload list to unexisting node&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload list to unexisting node&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/TESTNODE001/files?path=\&quot; + path_lists)\n.set(\&quot;Content-Type\&quot;, \&quot;application/octet-stream\&quot;)\n.send(\&quot;test-wazuh-w:write\\ntest-wazuh-r:read\\ntest-wazuh-a:attribute\\ntest-wazuh-x:execute\\ntest-wazuh-c:command\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(3022);\n    res.body.message.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;954f8050-7d3a-43fb-af82-ff80aead7d1c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload list with empty path&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload list with empty path&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/octet-stream\&quot;)\n.send(\&quot;test&amp;%-wazuh-w:write\\ntest-wazuh-r:read\\ntest-wazuh-a:attribute\\ntest-wazuh-x:execute\\ntest-wazuh-c:command\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(706);\n    res.body.message.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f9f262a7-78f9-430b-b889-192858dec733&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Upload a file with a wrong content type&quot;,&quot;fullTitle&quot;:&quot;Cluster POST/cluster/:node_id/files Upload a file with a wrong content type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=etc/lists/new-list\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/x-www-form-urlencoded\&quot;)\n.send(\&quot;test&amp;%-wazuh-w:write\\ntest-wazuh-r:read\\ntest-wazuh-a:attribute\\ntest-wazuh-x:execute\\ntest-wazuh-c:command\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(804);\n    res.body.message.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a6328a5d-8248-4815-b3c5-49e35a7fa639&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;91a0465a-0448-4dab-abbd-e248c36598a1&quot;,&quot;e0a05d05-b4bc-4444-b14b-3792532a3c8e&quot;,&quot;56cf95f1-f7b6-4b30-8f5d-fe2084bda3b3&quot;,&quot;c3add7f4-d498-4e10-8488-f00629c0e568&quot;,&quot;3c482455-9207-48e3-a24f-affa77640807&quot;,&quot;46f2ea34-5f2d-4829-8989-ed96da74c2a0&quot;,&quot;f4c771a1-93f6-4d6a-9b3f-1ee8113054b1&quot;,&quot;ee2a6a52-91fa-4828-beba-4c4d0c52f650&quot;,&quot;9623cf7b-6172-4b97-87cd-ce7f9755823f&quot;,&quot;a7ee0f04-078e-408b-8f4c-0b2721dbb661&quot;,&quot;482ad722-0f91-4852-a03b-46852dbf357f&quot;,&quot;60147005-88b3-4ef5-b45a-fcb4ded4e66d&quot;,&quot;a221b8a1-671c-4e14-add8-e02eea4ba443&quot;,&quot;cf1cdce4-7d8a-4ae8-8638-c41eaefb55aa&quot;,&quot;042d09c8-bf65-46e1-af3f-ebdb530beb82&quot;,&quot;a7051972-a419-41c7-ad56-3723ba35a1ad&quot;,&quot;17a4fb7a-9a17-4a16-9031-78ba34694140&quot;,&quot;59f34f38-8bdf-4a48-85d0-fd7d8ced4db8&quot;,&quot;954f8050-7d3a-43fb-af82-ff80aead7d1c&quot;,&quot;f9f262a7-78f9-430b-b889-192858dec733&quot;,&quot;a6328a5d-8248-4815-b3c5-49e35a7fa639&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4984,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;2bfa7e76-002d-4c91-8fae-810509100f16&quot;,&quot;title&quot;:&quot;GET/cluster/:node_id/files&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request ossec.conf (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request ossec.conf (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:266,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/master/files?path=\&quot; + path_ossec_conf)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.string;\n        res.body.data.should.equal(ossec_conf_content_master)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;aa1099bd-66de-4548-a786-c24d992f0d27&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request ossec.conf (worker)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request ossec.conf (worker)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:281,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/worker-1/files?path=\&quot; + path_ossec_conf)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.string;\n        res.body.data.should.equal(ossec_conf_content_worker)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d13b7f6c-8153-4f12-a5da-63a0fcbb7f3a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request rules (local)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request rules (local)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:266,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/master/files?path=\&quot; + path_rules)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.string;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7c797a75-dde4-47c4-92a8-d1ff4c57b008&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request rules (global)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request rules (global)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/master/files?path=ruleset/rules/0095-sshd_rules.xml\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.string;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9958cb34-d0ae-4d11-aa8b-d4d56cff743e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request decoders (local)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request decoders (local)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/files?path=\&quot; + path_decoders)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e9e976a5-93b7-428c-9aa8-a1419fac6693&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request decoders (global)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request decoders (global)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:281,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/files?path=ruleset/decoders/0025-apache_decoders.xml\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c8660aa7-5054-4533-b3ae-51291aaf0673&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request lists&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request lists&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/files?path=\&quot; + path_lists)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;11f1650a-6626-4ce7-b34d-b33e212c502d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request wrong path 1&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request wrong path 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/files?path=etc/internal_options.conf\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(704);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f3879411-dfb7-4270-b604-bdf80fdde998&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request wrong path 2&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request wrong path 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/files?path=../tmp\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(704);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;73d2a71b-1c6d-42bf-86f2-9cc0d3a21382&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request wrong path 3&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request wrong path 3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/files?path=./framework/wazuh/agent.py\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(704);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d8082af9-076c-40e3-b4b9-1b13de9e6f63&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request unexisting file&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request unexisting file&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/files?path=etc/rules/wrong_file.xml\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1005);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;221f0fb8-961a-4ec2-8f4a-27b851b4d489&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request file from unexisting node&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request file from unexisting node&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/TESTNODE001/files?path=etc/rules/test_rules.xml\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(3022);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5a8dc754-0636-4be9-a81a-be8a65ea62c2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request file with empty path&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request file with empty path&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/files\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(706);\n    res.body.message.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6e4acafe-2068-4c86-97f1-b49f3fa2cbe3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request file with validation parameter (true)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/files Request file with validation parameter (true)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/files?path=\&quot; + path_lists + \&quot;&amp;validation=true\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4f8a6999-c11f-495a-aa5c-972a42dc87a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;aa1099bd-66de-4548-a786-c24d992f0d27&quot;,&quot;d13b7f6c-8153-4f12-a5da-63a0fcbb7f3a&quot;,&quot;7c797a75-dde4-47c4-92a8-d1ff4c57b008&quot;,&quot;9958cb34-d0ae-4d11-aa8b-d4d56cff743e&quot;,&quot;e9e976a5-93b7-428c-9aa8-a1419fac6693&quot;,&quot;c8660aa7-5054-4533-b3ae-51291aaf0673&quot;,&quot;11f1650a-6626-4ce7-b34d-b33e212c502d&quot;,&quot;f3879411-dfb7-4270-b604-bdf80fdde998&quot;,&quot;73d2a71b-1c6d-42bf-86f2-9cc0d3a21382&quot;,&quot;d8082af9-076c-40e3-b4b9-1b13de9e6f63&quot;,&quot;221f0fb8-961a-4ec2-8f4a-27b851b4d489&quot;,&quot;5a8dc754-0636-4be9-a81a-be8a65ea62c2&quot;,&quot;6e4acafe-2068-4c86-97f1-b49f3fa2cbe3&quot;,&quot;4f8a6999-c11f-495a-aa5c-972a42dc87a1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3039,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;132e2f76-eabf-4d24-8898-70f93c41b0d2&quot;,&quot;title&quot;:&quot;GET/cluster/:node_id/configuration/validation (manager and worker OK)&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request validation (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager and worker OK) Request validation (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:754,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/master/configuration/validation\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;status&#x27;]);\n        res.body.data.status.should.equal(&#x27;OK&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e34f586e-82ac-48cc-94b4-c29e19bc10c5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request validation (worker)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager and worker OK) Request validation (worker)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:765,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/worker-1/configuration/validation\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;status&#x27;]);\n        res.body.data.status.should.equal(&#x27;OK&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c09fe45c-eab3-4389-9d1f-1870497ab49e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request validation (all nodes)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager and worker OK) Request validation (all nodes)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:842,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/configuration/validation\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;status&#x27;]);\n        res.body.data.status.should.equal(&#x27;OK&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9f89ef2d-e489-4469-ab4e-12eab31496d1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e34f586e-82ac-48cc-94b4-c29e19bc10c5&quot;,&quot;c09fe45c-eab3-4389-9d1f-1870497ab49e&quot;,&quot;9f89ef2d-e489-4469-ab4e-12eab31496d1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2361,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;2e51a0f4-0248-4e0c-955c-d28f0d55bd78&quot;,&quot;title&quot;:&quot;GET/cluster/:node_id/configuration/validation (manager KO, worker OK)&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager KO, worker OK) \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_ossec_conf + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!--  Wazuh - Manager --&gt;\\n  &lt;ossec_config&gt;\\n    &lt;global&gt;\\n      &lt;jsonout_output&gt;WRONG_VALUE&lt;/jsonout_output&gt;\\n      &lt;alerts_log&gt;yes&lt;/alerts_log&gt;\\n      &lt;logall&gt;no&lt;/logall&gt;\\n      &lt;logall_json&gt;no&lt;/logall_json&gt;\\n      &lt;email_notification&gt;no&lt;/email_notification&gt;\\n      &lt;smtp_server&gt;smtp.example.wazuh.com&lt;/smtp_server&gt;\\n      &lt;email_from&gt;ossecm@example.wazuh.com&lt;/email_from&gt;\\n      &lt;email_to&gt;recipient@example.wazuh.com&lt;/email_to&gt;\\n      &lt;email_maxperhour&gt;12&lt;/email_maxperhour&gt;\\n      &lt;email_log_source&gt;alerts.log&lt;/email_log_source&gt;\\n      &lt;queue_size&gt;131072&lt;/queue_size&gt;\\n    &lt;/global&gt;\\n &lt;cluster&gt;\\n      &lt;name&gt;wazuh&lt;/name&gt;\\n      &lt;node_name&gt;master&lt;/node_name&gt;\\n      &lt;node_type&gt;master&lt;/node_type&gt;\\n      &lt;key&gt;XXXX&lt;/key&gt;\\n      &lt;port&gt;1516&lt;/port&gt;\\n      &lt;bind_addr&gt;192.168.122.111&lt;/bind_addr&gt;\\n      &lt;nodes&gt;\\n        &lt;node&gt;192.168.122.111&lt;/node&gt;\\n      &lt;/nodes&gt;\\n      &lt;hidden&gt;no&lt;/hidden&gt;\\n      &lt;disabled&gt;no&lt;/disabled&gt;\\n    &lt;/cluster&gt;\\n  &lt;/ossec_config&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ff4359fa-bc65-4644-ab8b-306cb6c17fc1&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager KO, worker OK) \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_ossec_conf + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(ossec_conf_content_master)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;09ef356f-1d50-4ce2-b9d9-5e3aa1e89bf3&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request validation (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager KO, worker OK) Request validation (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:273,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/master/configuration/validation\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;status&#x27;, &#x27;details&#x27;]);\n        res.body.data.status.should.equal(&#x27;KO&#x27;);\n        res.body.data.details.should.be.instanceof(Array);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d2030e60-590a-47c9-bffa-81704005245c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request validation (worker)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager KO, worker OK) Request validation (worker)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:764,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/worker-1/configuration/validation\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;status&#x27;]);\n        res.body.data.status.should.equal(&#x27;OK&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8a20d45b-f64b-4c65-8bcd-23aa87361a75&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request validation (all nodes)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager KO, worker OK) Request validation (all nodes)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:796,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/configuration/validation\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;status&#x27;, &#x27;details&#x27;]);\n        res.body.data.status.should.equal(&#x27;KO&#x27;);\n        res.body.data.details.should.be.instanceof(Array);\n\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;67d06736-2426-43c0-8939-5929fdeb4387&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d2030e60-590a-47c9-bffa-81704005245c&quot;,&quot;8a20d45b-f64b-4c65-8bcd-23aa87361a75&quot;,&quot;67d06736-2426-43c0-8939-5929fdeb4387&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1833,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;dfcbf65a-6f19-466a-8ae9-70f8d5a46f5c&quot;,&quot;title&quot;:&quot;GET/cluster/:node_id/configuration/validation (manager OK, worker KO)&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager OK, worker KO) \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:287,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/worker-1/files?path=\&quot; + path_ossec_conf + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!--  Wazuh - Manager --&gt;\\n  &lt;ossec_config&gt;\\n    &lt;global&gt;\\n      &lt;jsonout_output&gt;WRONG_VALUE&lt;/jsonout_output&gt;\\n      &lt;alerts_log&gt;yes&lt;/alerts_log&gt;\\n      &lt;logall&gt;no&lt;/logall&gt;\\n      &lt;logall_json&gt;no&lt;/logall_json&gt;\\n      &lt;email_notification&gt;no&lt;/email_notification&gt;\\n      &lt;smtp_server&gt;smtp.example.wazuh.com&lt;/smtp_server&gt;\\n      &lt;email_from&gt;ossecm@example.wazuh.com&lt;/email_from&gt;\\n      &lt;email_to&gt;recipient@example.wazuh.com&lt;/email_to&gt;\\n      &lt;email_maxperhour&gt;12&lt;/email_maxperhour&gt;\\n      &lt;email_log_source&gt;alerts.log&lt;/email_log_source&gt;\\n      &lt;queue_size&gt;131072&lt;/queue_size&gt;\\n    &lt;/global&gt;\\n  &lt;/ossec_config&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;666c2cc7-a487-4290-8302-90bad674fb04&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager OK, worker KO) \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:305,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/worker-1/files?path=\&quot; + path_ossec_conf + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(ossec_conf_content_worker)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;61a76517-1111-4b11-8e86-cead6f3eea94&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request validation (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager OK, worker KO) Request validation (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:773,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/master/configuration/validation\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;status&#x27;]);\n        res.body.data.status.should.equal(&#x27;OK&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f6205f59-893f-406c-8b32-679a61a50632&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request validation (worker)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager OK, worker KO) Request validation (worker)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/worker-1/configuration/validation\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;status&#x27;, &#x27;details&#x27;]);\n        res.body.data.status.should.equal(&#x27;KO&#x27;);\n        res.body.data.details.should.be.instanceof(Array);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c06e0eda-d075-4bfc-bc9a-aff89f1577b8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request validation (all nodes)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager OK, worker KO) Request validation (all nodes)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:918,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/configuration/validation\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;status&#x27;, &#x27;details&#x27;]);\n        res.body.data.status.should.equal(&#x27;KO&#x27;);\n        res.body.data.details.should.be.instanceof(Array);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a31660cd-c422-42d2-b152-54b4644a23fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f6205f59-893f-406c-8b32-679a61a50632&quot;,&quot;c06e0eda-d075-4bfc-bc9a-aff89f1577b8&quot;,&quot;a31660cd-c422-42d2-b152-54b4644a23fa&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1969,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;5520f557-9650-445a-92f8-b2718fa2580b&quot;,&quot;title&quot;:&quot;GET/cluster/:node_id/configuration/validation (manager and worker KO)&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager and worker KO) \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_ossec_conf + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!--  Wazuh - Manager --&gt;\\n  &lt;ossec_config&gt;\\n    &lt;global&gt;\\n      &lt;jsonout_output&gt;WRONG_VALUE&lt;/jsonout_output&gt;\\n      &lt;alerts_log&gt;yes&lt;/alerts_log&gt;\\n      &lt;logall&gt;no&lt;/logall&gt;\\n      &lt;logall_json&gt;no&lt;/logall_json&gt;\\n      &lt;email_notification&gt;no&lt;/email_notification&gt;\\n      &lt;smtp_server&gt;smtp.example.wazuh.com&lt;/smtp_server&gt;\\n      &lt;email_from&gt;ossecm@example.wazuh.com&lt;/email_from&gt;\\n      &lt;email_to&gt;recipient@example.wazuh.com&lt;/email_to&gt;\\n      &lt;email_maxperhour&gt;12&lt;/email_maxperhour&gt;\\n      &lt;email_log_source&gt;alerts.log&lt;/email_log_source&gt;\\n      &lt;queue_size&gt;131072&lt;/queue_size&gt;\\n    &lt;/global&gt;\\n &lt;cluster&gt;\\n      &lt;name&gt;wazuh&lt;/name&gt;\\n      &lt;node_name&gt;master&lt;/node_name&gt;\\n      &lt;node_type&gt;master&lt;/node_type&gt;\\n      &lt;key&gt;XXXXX&lt;/key&gt;\\n      &lt;port&gt;1516&lt;/port&gt;\\n      &lt;bind_addr&gt;192.168.122.111&lt;/bind_addr&gt;\\n      &lt;nodes&gt;\\n        &lt;node&gt;192.168.122.111&lt;/node&gt;\\n      &lt;/nodes&gt;\\n      &lt;hidden&gt;no&lt;/hidden&gt;\\n      &lt;disabled&gt;no&lt;/disabled&gt;\\n    &lt;/cluster&gt;\\n  &lt;/ossec_config&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;41538f3a-35c6-48bb-ba13-1d7c6d3591c7&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager and worker KO) \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:293,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/worker-1/files?path=\&quot; + path_ossec_conf + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(\&quot;&lt;!--  Wazuh - Manager --&gt;\\n  &lt;ossec_config&gt;\\n    &lt;global&gt;\\n      &lt;jsonout_output&gt;WRONG_VALUE&lt;/jsonout_output&gt;\\n      &lt;alerts_log&gt;yes&lt;/alerts_log&gt;\\n      &lt;logall&gt;no&lt;/logall&gt;\\n      &lt;logall_json&gt;no&lt;/logall_json&gt;\\n      &lt;email_notification&gt;no&lt;/email_notification&gt;\\n      &lt;smtp_server&gt;smtp.example.wazuh.com&lt;/smtp_server&gt;\\n      &lt;email_from&gt;ossecm@example.wazuh.com&lt;/email_from&gt;\\n      &lt;email_to&gt;recipient@example.wazuh.com&lt;/email_to&gt;\\n      &lt;email_maxperhour&gt;12&lt;/email_maxperhour&gt;\\n      &lt;email_log_source&gt;alerts.log&lt;/email_log_source&gt;\\n      &lt;queue_size&gt;131072&lt;/queue_size&gt;\\n    &lt;/global&gt;\\n  &lt;/ossec_config&gt;\\n\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6565bc47-c19d-45ff-9a82-a553f093c2e4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager and worker KO) \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:318,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/master/files?path=\&quot; + path_ossec_conf + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(ossec_conf_content_master)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e8e90760-9354-4dc2-af18-a7b8b69f891f&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager and worker KO) \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:310,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/cluster/worker-1/files?path=\&quot; + path_ossec_conf + \&quot;&amp;overwrite=true\&quot;)\n.set(\&quot;Content-Type\&quot;, \&quot;application/xml\&quot;)\n.send(ossec_conf_content_worker)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err, res) {\n    if (err) throw err;\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n  });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8af1b857-bc98-4824-8aa0-b584a94ca5b0&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request validation (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager and worker KO) Request validation (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/worker-1/configuration/validation\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;status&#x27;, &#x27;details&#x27;]);\n        res.body.data.status.should.equal(&#x27;KO&#x27;);\n        res.body.data.details.should.be.instanceof(Array);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;797ea1c2-89fb-4ca2-80b5-2de1f9cd768d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request validation (worker)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager and worker KO) Request validation (worker)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:281,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/worker-1/configuration/validation\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;status&#x27;, &#x27;details&#x27;]);\n        res.body.data.status.should.equal(&#x27;KO&#x27;);\n        res.body.data.details.should.be.instanceof(Array);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8d294b85-ae03-4b93-9ebb-7afc9a3842b6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request validation (all nodes)&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/:node_id/configuration/validation (manager and worker KO) Request validation (all nodes)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:301,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/cluster/configuration/validation\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;status&#x27;, &#x27;details&#x27;]);\n        res.body.data.status.should.equal(&#x27;KO&#x27;);\n        res.body.data.details.should.be.instanceof(Array);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f78c94e4-9c10-4fa2-8ae3-3d5bfa80789f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;797ea1c2-89fb-4ca2-80b5-2de1f9cd768d&quot;,&quot;8d294b85-ae03-4b93-9ebb-7afc9a3842b6&quot;,&quot;f78c94e4-9c10-4fa2-8ae3-3d5bfa80789f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:862,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;0a9c2dea-2cbf-4a0e-aa06-a4cdddae8b75&quot;,&quot;title&quot;:&quot;DELETE/cluster/:node_id/files&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Delete rules (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster DELETE/cluster/:node_id/files Delete rules (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/cluster/master/files?path=\&quot; + path_rules)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0f06c6d4-a31e-4a8f-a36c-5e964f927a73&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Delete decoders (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster DELETE/cluster/:node_id/files Delete decoders (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/cluster/master/files?path=\&quot; + path_decoders)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d5f63942-f0be-4fb4-b0b9-4198abb05d55&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Delete CDB list (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster DELETE/cluster/:node_id/files Delete CDB list (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/cluster/master/files?path=\&quot; + path_lists)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;38a94627-af1e-4ca8-995c-c1f971c62870&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Delete file with empty path&quot;,&quot;fullTitle&quot;:&quot;Cluster DELETE/cluster/:node_id/files Delete file with empty path&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/cluster/master/files\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(706);\n    res.body.message.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;27a5297c-21f2-4403-9bbf-726e6962fe5f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0f06c6d4-a31e-4a8f-a36c-5e964f927a73&quot;,&quot;d5f63942-f0be-4fb4-b0b9-4198abb05d55&quot;,&quot;38a94627-af1e-4ca8-995c-c1f971c62870&quot;,&quot;27a5297c-21f2-4403-9bbf-726e6962fe5f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:907,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;c85608bd-64aa-41c7-ab06-1270e38d74d1&quot;,&quot;title&quot;:&quot;GET/cluster/master/config/:component/:configuration&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request-Agentless-Agentless&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Agentless-Agentless&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/agentless/agentless\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;agentless&#x27;); // returns an array\n    res.body.data.agentless[0].should.have.properties([&#x27;state&#x27;, &#x27;host&#x27;,\n    &#x27;frequency&#x27;, &#x27;arguments&#x27;, &#x27;type&#x27;, &#x27;port&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;79718b93-f351-47fb-8ce3-220e1c3884d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Analysis-Global&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Analysis-Global&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/worker-1/config/analysis/global\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;global&#x27;]);\n    res.body.data.global.should.have.properties([&#x27;email_notification&#x27;, &#x27;max_output_size&#x27;,\n    &#x27;alerts_log&#x27;, &#x27;zeromq_output&#x27;, &#x27;host_information&#x27;, &#x27;jsonout_output&#x27;, &#x27;rotate_interval&#x27;,\n    &#x27;rootkit_detection&#x27;, &#x27;integrity_checking&#x27;, &#x27;memory_size&#x27;, &#x27;logall&#x27;, &#x27;prelude_output&#x27;,\n    &#x27;stats&#x27;, &#x27;white_list&#x27;, &#x27;logall_json&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9d409920-8ea8-4417-b339-38ea6c8cc6ad&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Analysis-Active-response&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Analysis-Active-response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/analysis/active_response\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    // res.body.data.should.have.properties([&#x27;active_response&#x27;]); // empty list\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e52d7200-8edb-48f3-9ea2-9c2af063da01&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Analysis-Alerts&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Analysis-Alerts&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:288,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/worker-1/config/analysis/alerts\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;alerts&#x27;]);\n    res.body.data.alerts.should.have.properties([&#x27;email_alert_level&#x27;, &#x27;log_alert_level&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3d3edf8c-f4cf-4f59-96a1-14f00108fa7f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Analysis-Command&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Analysis-Command&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:293,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/analysis/command\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;command&#x27;);\n    res.body.data.command[0].should.have.properties([&#x27;executable&#x27;, &#x27;timeout_allowed&#x27;,\n    &#x27;name&#x27;, &#x27;expect&#x27;]);\n    res.body.data.command[1].should.have.properties([&#x27;executable&#x27;, &#x27;timeout_allowed&#x27;,\n    &#x27;name&#x27;]);\n    res.body.data.command[2].should.have.properties([&#x27;executable&#x27;, &#x27;timeout_allowed&#x27;,\n    &#x27;name&#x27;, &#x27;expect&#x27;]);\n    res.body.data.command[3].should.have.properties([&#x27;executable&#x27;, &#x27;timeout_allowed&#x27;,\n    &#x27;name&#x27;, &#x27;expect&#x27;]);\n    res.body.data.command[4].should.have.properties([&#x27;executable&#x27;, &#x27;timeout_allowed&#x27;,\n    &#x27;name&#x27;, &#x27;expect&#x27;]);\n    res.body.data.command[5].should.have.properties([&#x27;executable&#x27;, &#x27;timeout_allowed&#x27;,\n    &#x27;name&#x27;, &#x27;expect&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8f56b258-aac7-4e39-9a75-1baa4cb8a805&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Analysis-Internal&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Analysis-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:353,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/worker-1/config/analysis/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;internal&#x27;);\n    res.body.data.internal.should.have.properties([&#x27;analysisd&#x27;]);\n    res.body.data.internal.analysisd.should.have.properties([&#x27;label_cache_maxage&#x27;,\n    &#x27;stats_percent_diff&#x27;, &#x27;show_hidden_labels&#x27;, &#x27;decoder_order_size&#x27;,\n    &#x27;min_rotate_interval&#x27;, &#x27;stats_mindiff&#x27;, &#x27;log_fw&#x27;, &#x27;rlimit_nofile&#x27;, &#x27;fts_list_size&#x27;,\n    &#x27;debug&#x27;, &#x27;fts_min_size_for_str&#x27;, &#x27;default_timeframe&#x27;, &#x27;stats_maxdiff&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;efb6ce4c-7788-4af7-a04c-d7af19968508&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Auth-Auth&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Auth-Auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:308,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/auth/auth\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;auth&#x27;);\n    res.body.data.auth.should.have.properties([&#x27;purge&#x27;, &#x27;ssl_auto_negotiate&#x27;, &#x27;ciphers&#x27;,\n    &#x27;force_insert&#x27;, &#x27;ssl_verify_host&#x27;, &#x27;limit_maxagents&#x27;, &#x27;force_time&#x27;,\n    &#x27;ssl_manager_key&#x27;, &#x27;disabled&#x27;, &#x27;ssl_manager_cert&#x27;, &#x27;use_source_ip&#x27;,\n    &#x27;use_password&#x27;, &#x27;port&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f0dbe9dd-1c89-4e35-8eb2-99dbe0af6086&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Com-Active-response&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Com-Active-response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:289,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/worker-1/config/com/active-response\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;active-response&#x27;]);\n    res.body.data[&#x27;active-response&#x27;].should.have.properties([&#x27;disabled&#x27;, &#x27;ca_verification&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;67e30097-472b-4a26-8b8f-12c46e768cfb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Com-Internal&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Com-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:284,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/com/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;internal&#x27;]);\n    res.body.data.internal.should.have.properties([&#x27;execd&#x27;]);\n    res.body.data.internal.execd.should.have.properties([&#x27;request_timeout&#x27;, &#x27;max_restart_lock&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fe5c23c5-1767-4a82-9479-5928bd4e4908&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Csyslog-Csyslog&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Csyslog-Csyslog&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/csyslog/csyslog\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;syslog_output&#x27;]);\n    res.body.data[&#x27;syslog_output&#x27;][0].should.have.properties([&#x27;format&#x27;,\n    &#x27;level&#x27;, &#x27;use_fqdn&#x27;, &#x27;port&#x27;, &#x27;server&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;27e91057-a390-41c3-b87a-22bc0fe88b66&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Integrator-Integration&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Integrator-Integration&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:268,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/integrator/integration\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;integration&#x27;);\n    res.body.data.integration[0].should.have.properties([&#x27;alert_format&#x27;, &#x27;hook_url&#x27;,\n    &#x27;group&#x27;, &#x27;name&#x27;, &#x27;level&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;45745be6-333e-4ec8-a71c-9dffc1544e31&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Logcollector-Localfile&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Logcollector-Localfile&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:288,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/worker-1/config/logcollector/localfile\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;localfile&#x27;);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4678857e-0572-4d7a-9c08-138c607404fc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Logcollector-Socket&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Logcollector-Socket&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/logcollector/socket\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    // res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]); // data property is empty\n    // res.body.data.should.have.properties([&#x27;socket&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;03f335d7-fe4f-45ea-a67e-cd9667f43415&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Logcollector-Internal&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Logcollector-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/worker-1/config/logcollector/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;internal&#x27;);\n    res.body.data.internal.should.have.properties(&#x27;logcollector&#x27;);\n\t\t\t\tres.body.data.internal.logcollector.should.have.properties([&#x27;open_attempts&#x27;, &#x27;input_threads&#x27;,\n    &#x27;vcheck_files&#x27;, &#x27;max_files&#x27;, &#x27;sock_fail_time&#x27;, &#x27;queue_size&#x27;, &#x27;max_lines&#x27;, &#x27;remote_commands&#x27;,\n    &#x27;loop_timeout&#x27;, &#x27;debug&#x27;, &#x27;open_attempts&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;39b4feeb-35f6-4b43-a174-b4a9f7b75a60&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Mail-Global&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Mail-Global&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:308,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/mail/global\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;global&#x27;);\n    res.body.data.global.should.have.properties([&#x27;email_maxperhour&#x27;, &#x27;email_to&#x27;,\n    &#x27;email_from&#x27;, &#x27;smtp_server&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a8a85bd1-59dc-43db-a1a9-6b146f24798a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Mail-Alerts&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Mail-Alerts&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:284,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/mail/alerts\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    // res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]); // data property is empty\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c1a53a0e-f50e-4f47-b009-a4fef677014c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Mail-Internal&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Mail-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/mail/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;internal&#x27;);\n    res.body.data.internal.should.have.properties(&#x27;mail&#x27;);\n    res.body.data.internal.mail.should.have.properties([&#x27;strict_checking&#x27;,\n    &#x27;grouping&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;409ce179-eb0e-4704-a19e-baea2d7d355c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Monitor-Internal&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Monitor-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/worker-1/config/monitor/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;monitord&#x27;);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f5ee33f7-a54f-4b13-8223-360abf4a0549&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Request-Remote&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Request-Remote&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:284,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/request/remote\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;remote&#x27;);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fe373394-b737-4702-8ee1-52e0f3c3c36a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Request-Internal&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Request-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:302,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/worker-1/config/request/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;internal&#x27;);\n    res.body.data.internal.should.have.properties(&#x27;remoted&#x27;);\n    res.body.data.internal.remoted.should.have.properties([&#x27;request_timeout&#x27;, &#x27;pass_empty_keyfile&#x27;,\n    &#x27;recv_timeout&#x27;, &#x27;request_rto_sec&#x27;, &#x27;request_rto_msec&#x27;, &#x27;response_timeout&#x27;, &#x27;sender_pool&#x27;, &#x27;recv_counter_flush&#x27;,\n    &#x27;request_pool&#x27;, &#x27;comp_average_printout&#x27;, &#x27;shared_reload&#x27;, &#x27;merge_shared&#x27;, &#x27;rlimit_nofile&#x27;,\n    &#x27;verify_msg_id&#x27;, &#x27;max_attempts&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;cac6605a-fe85-47c7-875c-fa6d0aa2f980&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Syscheck-Syscheck&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Syscheck-Syscheck&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:301,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/syscheck/syscheck\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;syscheck&#x27;]);\n    res.body.data.syscheck.should.have.properties([&#x27;ignore&#x27;, &#x27;skip_nfs&#x27;, &#x27;directories&#x27;,\n    &#x27;scan_on_start&#x27;, &#x27;disabled&#x27;, &#x27;frequency&#x27;, &#x27;whodata&#x27;, &#x27;nodiff&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e154c01a-6b06-4479-90f0-deba96eb4828&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Syscheck-Rootcheck&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Syscheck-Rootcheck&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/syscheck/rootcheck\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;rootcheck&#x27;]);\n    res.body.data.rootcheck.should.have.properties([&#x27;check_unixaudit&#x27;, &#x27;check_sys&#x27;, &#x27;rootkit_trojans&#x27;,\n    &#x27;skip_nfs&#x27;, &#x27;check_if&#x27;, &#x27;check_pids&#x27;, &#x27;check_dev&#x27;, &#x27;check_ports&#x27;, &#x27;disabled&#x27;, &#x27;rootkit_files&#x27;,\n    // &#x27;frequency&#x27;, &#x27;scanall&#x27;, &#x27;check_trojans&#x27;, &#x27;base_directory&#x27;, &#x27;check_files&#x27;, &#x27;system_audit&#x27;]); // base directory value is empty, this cause an error, system_audit is optional\n    &#x27;frequency&#x27;, &#x27;scanall&#x27;, &#x27;check_trojans&#x27;, &#x27;check_files&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f275d6ee-a0ef-43a1-8488-8e37469ea47a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Syscheck-Internal&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Syscheck-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/syscheck/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;internal&#x27;]);\n    res.body.data.internal.should.have.properties([&#x27;syscheck&#x27;, &#x27;rootcheck&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;15520676-4b74-4204-b1c1-b1f6ddab7f94&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Wmodules-Wmodules&quot;,&quot;fullTitle&quot;:&quot;Cluster GET/cluster/master/config/:component/:configuration Request-Wmodules-Wmodules&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/cluster/master/config/wmodules/wmodules\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;wmodules&#x27;]);\n    res.body.error.should.equal(0);\n    // get the name of the modules\n    var modules = []\n    for (i in res.body.data.wmodules) {\n        modules.push(Object.keys(res.body.data.wmodules[i])[0])\n    }\n    // list of modules which should be present in the request\n    module_list = [&#x27;cis-cat&#x27;, &#x27;database&#x27;, &#x27;open-scap&#x27;, &#x27;osquery&#x27;, &#x27;sca&#x27;, &#x27;syscollector&#x27;, &#x27;vulnerability-detector&#x27;, &#x27;wazuh_control&#x27;, &#x27;wazuh_download&#x27;]\n    // check modules\n    should((JSON.stringify(module_list.sort()))).be.eql(JSON.stringify(modules.sort()))\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;97d869f5-c149-4203-b3d6-8fead91c144e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;79718b93-f351-47fb-8ce3-220e1c3884d6&quot;,&quot;9d409920-8ea8-4417-b339-38ea6c8cc6ad&quot;,&quot;e52d7200-8edb-48f3-9ea2-9c2af063da01&quot;,&quot;3d3edf8c-f4cf-4f59-96a1-14f00108fa7f&quot;,&quot;8f56b258-aac7-4e39-9a75-1baa4cb8a805&quot;,&quot;efb6ce4c-7788-4af7-a04c-d7af19968508&quot;,&quot;f0dbe9dd-1c89-4e35-8eb2-99dbe0af6086&quot;,&quot;67e30097-472b-4a26-8b8f-12c46e768cfb&quot;,&quot;fe5c23c5-1767-4a82-9479-5928bd4e4908&quot;,&quot;27e91057-a390-41c3-b87a-22bc0fe88b66&quot;,&quot;45745be6-333e-4ec8-a71c-9dffc1544e31&quot;,&quot;4678857e-0572-4d7a-9c08-138c607404fc&quot;,&quot;03f335d7-fe4f-45ea-a67e-cd9667f43415&quot;,&quot;39b4feeb-35f6-4b43-a174-b4a9f7b75a60&quot;,&quot;a8a85bd1-59dc-43db-a1a9-6b146f24798a&quot;,&quot;c1a53a0e-f50e-4f47-b009-a4fef677014c&quot;,&quot;409ce179-eb0e-4704-a19e-baea2d7d355c&quot;,&quot;f5ee33f7-a54f-4b13-8223-360abf4a0549&quot;,&quot;fe373394-b737-4702-8ee1-52e0f3c3c36a&quot;,&quot;cac6605a-fe85-47c7-875c-fa6d0aa2f980&quot;,&quot;e154c01a-6b06-4479-90f0-deba96eb4828&quot;,&quot;f275d6ee-a0ef-43a1-8488-8e37469ea47a&quot;,&quot;15520676-4b74-4204-b1c1-b1f6ddab7f94&quot;,&quot;97d869f5-c149-4203-b3d6-8fead91c144e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6905,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;99249989-487c-42be-bacf-44d82bad6299&quot;,&quot;title&quot;:&quot;PUT/cluster/:node_id/restart&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_cluster.js&quot;,&quot;file&quot;:&quot;/test/test_cluster.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request (worker)&quot;,&quot;fullTitle&quot;:&quot;Cluster PUT/cluster/:node_id/restart Request (worker)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.put(\&quot;/cluster/worker-1/restart\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;636cdc6a-49a1-4ba1-bb40-3bfd87c4584c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request (master)&quot;,&quot;fullTitle&quot;:&quot;Cluster PUT/cluster/:node_id/restart Request (master)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.put(\&quot;/cluster/master/restart\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9e66d4ea-fdd0-448f-9e54-8a7f724c2c1b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;636cdc6a-49a1-4ba1-bb40-3bfd87c4584c&quot;,&quot;9e66d4ea-fdd0-448f-9e54-8a7f724c2c1b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:544,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:10000},&quot;copyrightYear&quot;:2020}" data-config="{&quot;reportFilename&quot;:&quot;cluster&quot;,&quot;reportDir&quot;:&quot;/share&quot;,&quot;reportTitle&quot;:&quot;wazuh-api&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:true,&quot;enableCharts&quot;:true,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;/share/assets&quot;,&quot;jsonFile&quot;:&quot;/share/cluster.json&quot;,&quot;htmlFile&quot;:&quot;/share/cluster.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>