<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:28,&quot;tests&quot;:155,&quot;passes&quot;:152,&quot;pending&quot;:0,&quot;failures&quot;:3,&quot;start&quot;:&quot;2020-06-08T12:16:13.175Z&quot;,&quot;end&quot;:&quot;2020-06-08T12:17:12.452Z&quot;,&quot;duration&quot;:59277,&quot;testsRegistered&quot;:155,&quot;passPercent&quot;:98.1,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false,&quot;passPercentClass&quot;:&quot;success&quot;,&quot;pendingPercentClass&quot;:&quot;danger&quot;},&quot;suites&quot;:{&quot;uuid&quot;:&quot;11998f6d-49c4-485e-ad71-3d1bd05f4731&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;3723cbd4-8864-45b9-83a9-d30979dd333f&quot;,&quot;title&quot;:&quot;Agents&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;3e5ec7f7-ee0d-464c-b645-4343b8ff836a&quot;,&quot;title&quot;:&quot;GET/agents&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:97,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/version\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n  expected_version=\&quot;Wazuh \&quot;+String(res.body.data);\n  done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;cf7f0b6c-3e44-48db-b015-9fcc612fdb9d&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array);\n    expected_os_platform = res.body.data.items[0].os.platform;\n    expected_os_version = res.body.data.items[0].os.version;\n    expected_manager_host = res.body.data.items[0].manager;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e261e296-410b-40f4-9572-07f76e1449eb&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:273,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].should.have.properties(manager_properties);\n    res.body.data.items[1].should.have.properties(agent_properties);\n    res.body.data.items[0].os.should.have.properties(agent_os_properties);\n    res.body.data.items[1].os.should.have.properties(agent_os_properties);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;bc72d247-4194-4186-a49e-b9e99ca54613&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?offset=0&amp;limit=1\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n    res.body.data.items[0].should.have.properties(manager_properties);\n    res.body.data.items[0].id.should.have.equal(&#x27;000&#x27;);\n    res.body.data.items[0].status.should.have.equal(&#x27;Active&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ba51db33-0345-4dc9-b695-4a86d5f538d3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Retrieve all elements with limit=0&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Retrieve all elements with limit=0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?limit=0\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1406);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;473ed57e-fabc-4a1e-8a5d-e9645da8597f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Sort&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:273,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?sort=-id\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array);\n    res.body.data.items[0].id.should.equal(&#x27;003&#x27;);\n    res.body.data.items[0].should.have.properties(agent_properties);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5ff20373-8cb3-4378-8315-ca6dd5f1f44c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Sort&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Wrong Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?sort=-wrongParameter\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1403);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;eeac6c26-55e1-4cc6-aa32-bd62aba91b01&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?search=001\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array);\n    res.body.data.items[0].id.should.be.equal(\&quot;001\&quot;);\n    res.body.data.items[0].should.have.properties(agent_properties);\n    res.body.data.items[0].os.should.have.properties(agent_os_properties);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;98f915c1-db39-4ca6-b8d1-07009cdb4463&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?select=dateAdd,mergedSum\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].should.have.properties([&#x27;dateAdd&#x27;, &#x27;id&#x27;]);\n    res.body.data.items[1].should.have.properties([&#x27;dateAdd&#x27;, &#x27;mergedSum&#x27;, &#x27;id&#x27;]);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e84d8988-eaa6-4874-aac1-d78b1c8c4b79&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:273,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?select=wrongParam\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1724);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e1ea9eb0-bfec-453e-a343-de6e0ab329e1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Version&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Version&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?version=\&quot;+expected_version.replace(/\\s/g, &#x27;&#x27;))\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].should.have.properties([&#x27;version&#x27;]);\n    res.body.data.items[0].version.should.be.equal(expected_version);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ea747b2c-eed8-48cc-aebb-5956e12a0996&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Os.platform&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Os.platform&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?os.platform=\&quot; + expected_os_platform)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].os.should.have.properties([&#x27;platform&#x27;]);\n    res.body.data.items[0].os.platform.should.be.equal(expected_os_platform);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;54878931-8178-4bff-97a7-43593df0fca3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Os.version&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Os.version&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?os.version=\&quot; + expected_os_version)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].os.should.have.properties([&#x27;version&#x27;]);\n    res.body.data.items[0].os.version.should.be.equal(expected_os_version);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;844b575f-c1c8-4c1d-b172-15ca826fbfb2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ManagerHost&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents ManagerHost&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?manager=\&quot; + expected_manager_host)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].os.should.have.properties([&#x27;version&#x27;]);\n    res.body.data.items[0].manager.should.be.equal(expected_manager_host);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7f41870b-768f-4c4c-a3e0-0c4a75f45209&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: status&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Filters: status&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?status=aCtIvE\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.totalItems.should.be.above(0);\n    res.body.data.items.should.be.instanceof(Array)\n    res.body.data.items[0].should.have.properties([&#x27;status&#x27;, &#x27;ip&#x27;, &#x27;id&#x27;, &#x27;name&#x27;]);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4cddff45-0d62-4c0a-ab23-6be80bc1044a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: status 2&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Filters: status 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents?status=aCtIvE,neverconnected\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;status&#x27;, &#x27;ip&#x27;, &#x27;id&#x27;, &#x27;name&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;72e37d69-3cac-4c4a-a69a-d492d1372117&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: Invalid filter&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Filters: Invalid filter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?random\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(604);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;09fd0ad7-d8da-47a6-8d81-c6f3acdfc2ec&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: Invalid filter - Extra field&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Filters: Invalid filter - Extra field&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:80,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents?status=aCtIvE&amp;random\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(604);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;16e25d7c-6f75-41c3-b9a0-efe250bf79fe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: older_than&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Filters: older_than&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:281,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents?older_than=1s\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;status&#x27;, &#x27;ip&#x27;, &#x27;id&#x27;, &#x27;name&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;813850f5-9fa3-45a9-9fa3-ef40bacb8873&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: group&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Filters: group&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents?group=default\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;,&#x27;totalItems&#x27;]);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.items[0].group.should.be.instanceof(Array);\n        res.body.data.items[0].group[0].should.be.equal(&#x27;default&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6f73750d-2e92-4114-a138-f4f53fea953d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Select: single field&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Select: single field&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:288,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents?select=lastKeepAlive\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;id&#x27;, &#x27;lastKeepAlive&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c39af7af-5b84-48be-9207-5345a28e48c8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Select: multiple fields&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Select: multiple fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents?select=status,os.platform,os.version\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;id&#x27;, &#x27;status&#x27;, &#x27;os&#x27;]);\n        res.body.data.items[0].os.should.have.properties([&#x27;version&#x27;,&#x27;platform&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c2dd60e4-4e40-4d8a-bce5-8bd883a02163&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Select: wrong field&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Select: wrong field&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents?select=wrong_field\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;814136d6-c447-4916-a893-8e121d5984ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Select: invalid character&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Select: invalid character&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:79,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents?select=invalidñcharacter\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(619);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d2c6a10c-569e-4659-bfcb-fbc5abb9fde7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: query&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents Filters: query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents?q=group=default;lastKeepAlive&lt;1d\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;,&#x27;totalItems&#x27;]);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.items[0].group[0].should.be.equal(&#x27;default&#x27;);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7c45bdf2-2f18-4a32-9660-ad23f45ebdb2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;bc72d247-4194-4186-a49e-b9e99ca54613&quot;,&quot;ba51db33-0345-4dc9-b695-4a86d5f538d3&quot;,&quot;473ed57e-fabc-4a1e-8a5d-e9645da8597f&quot;,&quot;5ff20373-8cb3-4378-8315-ca6dd5f1f44c&quot;,&quot;eeac6c26-55e1-4cc6-aa32-bd62aba91b01&quot;,&quot;98f915c1-db39-4ca6-b8d1-07009cdb4463&quot;,&quot;e84d8988-eaa6-4874-aac1-d78b1c8c4b79&quot;,&quot;e1ea9eb0-bfec-453e-a343-de6e0ab329e1&quot;,&quot;ea747b2c-eed8-48cc-aebb-5956e12a0996&quot;,&quot;54878931-8178-4bff-97a7-43593df0fca3&quot;,&quot;844b575f-c1c8-4c1d-b172-15ca826fbfb2&quot;,&quot;7f41870b-768f-4c4c-a3e0-0c4a75f45209&quot;,&quot;4cddff45-0d62-4c0a-ab23-6be80bc1044a&quot;,&quot;72e37d69-3cac-4c4a-a69a-d492d1372117&quot;,&quot;09fd0ad7-d8da-47a6-8d81-c6f3acdfc2ec&quot;,&quot;16e25d7c-6f75-41c3-b9a0-efe250bf79fe&quot;,&quot;813850f5-9fa3-45a9-9fa3-ef40bacb8873&quot;,&quot;6f73750d-2e92-4114-a138-f4f53fea953d&quot;,&quot;c39af7af-5b84-48be-9207-5345a28e48c8&quot;,&quot;c2dd60e4-4e40-4d8a-bce5-8bd883a02163&quot;,&quot;814136d6-c447-4916-a893-8e121d5984ab&quot;,&quot;d2c6a10c-569e-4659-bfcb-fbc5abb9fde7&quot;,&quot;7c45bdf2-2f18-4a32-9660-ad23f45ebdb2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5749,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;614b1a58-d0f3-4a52-a577-ffde0b704af2&quot;,&quot;title&quot;:&quot;GET/agents/summary&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/summary Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/summary\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.have.properties([&#x27;Active&#x27;, &#x27;Total&#x27;, &#x27;Disconnected&#x27;, &#x27;Never connected&#x27;]);\n    res.body.data[&#x27;Active&#x27;].should.be.above(0);\n    res.body.data[&#x27;Total&#x27;].should.be.an.integer;\n    res.body.data[&#x27;Disconnected&#x27;].should.be.an.integer;\n    res.body.data[&#x27;Never connected&#x27;].should.be.an.integer;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;098fe2e8-5d30-4cf1-a38e-31ac02c2ce09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;098fe2e8-5d30-4cf1-a38e-31ac02c2ce09&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:279,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;1da1cf3a-2232-4eb4-9288-134f0fc66c94&quot;,&quot;title&quot;:&quot;GET/agents/summary/os&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/summary/os Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(&#x27;/agents/summary/os&#x27;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function(err, res) {\n        if (err) return done(err);\n        res.body.error.should.equal(0);\n        res.body.should.have.properties([&#x27;error&#x27;,&#x27;data&#x27;]);\n        res.body.data.should.have.properties([&#x27;totalItems&#x27;,&#x27;items&#x27;]);\n        res.body.data.items.should.be.instanceof(Array);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;98008438-80c0-4d43-b16c-5a60d0d1590d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;98008438-80c0-4d43-b16c-5a60d0d1590d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:283,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;6e27e5b3-def8-421b-9c8a-c49e94156cda&quot;,&quot;title&quot;:&quot;GET/agents/outdated&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/outdated \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:319,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/manager/info\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        manager_version = res.body.data.version;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ffa1fe14-4971-4a5d-bd9f-b859be1c4c2a&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/outdated Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:677,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/outdated\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.have.properties([&#x27;items&#x27;,&#x27;totalItems&#x27;]);\n    res.body.data.items.should.be.instanceOf(Array);\n    res.body.data.items[0].should.have.properties([&#x27;version&#x27;,&#x27;id&#x27;,&#x27;name&#x27;]);\n    res.body.data.items[0].should.not.be.eql(manager_version);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;328a2f22-01a8-43f7-9baf-d52af6441272&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;328a2f22-01a8-43f7-9baf-d52af6441272&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:677,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;5f99156b-6258-4db1-96b3-73f3b94b3436&quot;,&quot;title&quot;:&quot;GET/agents/:agent_id&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request (manager)&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent_id Request (manager)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:673,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.Object;\n    res.body.data.id.should.equal(\&quot;000\&quot;);\n    res.body.data.should.have.properties(manager_properties);\n    res.body.data.os.should.have.properties(agent_os_properties);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0a817e13-59e2-445c-a6dd-5c76ed32c1f5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request (agent)&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent_id Request (agent)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:493,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/001\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.Object;\n    res.body.data.id.should.equal(\&quot;001\&quot;);\n    res.body.data.should.have.properties(agent_properties);\n    res.body.data.os.should.have.properties(agent_os_properties);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;56d201d3-14f1-4221-bd67-15e93ce49f68&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent_id Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:361,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/001?select=dateAdd,mergedSum\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.have.properties([&#x27;dateAdd&#x27;, &#x27;mergedSum&#x27;]);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a30ae015-44bb-4250-8b59-77ad3bfe4748&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent_id Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/001?select=wrongParam\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1724);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b6bd9a6c-eaae-4741-a574-d21be01c6bc3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad agent id&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent_id Params: Bad agent id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:90,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/abc\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(600);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;149e1927-b80c-40a3-9a1f-c0e714105aa4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: No agent&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent_id Errors: No agent&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:331,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/9999999\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1701);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d089c9fd-0aa1-4c1f-9f8a-44d96faf14b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Select&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent_id Select&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000?select=lastKeepAlive,id,ip,status\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.have.properties([&#x27;lastKeepAlive&#x27;,&#x27;id&#x27;,&#x27;ip&#x27;,&#x27;status&#x27;]);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8891f769-19d9-4d78-9a72-062d9458eaaf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Select: wrong field&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent_id Select: wrong field&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:285,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000?select=wrong_field\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1724);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fceaa247-c424-49f3-833f-fec0371666cd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0a817e13-59e2-445c-a6dd-5c76ed32c1f5&quot;,&quot;56d201d3-14f1-4221-bd67-15e93ce49f68&quot;,&quot;a30ae015-44bb-4250-8b59-77ad3bfe4748&quot;,&quot;b6bd9a6c-eaae-4741-a574-d21be01c6bc3&quot;,&quot;149e1927-b80c-40a3-9a1f-c0e714105aa4&quot;,&quot;d089c9fd-0aa1-4c1f-9f8a-44d96faf14b5&quot;,&quot;8891f769-19d9-4d78-9a72-062d9458eaaf&quot;,&quot;fceaa247-c424-49f3-833f-fec0371666cd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2786,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;0c3ff076-a3f2-4808-ad59-5f04475fd829&quot;,&quot;title&quot;:&quot;GET/agents/name/:agent_name&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/name/:agent_name \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/001\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.data.should.have.properties(agent_properties);\n    res.body.error.should.equal(0);\n    expected_name = res.body.data.name;\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0384fb83-0f7a-443a-bb86-8dbb630f4c56&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/name/:agent_name Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/name/\&quot;+expected_name)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.Object;\n    res.body.data.should.have.properties(agent_properties);\n    res.body.data.os.should.have.properties(agent_os_properties);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;33b39826-ee3b-448a-9ac4-36199064a6bb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong name&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/name/:agent_name Wrong name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/name/non_existent_agent\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1701);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;70eed0f9-3c80-4463-a777-fc48c154c9c0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Selector&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/name/:agent_name Selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/name/\&quot;+expected_name+\&quot;?select=dateAdd,mergedSum,os.name\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.Object;\n    res.body.data.should.have.properties([&#x27;mergedSum&#x27;,&#x27;dateAdd&#x27;,&#x27;os&#x27;]);\n    res.body.data.os.should.have.properties([&#x27;name&#x27;]);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;21779019-a27b-4163-9267-04886bd13d1b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Not allowed selector&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/name/:agent_name Not allowed selector&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/name/\&quot;+expected_name+\&quot;?select=wrongField\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1724);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c4b0e6c8-a451-41e1-941a-8fff0a7a6200&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;33b39826-ee3b-448a-9ac4-36199064a6bb&quot;,&quot;70eed0f9-3c80-4463-a777-fc48c154c9c0&quot;,&quot;21779019-a27b-4163-9267-04886bd13d1b&quot;,&quot;c4b0e6c8-a451-41e1-941a-8fff0a7a6200&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1077,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;c424026e-7599-4a70-a115-24168a419965&quot;,&quot;title&quot;:&quot;GET/agents/:agent_id/key&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent_id/key Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/001/key\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.type(&#x27;string&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;469cc82d-d552-4584-a1f1-a60726d0fbb5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad agent id&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent_id/key Params: Bad agent id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/abc/key\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(600);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;521ccd15-6a35-4b2b-91b8-5c6bcb391b33&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: No key&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent_id/key Errors: No key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:265,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/999999/key\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1701);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0588ebda-7113-4971-9693-d5aede234074&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;469cc82d-d552-4584-a1f1-a60726d0fbb5&quot;,&quot;521ccd15-6a35-4b2b-91b8-5c6bcb391b33&quot;,&quot;0588ebda-7113-4971-9693-d5aede234074&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:608,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;b156b024-557e-4f0f-beea-6ef55feae921&quot;,&quot;title&quot;:&quot;PUT/agents/groups/:group_id&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/groups/:group_id Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:265,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .put(\&quot;/agents/groups/webserver\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.error.should.equal(0);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;dd5fe8c8-49d6-472d-8ed7-1a3ccaa4d6ee&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad group name&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/groups/:group_id Params: Bad group name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.put(\&quot;/agents/groups/!group\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(601);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2253c912-bcf7-4130-b429-25ba75b7bd50&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Group already exists&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/groups/:group_id Params: Group already exists&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:264,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.put(\&quot;/agents/groups/webserver\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1711);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1195ddef-a510-4410-bdee-11f1e3ee7a6d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;dd5fe8c8-49d6-472d-8ed7-1a3ccaa4d6ee&quot;,&quot;2253c912-bcf7-4130-b429-25ba75b7bd50&quot;,&quot;1195ddef-a510-4410-bdee-11f1e3ee7a6d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:605,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;aaadfb1b-833b-448d-a847-74ac343f9c82&quot;,&quot;title&quot;:&quot;PUT/agents/:agent_id/group/:group_id&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_id/group/:group_id \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:266,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .put(\&quot;/agents/groups/dmz\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;409a5149-e3da-477d-88c7-c9d5030f1b41&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_id/group/:group_id Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:266,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .put(\&quot;/agents/001/group/webserver\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.error.should.equal(0);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9ccc3a22-8678-44eb-b40f-87572e265a8c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad agent name&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_id/group/:group_id Params: Bad agent name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.put(\&quot;/agents/001!/group/webserver\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(600);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;902d1370-b5bc-4e16-aa0e-96ed0feadab4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Agent does not exist&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_id/group/:group_id Params: Agent does not exist&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:266,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.put(\&quot;/agents/1568/group/webserver\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1701);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c5d9960e-d720-4be7-ad6d-65e42df6672e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Replace parameter&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_id/group/:group_id Params: Replace parameter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.put(\&quot;/agents/001/group/dmz?force_single_group\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a446b003-0c52-45c2-a9fa-e9946e917c2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9ccc3a22-8678-44eb-b40f-87572e265a8c&quot;,&quot;902d1370-b5bc-4e16-aa0e-96ed0feadab4&quot;,&quot;c5d9960e-d720-4be7-ad6d-65e42df6672e&quot;,&quot;a446b003-0c52-45c2-a9fa-e9946e917c2e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:876,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;acd59ace-e064-45e9-9592-a4e4a201202f&quot;,&quot;title&quot;:&quot;POST/agents/groups/:group_id/files/:file_name&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/files/:file_name \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:263,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .put(\&quot;/agents/groups/testsagentconf\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;75d540f3-8b2e-4115-831b-9b3962fc905f&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/files/:file_name Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .post(\&quot;/agents/groups/testsagentconf/files/agent.conf\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .set(&#x27;Content-Type&#x27;, &#x27;application/xml&#x27;)\n            .send(agent_xml)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.error.should.equal(0);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fa81db0e-236e-4fd2-a0ca-0a27def9551c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ErrorOnBadGroup&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/files/:file_name ErrorOnBadGroup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .post(\&quot;/agents/groups/asdfg/files/agent.conf\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .set(&#x27;Content-Type&#x27;, &#x27;application/xml&#x27;)\n            .send(agent_xml)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                res.body.error.should.equal(1710);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;118bcaeb-f154-4ad0-ae70-ea65f90c727b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ErrorOnEmptyConf&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/files/:file_name ErrorOnEmptyConf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/agents/groups/testsagentconf/files/agent.conf\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.set(&#x27;Content-Type&#x27;, &#x27;application/xml&#x27;)\n.send(\&quot;\&quot;)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(703);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d655343a-7d13-401d-bec0-7c0628d4353c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;OnlyAgentConfAllowed&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/files/:file_name OnlyAgentConfAllowed&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:264,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .post(\&quot;/agents/groups/testsagentconf/files/aaaaaa\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .set(&#x27;Content-Type&#x27;, &#x27;application/xml&#x27;)\n            .send(agent_xml)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                res.body.error.should.equal(1111);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;39814ebe-043a-48c3-a405-0ca2385e1f93&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;InvalidConfDetected&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/files/:file_name InvalidConfDetected&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .post(\&quot;/agents/groups/testsagentconf/files/agent.conf\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .set(&#x27;Content-Type&#x27;, &#x27;application/xml&#x27;)\n            .send(invalid_xml)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(400)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                res.body.error.should.equal(703);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7619d8e7-0690-42f5-93bd-4ed1868f65b1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;WrongConfDetected&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/files/:file_name WrongConfDetected&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:273,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .post(\&quot;/agents/groups/testsagentconf/files/agent.conf\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .set(&#x27;Content-Type&#x27;, &#x27;application/xml&#x27;)\n            .send(wrong_xml)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                res.body.error.should.equal(1114);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c64a9c4c-c770-4c2f-8a00-35492453da2b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;TooBigXML&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/files/:file_name TooBigXML&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1643,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;big_xml = agent_xml.repeat(600)\n            request(common.url)\n            .post(\&quot;/agents/groups/testsagentconf/files/agent.conf\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .set(&#x27;Content-Type&#x27;, &#x27;application/xml&#x27;)\n            .send(big_xml)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(400)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                res.body.error.should.equal(701);\n                done();\n            });&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;Error: expected 400 \&quot;Bad Request\&quot;, got 200 \&quot;OK\&quot;&quot;,&quot;estack&quot;:&quot;Error: expected 400 \&quot;Bad Request\&quot;, got 200 \&quot;OK\&quot;\n    at Test._assertStatus (node_modules/supertest/lib/test.js:268:12)\n    at Test._assertFunction (node_modules/supertest/lib/test.js:283:11)\n    at Test.assert (node_modules/supertest/lib/test.js:173:18)\n    at localAssert (node_modules/supertest/lib/test.js:131:12)\n    at /wazuh-api/node_modules/supertest/lib/test.js:128:5\n    at Test.Request.callback (node_modules/superagent/lib/node/index.js:716:12)\n    at /wazuh-api/node_modules/superagent/lib/node/index.js:916:18\n    at IncomingMessage.&lt;anonymous&gt; (node_modules/superagent/lib/node/parsers/json.js:19:7)\n    at endReadableNT (_stream_readable.js:1221:12)\n    at processTicksAndRejections (internal/process/task_queues.js:84:21)&quot;},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;dc817ca5-5c76-4ea8-91c9-2cd2db610173&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fa81db0e-236e-4fd2-a0ca-0a27def9551c&quot;,&quot;118bcaeb-f154-4ad0-ae70-ea65f90c727b&quot;,&quot;d655343a-7d13-401d-bec0-7c0628d4353c&quot;,&quot;39814ebe-043a-48c3-a405-0ca2385e1f93&quot;,&quot;7619d8e7-0690-42f5-93bd-4ed1868f65b1&quot;,&quot;c64a9c4c-c770-4c2f-8a00-35492453da2b&quot;],&quot;failures&quot;:[&quot;dc817ca5-5c76-4ea8-91c9-2cd2db610173&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2883,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;b6bf599a-24d4-4cd9-b162-194d77e02b31&quot;,&quot;title&quot;:&quot;GET/agents/no_group&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/no_group \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:336,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .put(\&quot;/agents/\&quot; + agent_name)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        agent_id = res.body.data.id;\n        setTimeout(function(){\n            done();\n        }, 30)\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2be412c6-791f-49f2-a6b4-3ee14297c87b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/no_group \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .delete(\&quot;/agents/\&quot; + agent_id + &#x27;?purge&#x27;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;92cc56f6-92e6-4b4b-b12e-c1b018972400&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/no_group Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/no_group\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.array;\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.totalItems.should.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;ip&#x27;, &#x27;id&#x27;, &#x27;name&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3b3fefa2-78f9-4df6-9342-3cc8ad970e94&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/no_group Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:285,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/no_group?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.array;\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.totalItems.should.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;ip&#x27;, &#x27;id&#x27;, &#x27;name&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;719566bc-de1e-4129-a751-e4507fb061be&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Retrieve all elements with limit=0&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/no_group Retrieve all elements with limit=0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/no_group?limit=0\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1406);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fbb1b21c-e1ab-4f3d-8653-59cb95305ad5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Sort&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/no_group Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/no_group?sort=-id\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.array;\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.totalItems.should.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;ip&#x27;, &#x27;id&#x27;, &#x27;name&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;899f2bd6-7bce-4b95-9702-bef193f6eff5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/no_group Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/no_group?search=\&quot; + agent_id)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.array;\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.totalItems.should.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;ip&#x27;, &#x27;id&#x27;, &#x27;name&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;333be944-3441-4093-bf85-8d9be132faa2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Select&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/no_group Select&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/no_group?select=name\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.be.an.array;\n        res.body.data.should.have.properties([&#x27;items&#x27;, &#x27;totalItems&#x27;]);\n        res.body.data.totalItems.should.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;name&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;288b1359-e883-48d9-8d1f-9126ce56655f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong select&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/no_group Wrong select&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/no_group?select=worng_select\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2ccfb5af-7749-40d1-a74f-cb8e585be1f8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: status&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/no_group Filter: status&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/no_group?status=never%20connected\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.should.have.properties([&#x27;items&#x27;,&#x27;totalItems&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6cd93a5b-4456-4297-be43-f70b7238ecf2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3b3fefa2-78f9-4df6-9342-3cc8ad970e94&quot;,&quot;719566bc-de1e-4129-a751-e4507fb061be&quot;,&quot;fbb1b21c-e1ab-4f3d-8653-59cb95305ad5&quot;,&quot;899f2bd6-7bce-4b95-9702-bef193f6eff5&quot;,&quot;333be944-3441-4093-bf85-8d9be132faa2&quot;,&quot;288b1359-e883-48d9-8d1f-9126ce56655f&quot;,&quot;2ccfb5af-7749-40d1-a74f-cb8e585be1f8&quot;,&quot;6cd93a5b-4456-4297-be43-f70b7238ecf2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2215,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;58074c50-641b-40c8-a7d9-0c38a1df8b0f&quot;,&quot;title&quot;:&quot;GET/agents/groups&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.array;\n    res.body.data.should.have.properties([&#x27;totalItems&#x27;,&#x27;items&#x27;]);\n    res.body.data.items[0].should.have.properties([&#x27;count&#x27;,&#x27;mergedSum&#x27;,&#x27;configSum&#x27;,&#x27;name&#x27;]);\n    res.body.data.items.should.be.instanceOf(Array);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b86e78c6-fa0a-4a8d-a6fe-a45c55d97b74&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Retrieve all elements with limit=0&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups Retrieve all elements with limit=0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/groups?limit=0\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1406);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;502cd3f0-e663-4ee7-8565-a3301d2faaaf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Hash algorithm&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups Hash algorithm&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:287,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups?hash=sha256\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.have.properties([&#x27;totalItems&#x27;,&#x27;items&#x27;]);\n    res.body.data.items[0].should.have.properties([&#x27;count&#x27;,&#x27;mergedSum&#x27;,&#x27;configSum&#x27;,&#x27;name&#x27;]);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;13af1d9f-cbe2-4782-9124-41613a636ac2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Hash algorithm&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups Wrong Hash algorithm&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups?hash=aaaaaa\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1723);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;361c0b5e-7295-4bdd-860c-5ad9f9352eb7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: query 1&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups Filters: query 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:278,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups?q=name~def,name=dmz\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.data.should.be.an.array;\n    res.body.data.should.have.properties([&#x27;totalItems&#x27;,&#x27;items&#x27;]);\n    res.body.data.items.should.be.instanceOf(Array);\n    res.body.data.items[0].should.have.properties([&#x27;count&#x27;,&#x27;mergedSum&#x27;,&#x27;configSum&#x27;,&#x27;name&#x27;]);\n    res.body.data.totalItems.should.equal(2);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a648be95-5f62-4dc1-b4f5-cdf721c849a9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: query 2&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups Filters: query 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups?q=name=dmz,name=default\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.data.should.be.an.array;\n    res.body.data.should.have.properties([&#x27;totalItems&#x27;,&#x27;items&#x27;]);\n    res.body.data.items.should.be.instanceOf(Array);\n    res.body.data.items[0].should.have.properties([&#x27;count&#x27;,&#x27;mergedSum&#x27;,&#x27;configSum&#x27;,&#x27;name&#x27;]);\n    res.body.data.totalItems.should.equal(2);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e4db1195-25e5-4a14-8306-70ac7e5f6887&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filters: query 3&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups Filters: query 3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:290,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups?q=name~def;count&gt;0\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.data.should.be.an.array;\n    res.body.data.should.have.properties([&#x27;totalItems&#x27;,&#x27;items&#x27;]);\n    res.body.data.items.should.be.instanceOf(Array);\n    res.body.data.items[0].should.have.properties([&#x27;count&#x27;,&#x27;mergedSum&#x27;,&#x27;configSum&#x27;,&#x27;name&#x27;]);\n    res.body.data.totalItems.should.equal(1);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;197a55d7-ef2a-40e5-9224-d20d1248afc5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b86e78c6-fa0a-4a8d-a6fe-a45c55d97b74&quot;,&quot;502cd3f0-e663-4ee7-8565-a3301d2faaaf&quot;,&quot;13af1d9f-cbe2-4782-9124-41613a636ac2&quot;,&quot;361c0b5e-7295-4bdd-860c-5ad9f9352eb7&quot;,&quot;a648be95-5f62-4dc1-b4f5-cdf721c849a9&quot;,&quot;e4db1195-25e5-4a14-8306-70ac7e5f6887&quot;,&quot;197a55d7-ef2a-40e5-9224-d20d1248afc5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1963,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;4db31974-3f0b-44f4-a557-83e979da3e34&quot;,&quot;title&quot;:&quot;GET/agents/groups/:group_id&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .get(\&quot;/agents/groups/webserver\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.data.should.have.properties([&#x27;totalItems&#x27;, &#x27;items&#x27;]);\n                res.body.error.should.equal(0);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9bde01aa-3552-4201-b81a-cdf38ec83bad&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad group name&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id Params: Bad group name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups/web!-ña\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(601);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;31aea2f7-a6f2-40d8-b0cf-d64bb678de02&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Retrieve all elements with limit=0&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id Retrieve all elements with limit=0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/groups/webserver?limit=0\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1406);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;24127527-0c7f-45da-b8f5-bdb650355275&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Select&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id Select&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:283,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups/webserver?select=lastKeepAlive,version\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;totalItems&#x27;, &#x27;items&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a71745e0-6dcd-446f-b267-f631a2aa2127&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: status&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id Filter: status&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:282,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups/webserver?status=Active,Disconnected\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;totalItems&#x27;, &#x27;items&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b710e974-1aab-40ae-9ae7-3fe2ff607cbd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9bde01aa-3552-4201-b81a-cdf38ec83bad&quot;,&quot;31aea2f7-a6f2-40d8-b0cf-d64bb678de02&quot;,&quot;24127527-0c7f-45da-b8f5-bdb650355275&quot;,&quot;a71745e0-6dcd-446f-b267-f631a2aa2127&quot;,&quot;b710e974-1aab-40ae-9ae7-3fe2ff607cbd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1199,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;40546c8e-f265-430c-9f9f-4b42cfdfe71e&quot;,&quot;title&quot;:&quot;GET/agents/groups/:group_id/configuration&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/configuration \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// write a configuration example\nvar agent_conf_example = \&quot;\\\n&lt;agent_config name=\\\&quot;agent_name\\\&quot;&gt;\\\n    &lt;localfile&gt;\\\n        &lt;location&gt;/var/log/my.log&lt;/location&gt;\\\n        &lt;log_format&gt;syslog&lt;/log_format&gt;\\\n    &lt;/localfile&gt;\\\n&lt;/agent_config&gt;\\\n\&quot;;\nvar config_path = common.ossec_path+&#x27;/etc/shared/webserver/agent.conf&#x27;;\nfs.writeFile(config_path, agent_conf_example, (err) =&gt; {\n    if (err) return done(err);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0e1f2dc3-69a4-4e21-9db7-da9186d507d7&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/configuration Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .get(\&quot;/agents/groups/webserver/configuration\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.data.should.have.properties([&#x27;totalItems&#x27;, &#x27;items&#x27;]);\n                res.body.error.should.equal(0);\n                res.body.data.items[0].should.have.properties([&#x27;config&#x27;,&#x27;filters&#x27;]);\n                res.body.data.items[0].config.should.have.properties([&#x27;localfile&#x27;]);\n                res.body.data.items[0].filters.should.have.properties([&#x27;name&#x27;]);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8f686108-3d04-4d97-988b-646116e01f96&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad group name&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/configuration Params: Bad group name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups/wñ!/configuration\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(601);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;67e1dc48-3941-4da5-9640-57c97386e2f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Retrieve all elements with limit=0&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/configuration Retrieve all elements with limit=0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:287,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/groups/webserver/configuration?limit=0\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1406);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;affb5841-d16c-4cc8-ab88-457f5a24eb14&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8f686108-3d04-4d97-988b-646116e01f96&quot;,&quot;67e1dc48-3941-4da5-9640-57c97386e2f6&quot;,&quot;affb5841-d16c-4cc8-ab88-457f5a24eb14&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:638,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;82a417eb-7b10-4db7-87b7-72808b76cb6b&quot;,&quot;title&quot;:&quot;GET/agents/groups/:group_id/files&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/files Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:279,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .get(\&quot;/agents/groups/webserver/files\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.error.should.equal(0);\n                res.body.data.items[0].should.have.properties([&#x27;hash&#x27;,&#x27;filename&#x27;]);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;041f9aa5-0776-4ff6-ba27-0575c043f80c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad group name&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/files Params: Bad group name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:102,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups/wñ!/files\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(601);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;49e0dc78-691c-4da7-9b6b-10f9843c48ec&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Retrieve all elements with limit=0&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/files Retrieve all elements with limit=0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:286,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/groups/webserver/files?limit=0\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1406);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;31ecc497-03cc-4797-ac80-3d1312a04337&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Hash algorithm&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/files Hash algorithm&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:285,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups/webserver/files?hash=sha256\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.have.properties([&#x27;totalItems&#x27;,&#x27;items&#x27;]);\n    res.body.data.items[0].should.have.properties([&#x27;hash&#x27;,&#x27;filename&#x27;]);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c0401340-047a-49bc-b54f-360afe4c78e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong Hash algorithm&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/files Wrong Hash algorithm&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:286,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups/webserver/files?hash=aaaaaa\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1723);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e88f7bcb-563c-4754-be9d-b95b53d1a1c6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;041f9aa5-0776-4ff6-ba27-0575c043f80c&quot;,&quot;49e0dc78-691c-4da7-9b6b-10f9843c48ec&quot;,&quot;31ecc497-03cc-4797-ac80-3d1312a04337&quot;,&quot;c0401340-047a-49bc-b54f-360afe4c78e3&quot;,&quot;e88f7bcb-563c-4754-be9d-b95b53d1a1c6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1238,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;a7a1f230-56b9-4a81-b460-9f56a753d42f&quot;,&quot;title&quot;:&quot;GET/agents/groups/:group_id/files/:filename&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/files/:filename Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .get(\&quot;/agents/groups/webserver/files/agent.conf\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.error.should.equal(0);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f8f96d32-6c8e-4c01-bf70-5b9e9cf9c4f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;UsingFormatAgentConfXML&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/files/:filename UsingFormatAgentConfXML&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .get(\&quot;/agents/groups/webserver/files/agent.conf?format=xml\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.data.should.be.type(&#x27;string&#x27;);\n                res.body.error.should.equal(0);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ebe1cca7-a33d-4d40-8600-36bbd0c5d2af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;UsingFormatAgentConfJSON&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/files/:filename UsingFormatAgentConfJSON&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .get(\&quot;/agents/groups/webserver/files/agent.conf?format=json\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.data.should.be.an.Object\n                res.body.error.should.equal(0);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;971a4b85-08bb-4ae1-87a1-721ea0668aad&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;UsingFormatRootcheckXML&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/files/:filename UsingFormatRootcheckXML&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:286,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .get(\&quot;/agents/groups/default/files/cis_debian_linux_rcl.txt?format=xml\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.data.should.be.an.Object\n                res.body.error.should.equal(0);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;dbc0f6bc-ae66-4162-8484-e9c2804bdd85&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;UsingFormatRootcheckJSON&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/files/:filename UsingFormatRootcheckJSON&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:335,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .get(\&quot;/agents/groups/default/files/cis_debian_linux_rcl.txt?format=json\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.data.should.be.an.Object\n                res.body.error.should.equal(0);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b80c4164-2571-4e69-9046-916abbddd6d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad group name&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/groups/:group_id/files/:filename Params: Bad group name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:89,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/groups/wñ!/files/cis_debian_linux_rcl.txt\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(601);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;863ba01f-ac49-46fb-8d58-deee807d1b76&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f8f96d32-6c8e-4c01-bf70-5b9e9cf9c4f4&quot;,&quot;ebe1cca7-a33d-4d40-8600-36bbd0c5d2af&quot;,&quot;971a4b85-08bb-4ae1-87a1-721ea0668aad&quot;,&quot;dbc0f6bc-ae66-4162-8484-e9c2804bdd85&quot;,&quot;b80c4164-2571-4e69-9046-916abbddd6d9&quot;,&quot;863ba01f-ac49-46fb-8d58-deee807d1b76&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1536,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;8c231c59-fa5f-439b-ac2f-232902659338&quot;,&quot;title&quot;:&quot;POST/agents/groups/:group_id/configuration&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/configuration \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:288,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .put(\&quot;/agents/groups/testsagentconf2\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c7d8a1a5-3e2a-4bce-a928-dfc1e8362768&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/configuration Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:351,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .post(\&quot;/agents/groups/testsagentconf2/configuration\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .set(&#x27;Content-Type&#x27;, &#x27;application/xml&#x27;)\n            .send(agent_xml)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.error.should.equal(0);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fb202e8a-883a-4171-a712-b76afa13400b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ErrorOnBadGroup&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/configuration ErrorOnBadGroup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:301,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/agents/groups/asdfg/configuration\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.set(&#x27;Content-Type&#x27;, &#x27;application/xml&#x27;)\n.send(agent_xml)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1710);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;dd682e6e-c6a1-4c69-8316-9138f2dfde3f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ErrorOnEmptyConf&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/configuration ErrorOnEmptyConf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:131,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/agents/groups/testsagentconf2/configuration\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.set(&#x27;Content-Type&#x27;, &#x27;application/xml&#x27;)\n.send(\&quot;\&quot;)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(703);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6529a401-df40-40ba-9404-da7e6b6ab7e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;InvalidConfDetected&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/configuration InvalidConfDetected&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:116,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .post(\&quot;/agents/groups/testsagentconf2/configuration\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .set(&#x27;Content-Type&#x27;, &#x27;application/xml&#x27;)\n            .send(invalid_xml)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(400)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                res.body.error.should.equal(703);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9f73dd50-1ea6-471c-af59-ea593e3c6cd1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;WrongConfDetected&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/configuration WrongConfDetected&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:329,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .post(\&quot;/agents/groups/testsagentconf2/configuration\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .set(&#x27;Content-Type&#x27;, &#x27;application/xml&#x27;)\n            .send(wrong_xml)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                res.body.error.should.equal(1114);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;73ffeb6d-6082-4088-a674-35c406350578&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;TooBigXML&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/groups/:group_id/configuration TooBigXML&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1730,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;big_xml = agent_xml.repeat(600)\n            request(common.url)\n            .post(\&quot;/agents/groups/testsagentconf2/configuration\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .set(&#x27;Content-Type&#x27;, &#x27;application/xml&#x27;)\n            .send(big_xml)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(400)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                res.body.error.should.equal(701);\n                done();\n            });&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;Error: expected 400 \&quot;Bad Request\&quot;, got 200 \&quot;OK\&quot;&quot;,&quot;estack&quot;:&quot;Error: expected 400 \&quot;Bad Request\&quot;, got 200 \&quot;OK\&quot;\n    at Test._assertStatus (node_modules/supertest/lib/test.js:268:12)\n    at Test._assertFunction (node_modules/supertest/lib/test.js:283:11)\n    at Test.assert (node_modules/supertest/lib/test.js:173:18)\n    at localAssert (node_modules/supertest/lib/test.js:131:12)\n    at /wazuh-api/node_modules/supertest/lib/test.js:128:5\n    at Test.Request.callback (node_modules/superagent/lib/node/index.js:716:12)\n    at /wazuh-api/node_modules/superagent/lib/node/index.js:916:18\n    at IncomingMessage.&lt;anonymous&gt; (node_modules/superagent/lib/node/parsers/json.js:19:7)\n    at endReadableNT (_stream_readable.js:1221:12)\n    at processTicksAndRejections (internal/process/task_queues.js:84:21)&quot;},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6ede237f-ae60-4703-803b-3b4331093d6d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fb202e8a-883a-4171-a712-b76afa13400b&quot;,&quot;dd682e6e-c6a1-4c69-8316-9138f2dfde3f&quot;,&quot;6529a401-df40-40ba-9404-da7e6b6ab7e3&quot;,&quot;9f73dd50-1ea6-471c-af59-ea593e3c6cd1&quot;,&quot;73ffeb6d-6082-4088-a674-35c406350578&quot;],&quot;failures&quot;:[&quot;6ede237f-ae60-4703-803b-3b4331093d6d&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2958,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;b48b5f56-6c95-4089-af1f-70aee22c6207&quot;,&quot;title&quot;:&quot;DELETE/agents/:agent_id/group&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/:agent_id/group Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:268,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .delete(\&quot;/agents/001/group\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.error.should.equal(0);\n                res.body.data.should.be.type(&#x27;string&#x27;);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;091ab41d-0879-4454-918c-69522bedad91&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: ID is not present&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/:agent_id/group Errors: ID is not present&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .delete(\&quot;/agents/54952/group\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                res.body.error.should.equal(1701);\n                res.body.message.should.be.type(&#x27;string&#x27;);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2fc0bd43-5a5d-4f02-92fa-77123d0c0750&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad agent id&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/:agent_id/group Params: Bad agent id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/agents/abc/group\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(600);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;57c21ef6-1ce0-4d5f-a606-05245e22b90f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;091ab41d-0879-4454-918c-69522bedad91&quot;,&quot;2fc0bd43-5a5d-4f02-92fa-77123d0c0750&quot;,&quot;57c21ef6-1ce0-4d5f-a606-05245e22b90f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:618,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;867c5092-cab8-4f61-a6be-c698d2152980&quot;,&quot;title&quot;:&quot;DELETE/agents/:agent_id/group/:group_id&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/:agent_id/group/:group_id \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .put(\&quot;/agents/001/group/dmz\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;52a5229b-9bc5-49cb-a826-0a35783b0f25&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/:agent_id/group/:group_id Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .delete(\&quot;/agents/001/group/dmz\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.error.should.equal(0);\n                res.body.data.should.be.type(&#x27;string&#x27;);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6e69406c-9d58-47cb-b31f-92bb66a04c9a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: ID is not present&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/:agent_id/group/:group_id Errors: ID is not present&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:264,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .delete(\&quot;/agents/54952/group/webserver\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                res.body.error.should.equal(1701);\n                res.body.message.should.be.type(&#x27;string&#x27;);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a73d9e56-a096-461f-8deb-867c180059a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: Group is not present&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/:agent_id/group/:group_id Errors: Group is not present&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:264,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .delete(\&quot;/agents/001/group/adsdfdfs\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n                res.body.error.should.equal(1734);\n                res.body.message.should.be.type(&#x27;string&#x27;);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;467341df-ffcf-4c67-be67-eb55d38acd04&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad agent id&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/:agent_id/group/:group_id Params: Bad agent id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/agents/abc/group/webserver\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(600);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3bbdcc44-4c68-4f22-b95b-c87c01e08a8e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad group id&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/:agent_id/group/:group_id Params: Bad group id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:264,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/agents/001/group/aaaaaaaa\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1734);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;94ff99ab-478a-4e56-b8e9-9eb4e55ee6f5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6e69406c-9d58-47cb-b31f-92bb66a04c9a&quot;,&quot;a73d9e56-a096-461f-8deb-867c180059a1&quot;,&quot;467341df-ffcf-4c67-be67-eb55d38acd04&quot;,&quot;3bbdcc44-4c68-4f22-b95b-c87c01e08a8e&quot;,&quot;94ff99ab-478a-4e56-b8e9-9eb4e55ee6f5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1136,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;793f4f2c-6a72-4875-8c2c-bead722e9164&quot;,&quot;title&quot;:&quot;DELETE/agents/groups/:group_id&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/groups/:group_id Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:265,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n            .delete(\&quot;/agents/groups/webserver\&quot;)\n            .auth(common.credentials.user, common.credentials.password)\n            .expect(\&quot;Content-type\&quot;,/json/)\n            .expect(200)\n            .end(function(err,res){\n                if (err) return done(err);\n                res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n                res.body.error.should.equal(0);\n                done();\n            });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a5aecf74-1f7b-4978-bf0e-7b19a0c2e4d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad group id&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents/groups/:group_id Params: Bad group id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.delete(\&quot;/agents/groups/webserverñ\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(601);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5addb651-fc7e-4c2d-828d-0d9a892dd441&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a5aecf74-1f7b-4978-bf0e-7b19a0c2e4d6&quot;,&quot;5addb651-fc7e-4c2d-828d-0d9a892dd441&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:341,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;8fa203b1-b529-41e4-b632-cb26d2ce43ab&quot;,&quot;title&quot;:&quot;DELETE/agents&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:266,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .put(\&quot;/agents/agentToDelete\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) throw err;\n        agent1_id = res.body.data.id;\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f18c009d-c590-4795-adae-800d832a7359&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:266,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n                .put(\&quot;/agents/agentToDelete2\&quot;)\n                .auth(common.credentials.user, common.credentials.password)\n                .expect(\&quot;Content-type\&quot;, /json/)\n                .expect(200)\n                .end(function (err, res) {\n                    if (err) throw err;\n                    agent2_id = res.body.data.id;\n                    done();\n                });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;96060cc7-4f06-4d5e-8c10-3d19433c4a37&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .delete(\&quot;/agents\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(400)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;512e407a-f6a3-4555-8f3f-66c6dc8befbe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: older_than, status and ids&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents Filter: older_than, status and ids&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3810,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;setTimeout(function(){\n    request(common.url)\n        .delete(\&quot;/agents?purge&amp;ids=\&quot; + agent1_id + \&quot;&amp;older_than=1s&amp;status=neverconnected\&quot;)\n        .auth(common.credentials.user, common.credentials.password)\n        .expect(\&quot;Content-type\&quot;, /json/)\n        .expect(200)\n        .end(function (err, res) {\n            if (err) return done(err);\n            res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n            res.body.data.should.have.properties([&#x27;affected_agents&#x27;, &#x27;msg&#x27;, &#x27;older_than&#x27;]);\n            if (&#x27;failed_ids&#x27; in res.body.data &amp;&amp; res.body.data.failed_ids.length &gt; 0)\n                console.log(res.body.data.failed_ids[0].error);\n            res.body.data.msg.should.equal(\&quot;All selected agents were removed\&quot;);\n            res.body.data.affected_agents[0].should.equal(agent1_id);\n            res.body.data.affected_agents.should.have.lengthOf(1);\n            res.body.error.should.equal(0);\n            setTimeout(function(){\n                done();\n            }, 30)\n        });\n}, 3500);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c36597e6-0883-470a-b4c4-2628d26f3d9d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Errors: Get deleted agent&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents Errors: Get deleted agent&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:306,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/\&quot; + agent1_id)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1701);\n        setTimeout(function(){\n            done();\n        }, 30)\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;57cf8bc0-2343-4676-b98b-5fd2eddcb02c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Filter: older_than&quot;,&quot;fullTitle&quot;:&quot;Agents DELETE/agents Filter: older_than&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .delete(\&quot;/agents?older_than=1s&amp;purge&amp;status=neverconnected\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.data.should.have.properties([&#x27;affected_agents&#x27;, &#x27;msg&#x27;, &#x27;older_than&#x27;]);\n        res.body.data.msg.should.equal(\&quot;All selected agents were removed\&quot;);\n        res.body.data.affected_agents[0].should.equal(agent2_id);\n        res.body.error.should.equal(0);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3a26c16c-f3d5-4dbc-95ef-83228f061206&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;512e407a-f6a3-4555-8f3f-66c6dc8befbe&quot;,&quot;c36597e6-0883-470a-b4c4-2628d26f3d9d&quot;,&quot;57cf8bc0-2343-4676-b98b-5fd2eddcb02c&quot;,&quot;3a26c16c-f3d5-4dbc-95ef-83228f061206&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4468,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;baf48c62-a7d6-4475-a8a0-9523d31df967&quot;,&quot;title&quot;:&quot;GET/agents/stats/distinct&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/stats/distinct Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/stats/distinct\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array);\n        res.body.data.items[0].should.have.properties(fields);\n        res.body.data.items[0].os.should.have.properties(agent_os_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5abd88cb-0e03-4a60-9743-53d1d403415a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Pagination&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/stats/distinct Pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/stats/distinct?offset=0&amp;limit=1\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.items.should.be.instanceof(Array).and.have.lengthOf(1);\n        res.body.data.items[0].should.have.properties(fields);\n        res.body.data.items[0].os.should.have.properties(agent_os_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;dddc0d46-9a43-4cad-9a8d-e7ea747b9c3a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Retrieve all elements with limit=0&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/stats/distinct Retrieve all elements with limit=0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:263,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/stats/distinct?limit=0\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1406);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4358d772-a103-42e2-9b6a-09f02b4e88f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Sort&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/stats/distinct Sort&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/stats/distinct?sort=-node_name\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(fields);\n        res.body.data.items[0].os.should.have.properties(agent_os_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a3bd9131-9759-460a-8e2a-b7d9cf65bcf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Search&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/stats/distinct Search&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:265,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/stats/distinct?search=linux\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties(fields);\n        res.body.data.items[0].os.should.have.properties(agent_os_properties);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f907d59f-69d2-48bd-9a9c-a4fa78920513&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Select&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/stats/distinct Select&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:264,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/stats/distinct?select=os.platform\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n        res.body.error.should.equal(0);\n        res.body.data.totalItems.should.be.above(0);\n        res.body.data.items.should.be.instanceof(Array)\n        res.body.data.items[0].should.have.properties([&#x27;os&#x27;]);\n        res.body.data.items[0].os.should.have.properties([&#x27;platform&#x27;]);\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8b9e6aa3-3deb-45e7-b97c-2134caaf19b8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Wrong select&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/stats/distinct Wrong select&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:265,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n    .get(\&quot;/agents/stats/distinct?select=wrong_field\&quot;)\n    .auth(common.credentials.user, common.credentials.password)\n    .expect(\&quot;Content-type\&quot;, /json/)\n    .expect(200)\n    .end(function (err, res) {\n        if (err) return done(err);\n        res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n        res.body.error.should.equal(1724);\n        res.body.message.should.be.instanceof(String)\n        done();\n    });&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e037b84c-acf1-478a-a746-08e5e8906303&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5abd88cb-0e03-4a60-9743-53d1d403415a&quot;,&quot;dddc0d46-9a43-4cad-9a8d-e7ea747b9c3a&quot;,&quot;4358d772-a103-42e2-9b6a-09f02b4e88f2&quot;,&quot;a3bd9131-9759-460a-8e2a-b7d9cf65bcf4&quot;,&quot;f907d59f-69d2-48bd-9a9c-a4fa78920513&quot;,&quot;8b9e6aa3-3deb-45e7-b97c-2134caaf19b8&quot;,&quot;e037b84c-acf1-478a-a746-08e5e8906303&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1863,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;50b03a7d-156d-4f38-87db-d6204ec404da&quot;,&quot;title&quot;:&quot;GET/agents/:agent/config/:component/:configuration&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request-Agent-Client&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Agent-Client&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/002/config/agent/client\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n\t\t\t\tres.body.data.should.have.properties(&#x27;client&#x27;);\n\t\t\t\tres.body.data.client.should.have.properties([&#x27;crypto_method&#x27;, &#x27;remote_conf&#x27;, &#x27;auto_restart&#x27;,\n\t\t\t\t&#x27;server&#x27;, &#x27;config-profile&#x27;, &#x27;time-reconnect&#x27;, &#x27;notify_time&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;00e7e5c1-e41a-4bdf-a4d5-1d6b3430afd5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Agent-Buffer&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Agent-Buffer&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4277,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/001/config/agent/buffer\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;buffer&#x27;);\n\t\t\t\tres.body.data.buffer.should.have.properties([&#x27;disabled&#x27;,\n\t\t\t\t&#x27;queue_size&#x27;, &#x27;events_per_second&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Object {\n  error: 1116,\n  message: &#x27;Requested component configuration does not exist&#x27;\n} to have property data&quot;,&quot;estack&quot;:&quot;AssertionError: expected Object {\n  error: 1116,\n  message: &#x27;Requested component configuration does not exist&#x27;\n} to have property data\n    at Assertion.fail (node_modules/should/cjs/should.js:258:17)\n    at Assertion.value [as properties] (node_modules/should/cjs/should.js:335:19)\n    at Test.&lt;anonymous&gt; (test/test_agents.js:2375:38)\n    at Test.assert (node_modules/supertest/lib/test.js:181:6)\n    at localAssert (node_modules/supertest/lib/test.js:131:12)\n    at /wazuh-api/node_modules/supertest/lib/test.js:128:5\n    at Test.Request.callback (node_modules/superagent/lib/node/index.js:716:12)\n    at /wazuh-api/node_modules/superagent/lib/node/index.js:916:18\n    at IncomingMessage.&lt;anonymous&gt; (node_modules/superagent/lib/node/parsers/json.js:19:7)\n    at endReadableNT (_stream_readable.js:1221:12)\n    at processTicksAndRejections (internal/process/task_queues.js:84:21)&quot;},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c433a1c2-2cf1-436c-829e-49831280c395&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Agent-Labels&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Agent-Labels&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/002/config/agent/labels\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    // res.body.data.shoul.have.properties(&#x27;labels&#x27;); // empty list\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;70b23ec9-f46f-4ae3-86e3-0295679763ce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Agent-Internal&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Agent-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/002/config/agent/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;internal&#x27;);\n\t\t\t\tres.body.data.internal.should.have.properties([&#x27;monitord&#x27;, &#x27;remoted&#x27;,\n\t\t\t\t&#x27;agent&#x27;]);\n\t\t\t\tres.body.data.internal.monitord.should.have.properties([&#x27;daily_rotations&#x27;,\n\t\t\t\t&#x27;day_wait&#x27;, &#x27;keep_log_days&#x27;, &#x27;compress&#x27;, &#x27;size_rotate&#x27;, &#x27;rotate_log&#x27;]);\n\t\t\t\tres.body.data.internal.remoted.should.have.properties(&#x27;request_rto_msec&#x27;,\n\t\t\t\t&#x27;recv_counter_flush&#x27;, &#x27;request_pool&#x27;, &#x27;comp_average_printout&#x27;,\n\t\t\t\t&#x27;verify_msg_id&#x27;, &#x27;max_attempts&#x27;);\n\t\t\t\tres.body.data.internal.agent.should.have.properties(&#x27;normal_level&#x27;,\n\t\t\t\t&#x27;min_eps&#x27;, &#x27;recv_timeout&#x27;, &#x27;state_interval&#x27;, &#x27;warn_level&#x27;, &#x27;debug&#x27;, &#x27;tolerance&#x27;);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c55c72e3-d3a5-4f63-83b3-887b7e432660&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Agentless-Agentless&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Agentless-Agentless&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:268,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/agentless/agentless\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;agentless&#x27;); // returns an array\n    res.body.data.agentless[0].should.have.properties([&#x27;state&#x27;, &#x27;host&#x27;,\n    &#x27;frequency&#x27;, &#x27;arguments&#x27;, &#x27;type&#x27;, &#x27;port&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f5c6f472-9d09-4aa9-b8bb-422b4af956a7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Analysis-Global&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Analysis-Global&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/analysis/global\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;global&#x27;]);\n    res.body.data.global.should.have.properties([&#x27;email_notification&#x27;, &#x27;max_output_size&#x27;,\n    &#x27;alerts_log&#x27;, &#x27;zeromq_output&#x27;, &#x27;host_information&#x27;, &#x27;jsonout_output&#x27;, &#x27;rotate_interval&#x27;,\n    &#x27;rootkit_detection&#x27;, &#x27;integrity_checking&#x27;, &#x27;memory_size&#x27;, &#x27;logall&#x27;, &#x27;prelude_output&#x27;,\n    &#x27;stats&#x27;, &#x27;white_list&#x27;, &#x27;logall_json&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f2798bb2-8775-4089-a89b-c141e069df8a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Analysis-Active-response&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Analysis-Active-response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/analysis/active_response\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    // res.body.data.should.have.properties([&#x27;active_response&#x27;]); // empty list\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b83df369-e45c-40ae-b139-2bd5583d0290&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Analysis-Alerts&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Analysis-Alerts&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:281,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/analysis/alerts\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;alerts&#x27;]);\n    res.body.data.alerts.should.have.properties([&#x27;email_alert_level&#x27;, &#x27;log_alert_level&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;20363ce7-a0d4-483d-a529-525e1e94e8bf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Analysis-Command&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Analysis-Command&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/analysis/command\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;command&#x27;);\n    res.body.data.command[0].should.have.properties([&#x27;executable&#x27;, &#x27;timeout_allowed&#x27;,\n    &#x27;name&#x27;, &#x27;expect&#x27;]);\n    res.body.data.command[1].should.have.properties([&#x27;executable&#x27;, &#x27;timeout_allowed&#x27;,\n    &#x27;name&#x27;]);\n    res.body.data.command[2].should.have.properties([&#x27;executable&#x27;, &#x27;timeout_allowed&#x27;,\n    &#x27;name&#x27;, &#x27;expect&#x27;]);\n    res.body.data.command[3].should.have.properties([&#x27;executable&#x27;, &#x27;timeout_allowed&#x27;,\n    &#x27;name&#x27;, &#x27;expect&#x27;]);\n    res.body.data.command[4].should.have.properties([&#x27;executable&#x27;, &#x27;timeout_allowed&#x27;,\n    &#x27;name&#x27;, &#x27;expect&#x27;]);\n    res.body.data.command[5].should.have.properties([&#x27;executable&#x27;, &#x27;timeout_allowed&#x27;,\n    &#x27;name&#x27;, &#x27;expect&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a6b5c0f9-d5c2-43a2-afcb-d4f15ac2268e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Analysis-Internal&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Analysis-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/analysis/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;internal&#x27;);\n    res.body.data.internal.should.have.properties([&#x27;analysisd&#x27;]);\n    res.body.data.internal.analysisd.should.have.properties([&#x27;label_cache_maxage&#x27;,\n    &#x27;stats_percent_diff&#x27;, &#x27;show_hidden_labels&#x27;, &#x27;decoder_order_size&#x27;,\n    &#x27;min_rotate_interval&#x27;, &#x27;stats_mindiff&#x27;, &#x27;log_fw&#x27;, &#x27;rlimit_nofile&#x27;, &#x27;fts_list_size&#x27;,\n    &#x27;debug&#x27;, &#x27;fts_min_size_for_str&#x27;, &#x27;default_timeframe&#x27;, &#x27;stats_maxdiff&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ef0ba7ee-3232-478b-a3d6-b33ce3cc1ddb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Auth-Auth&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Auth-Auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/auth/auth\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;auth&#x27;);\n    res.body.data.auth.should.have.properties([&#x27;purge&#x27;, &#x27;ssl_auto_negotiate&#x27;, &#x27;ciphers&#x27;,\n    &#x27;force_insert&#x27;, &#x27;ssl_verify_host&#x27;, &#x27;limit_maxagents&#x27;, &#x27;force_time&#x27;,\n    &#x27;ssl_manager_key&#x27;, &#x27;disabled&#x27;, &#x27;ssl_manager_cert&#x27;, &#x27;use_source_ip&#x27;,\n    &#x27;use_password&#x27;, &#x27;port&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b073f6a0-893c-4299-8808-1db46b3aec8f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Com-Active-response&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Com-Active-response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:274,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/002/config/com/active-response\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;active-response&#x27;]);\n    res.body.data[&#x27;active-response&#x27;].should.have.properties([&#x27;disabled&#x27;, &#x27;ca_store&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7943846d-675e-4d31-bfb2-04a3a4047da8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Com-Internal&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Com-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/002/config/com/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;internal&#x27;]);\n    res.body.data.internal.should.have.properties([&#x27;execd&#x27;]);\n    res.body.data.internal.execd.should.have.properties([&#x27;request_timeout&#x27;, &#x27;max_restart_lock&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f3c5695a-e634-4e21-b569-1261b9a7b2a8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Csyslog-Csyslog&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Csyslog-Csyslog&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/csyslog/csyslog\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;syslog_output&#x27;]);\n    res.body.data[&#x27;syslog_output&#x27;][0].should.have.properties([&#x27;format&#x27;,\n    &#x27;level&#x27;, &#x27;use_fqdn&#x27;, &#x27;port&#x27;, &#x27;server&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;937f13ed-0bd9-4f14-aaf6-f9575a4610a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Integrator-Integration&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Integrator-Integration&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:267,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/integrator/integration\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;integration&#x27;);\n    res.body.data.integration[0].should.have.properties([&#x27;alert_format&#x27;, &#x27;hook_url&#x27;,\n    &#x27;group&#x27;, &#x27;name&#x27;, &#x27;level&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;537c65e3-788e-447a-bbf4-441b5efc21ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Logcollector-Localfile&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Logcollector-Localfile&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/002/config/logcollector/localfile\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;localfile&#x27;);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;001b3304-1c2f-4391-ad30-faa781b2119e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Logcollector-Socket&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Logcollector-Socket&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/002/config/logcollector/socket\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    // res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]); // data property is empty\n    // res.body.data.should.have.properties([&#x27;socket&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d1a97086-a11e-43b3-af6f-10f892e4b78c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Logcollector-Internal&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Logcollector-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/002/config/logcollector/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;internal&#x27;);\n    res.body.data.internal.should.have.properties(&#x27;logcollector&#x27;);\n\t\t\t\tres.body.data.internal.logcollector.should.have.properties([&#x27;open_attempts&#x27;, &#x27;input_threads&#x27;,\n    &#x27;vcheck_files&#x27;, &#x27;max_files&#x27;, &#x27;sock_fail_time&#x27;, &#x27;queue_size&#x27;, &#x27;max_lines&#x27;, &#x27;remote_commands&#x27;,\n    &#x27;loop_timeout&#x27;, &#x27;debug&#x27;, &#x27;open_attempts&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;51aeceab-233e-44d9-9b7e-4bc75f949e5c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Mail-Global&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Mail-Global&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:266,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/mail/global\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;global&#x27;);\n    res.body.data.global.should.have.properties([&#x27;email_maxperhour&#x27;, &#x27;email_to&#x27;,\n    &#x27;email_from&#x27;, &#x27;smtp_server&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;47ed5b4c-11dd-47a3-88a4-3fb20f2d49d8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Mail-Alerts&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Mail-Alerts&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/mail/alerts\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    // res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]); // data property is empty\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;795072a0-718f-414f-b080-f5d8d4f3f6cb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Mail-Internal&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Mail-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/mail/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;internal&#x27;);\n    res.body.data.internal.should.have.properties(&#x27;mail&#x27;);\n    res.body.data.internal.mail.should.have.properties([&#x27;strict_checking&#x27;,\n    &#x27;grouping&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e94a0732-83b0-4902-a406-89730f79671d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Monitor-Internal&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Monitor-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/monitor/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;monitord&#x27;);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e092b206-a3ad-4280-85b4-c39de1d4a5cb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Request-Remote&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Request-Remote&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:266,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/request/remote\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;remote&#x27;);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;728b318d-055e-4912-9569-70da9b454ace&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Request-Internal&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Request-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:268,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/000/config/request/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties(&#x27;internal&#x27;);\n    res.body.data.internal.should.have.properties(&#x27;remoted&#x27;);\n    res.body.data.internal.remoted.should.have.properties([&#x27;request_timeout&#x27;, &#x27;pass_empty_keyfile&#x27;,\n    &#x27;recv_timeout&#x27;, &#x27;request_rto_sec&#x27;, &#x27;request_rto_msec&#x27;, &#x27;response_timeout&#x27;, &#x27;sender_pool&#x27;, &#x27;recv_counter_flush&#x27;,\n    &#x27;request_pool&#x27;, &#x27;comp_average_printout&#x27;, &#x27;shared_reload&#x27;, &#x27;merge_shared&#x27;, &#x27;rlimit_nofile&#x27;,\n    &#x27;verify_msg_id&#x27;, &#x27;max_attempts&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d92825c6-32ec-4504-9aaf-32fc401459d7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Syscheck-Syscheck&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Syscheck-Syscheck&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:273,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/002/config/syscheck/syscheck\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;syscheck&#x27;]);\n    res.body.data.syscheck.should.have.properties([&#x27;ignore&#x27;, &#x27;skip_nfs&#x27;, &#x27;directories&#x27;,\n    &#x27;scan_on_start&#x27;, &#x27;disabled&#x27;, &#x27;frequency&#x27;, &#x27;whodata&#x27;, &#x27;nodiff&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;df19f1eb-b27a-4769-b583-96b54028e79a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Syscheck-Rootcheck&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Syscheck-Rootcheck&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/002/config/syscheck/rootcheck\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;rootcheck&#x27;]);\n    res.body.data.rootcheck.should.have.properties([&#x27;check_unixaudit&#x27;, &#x27;check_sys&#x27;, &#x27;rootkit_trojans&#x27;,\n    &#x27;skip_nfs&#x27;, &#x27;check_if&#x27;, &#x27;check_pids&#x27;, &#x27;check_dev&#x27;, &#x27;check_ports&#x27;, &#x27;disabled&#x27;, &#x27;rootkit_files&#x27;,\n    // &#x27;frequency&#x27;, &#x27;scanall&#x27;, &#x27;check_trojans&#x27;, &#x27;base_directory&#x27;, &#x27;check_files&#x27;, &#x27;system_audit&#x27;]); // base directory value is empty, this cause an error, system_audit is optional\n    &#x27;frequency&#x27;, &#x27;scanall&#x27;, &#x27;check_trojans&#x27;, &#x27;check_files&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e81abeb6-a2c8-4f1c-baa7-18c25af414da&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Syscheck-Internal&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Syscheck-Internal&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:272,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/002/config/syscheck/internal\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;internal&#x27;]);\n    res.body.data.internal.should.have.properties([&#x27;syscheck&#x27;, &#x27;rootcheck&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6cb412b8-6cee-4345-a82e-ffa75a3fed01&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request-Wmodules-Wmodules&quot;,&quot;fullTitle&quot;:&quot;Agents GET/agents/:agent/config/:component/:configuration Request-Wmodules-Wmodules&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:273,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.get(\&quot;/agents/002/config/wmodules/wmodules\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;wmodules&#x27;]);\n    //res.body.data.wmodules.should.have.properties([&#x27;open-scap&#x27;, &#x27;cis-cat&#x27;,\n    //&#x27;osquery&#x27;, &#x27;syscollector&#x27;, &#x27;database&#x27;, &#x27;wazuh_download&#x27;]);\n    res.body.data.wmodules[0].should.have.properties([&#x27;open-scap&#x27;]);\n    res.body.data.wmodules[1].should.have.properties([&#x27;cis-cat&#x27;]);\n    res.body.data.wmodules[2].should.have.properties([&#x27;osquery&#x27;]);\n    res.body.data.wmodules[3].should.have.properties([&#x27;syscollector&#x27;]);\n    res.body.error.should.equal(0);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;962c0d19-b963-49a6-8864-c317a1e39a69&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;00e7e5c1-e41a-4bdf-a4d5-1d6b3430afd5&quot;,&quot;70b23ec9-f46f-4ae3-86e3-0295679763ce&quot;,&quot;c55c72e3-d3a5-4f63-83b3-887b7e432660&quot;,&quot;f5c6f472-9d09-4aa9-b8bb-422b4af956a7&quot;,&quot;f2798bb2-8775-4089-a89b-c141e069df8a&quot;,&quot;b83df369-e45c-40ae-b139-2bd5583d0290&quot;,&quot;20363ce7-a0d4-483d-a529-525e1e94e8bf&quot;,&quot;a6b5c0f9-d5c2-43a2-afcb-d4f15ac2268e&quot;,&quot;ef0ba7ee-3232-478b-a3d6-b33ce3cc1ddb&quot;,&quot;b073f6a0-893c-4299-8808-1db46b3aec8f&quot;,&quot;7943846d-675e-4d31-bfb2-04a3a4047da8&quot;,&quot;f3c5695a-e634-4e21-b569-1261b9a7b2a8&quot;,&quot;937f13ed-0bd9-4f14-aaf6-f9575a4610a1&quot;,&quot;537c65e3-788e-447a-bbf4-441b5efc21ae&quot;,&quot;001b3304-1c2f-4391-ad30-faa781b2119e&quot;,&quot;d1a97086-a11e-43b3-af6f-10f892e4b78c&quot;,&quot;51aeceab-233e-44d9-9b7e-4bc75f949e5c&quot;,&quot;47ed5b4c-11dd-47a3-88a4-3fb20f2d49d8&quot;,&quot;795072a0-718f-414f-b080-f5d8d4f3f6cb&quot;,&quot;e94a0732-83b0-4902-a406-89730f79671d&quot;,&quot;e092b206-a3ad-4280-85b4-c39de1d4a5cb&quot;,&quot;728b318d-055e-4912-9569-70da9b454ace&quot;,&quot;d92825c6-32ec-4504-9aaf-32fc401459d7&quot;,&quot;df19f1eb-b27a-4769-b583-96b54028e79a&quot;,&quot;e81abeb6-a2c8-4f1c-baa7-18c25af414da&quot;,&quot;6cb412b8-6cee-4345-a82e-ffa75a3fed01&quot;,&quot;962c0d19-b963-49a6-8864-c317a1e39a69&quot;],&quot;failures&quot;:[&quot;c433a1c2-2cf1-436c-829e-49831280c395&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11578,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;ba459a3e-f9a8-4c4a-9c74-3bacab264b0c&quot;,&quot;title&quot;:&quot;PUT/agents/restart&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/restart Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:296,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(common.timeout);\nrequest(common.url)\n.put(\&quot;/agents/restart\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.type(&#x27;string&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4d7939ba-e24a-47ec-8310-67dd072011fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4d7939ba-e24a-47ec-8310-67dd072011fb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:296,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;4035f944-fa12-4428-a58d-b68bdf2eef7d&quot;,&quot;title&quot;:&quot;PUT/agents/:agent_id/restart&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_id/restart Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4276,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(common.timeout);\nrequest(common.url)\n.put(\&quot;/agents/001/restart\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.type(&#x27;object&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7c7fbe57-7ad4-4e9b-a5e7-5b027f9ef787&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad agent id&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_id/restart Params: Bad agent id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:88,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.put(\&quot;/agents/abc/restart\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(600);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1338f25c-3ccb-45fd-b674-b7302b60e851&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/:agent_id/restart Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:271,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(common.timeout);\nrequest(common.url)\n.put(\&quot;/agents/000/restart\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;msg&#x27;, &#x27;failed_ids&#x27;, &#x27;affected_agents&#x27;]);\n    res.body.data.failed_ids[0].error.code.should.equal(1703);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7a54e688-a93e-4dcb-815f-3e7ca4ffa77b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7c7fbe57-7ad4-4e9b-a5e7-5b027f9ef787&quot;,&quot;1338f25c-3ccb-45fd-b674-b7302b60e851&quot;,&quot;7a54e688-a93e-4dcb-815f-3e7ca4ffa77b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4635,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;53a81718-01e7-43d7-9f57-9c4dff0eacf7&quot;,&quot;title&quot;:&quot;POST/agents/restart&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/restart Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1981,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(common.timeout);\nrequest(common.url)\n.post(\&quot;/agents/restart\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.send({ &#x27;ids&#x27;: [&#x27;002&#x27;]})\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.type(&#x27;object&#x27;);\n    res.body.data.should.have.properties([&#x27;msg&#x27;, &#x27;affected_agents&#x27;]);\n    res.body.data.affected_agents[0].should.equal(&#x27;002&#x27;);\n    res.body.data.msg.should.equal(&#x27;All selected agents were restarted&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;94e04e01-5d9b-4999-b72c-5f901900deb0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: A good id and a bad one&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/restart Params: A good id and a bad one&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:298,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(common.timeout);\nrequest(common.url)\n.post(\&quot;/agents/restart\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.send({ &#x27;ids&#x27;: [&#x27;002&#x27;, &#x27;005&#x27;]})\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.type(&#x27;object&#x27;);\n    res.body.data.should.have.properties([&#x27;msg&#x27;, &#x27;affected_agents&#x27;, &#x27;failed_ids&#x27;]);\n    res.body.data.affected_agents[0].should.equal(&#x27;002&#x27;);\n    res.body.data.failed_ids[0].id.should.equal(&#x27;005&#x27;);\n    res.body.data.failed_ids[0].error.code.should.equal(1701);\n    res.body.data.msg.should.equal(&#x27;Some agents were not restarted&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9123fd09-1a6b-4feb-a37c-0f4bc26e54e7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad agent id&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/restart Params: Bad agent id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.post(\&quot;/agents/restart\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.send({ &#x27;ids&#x27;: [&#x27;abc&#x27;]})\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(616);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;967f9e3a-91d0-4ff8-950a-b7faa9af3430&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents POST/agents/restart Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:275,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(common.timeout);\nrequest(common.url)\n.post(\&quot;/agents/restart\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.send({ &#x27;ids&#x27;: [&#x27;000&#x27;]})\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.data.should.have.properties([&#x27;msg&#x27;, &#x27;failed_ids&#x27;, &#x27;affected_agents&#x27;]);\n    res.body.data.failed_ids[0].error.code.should.equal(1703);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;76516556-ef45-4692-88c6-e2d2fe867923&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;94e04e01-5d9b-4999-b72c-5f901900deb0&quot;,&quot;9123fd09-1a6b-4feb-a37c-0f4bc26e54e7&quot;,&quot;967f9e3a-91d0-4ff8-950a-b7faa9af3430&quot;,&quot;76516556-ef45-4692-88c6-e2d2fe867923&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2632,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;efc43d23-5170-4346-8675-bcc298a0c839&quot;,&quot;title&quot;:&quot;PUT/agents/groups/:group_id/restart&quot;,&quot;fullFile&quot;:&quot;/wazuh-api/test/test_agents.js&quot;,&quot;file&quot;:&quot;/test/test_agents.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Request&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/groups/:group_id/restart Request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:305,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(common.timeout);\nrequest(common.url)\n.put(\&quot;/agents/groups/default/restart\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;data&#x27;]);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.type(&#x27;object&#x27;);\n    res.body.data.should.have.properties([&#x27;msg&#x27;, &#x27;affected_agents&#x27;]);\n    res.body.data.affected_agents.sort().should.be.eql([&#x27;001&#x27;, &#x27;002&#x27;].sort());\n    res.body.data.msg.should.equal(&#x27;Some agents were not restarted&#x27;);\n    res.body.data.failed_ids[0].id.should.equal(&#x27;003&#x27;);\n    res.body.data.failed_ids[0].error.code.should.equal(1735);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;de765b04-51be-4a22-9239-60e0b7fc8120&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Params: Bad group id&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/groups/:group_id/restart Params: Bad group id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:277,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.put(\&quot;/agents/groups/wrong-group/restart\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1751);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8045fa46-ee1a-4287-aed3-0c58e1b0f528&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Group without agents&quot;,&quot;fullTitle&quot;:&quot;Agents PUT/agents/groups/:group_id/restart Group without agents&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:262,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request(common.url)\n.put(\&quot;/agents/groups/dmz/restart\&quot;)\n.auth(common.credentials.user, common.credentials.password)\n.expect(\&quot;Content-type\&quot;,/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties([&#x27;error&#x27;, &#x27;message&#x27;]);\n    res.body.error.should.equal(1751);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;69cff259-fffb-4d2c-96af-a61c59fa4eb3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;de765b04-51be-4a22-9239-60e0b7fc8120&quot;,&quot;8045fa46-ee1a-4287-aed3-0c58e1b0f528&quot;,&quot;69cff259-fffb-4d2c-96af-a61c59fa4eb3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:844,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:10000},&quot;copyrightYear&quot;:2020}" data-config="{&quot;reportFilename&quot;:&quot;agents&quot;,&quot;reportDir&quot;:&quot;/share&quot;,&quot;reportTitle&quot;:&quot;wazuh-api&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:true,&quot;enableCharts&quot;:true,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;/share/assets&quot;,&quot;jsonFile&quot;:&quot;/share/agents.json&quot;,&quot;htmlFile&quot;:&quot;/share/agents.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>