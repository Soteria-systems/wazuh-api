{
  "stats": {
    "suites": 6,
    "tests": 11,
    "passes": 6,
    "pending": 0,
    "failures": 5,
    "start": "2020-06-08T12:19:10.554Z",
    "end": "2020-06-08T12:19:13.082Z",
    "duration": 2528,
    "testsRegistered": 11,
    "passPercent": 54.5,
    "pendingPercent": 0,
    "other": 0,
    "hasOther": false,
    "skipped": 0,
    "hasSkipped": false,
    "passPercentClass": "warning",
    "pendingPercentClass": "danger"
  },
  "suites": {
    "uuid": "4dbfa678-59e8-430b-ac1f-5c30cd53a3b1",
    "title": "",
    "fullFile": "",
    "file": "",
    "beforeHooks": [],
    "afterHooks": [],
    "tests": [],
    "suites": [
      {
        "uuid": "450081ca-e68d-4402-bf1e-8a85208ebcc3",
        "title": "Rootcheck",
        "fullFile": "/wazuh-api/test/test_rootcheck.js",
        "file": "/test/test_rootcheck.js",
        "beforeHooks": [],
        "afterHooks": [],
        "tests": [],
        "suites": [
          {
            "uuid": "3d418f08-2a7f-46cf-a8c5-9b05d9965a04",
            "title": "GET/rootcheck/:agent_id/last_scan",
            "fullFile": "/wazuh-api/test/test_rootcheck.js",
            "file": "/test/test_rootcheck.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Rootcheck GET/rootcheck/:agent_id/last_scan Request",
                "timedOut": false,
                "duration": 314,
                "state": "failed",
                "pass": false,
                "fail": true,
                "pending": false,
                "code": "request(common.url)\n.get(\"/rootcheck/000/last_scan\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.Object;\n    res.body.data.should.have.properties(['end', 'start']);\n    done();\n});",
                "err": {
                  "message": "AssertionError: expected Object {\n  error: 1017,\n  message: 'Some Wazuh daemons are not ready in node \\'master\\' (wazuh-modulesd->restarting, ossec-analysisd->restarting, ossec-execd->restarting, wazuh-db->restarting, ossec-remoted->restarting)'\n} to have property data",
                  "estack": "AssertionError: expected Object {\n  error: 1017,\n  message: 'Some Wazuh daemons are not ready in node \\'master\\' (wazuh-modulesd->restarting, ossec-analysisd->restarting, ossec-execd->restarting, wazuh-db->restarting, ossec-remoted->restarting)'\n} to have property data\n    at Assertion.fail (node_modules/should/cjs/should.js:258:17)\n    at Assertion.value [as properties] (node_modules/should/cjs/should.js:335:19)\n    at Test.<anonymous> (test/test_rootcheck.js:35:38)\n    at Test.assert (node_modules/supertest/lib/test.js:181:6)\n    at localAssert (node_modules/supertest/lib/test.js:131:12)\n    at /wazuh-api/node_modules/supertest/lib/test.js:128:5\n    at Test.Request.callback (node_modules/superagent/lib/node/index.js:716:12)\n    at /wazuh-api/node_modules/superagent/lib/node/index.js:916:18\n    at IncomingMessage.<anonymous> (node_modules/superagent/lib/node/parsers/json.js:19:7)\n    at endReadableNT (_stream_readable.js:1221:12)\n    at processTicksAndRejections (internal/process/task_queues.js:84:21)"
                },
                "isRoot": false,
                "uuid": "eaa2049a-6c49-4583-8d64-3f8ca8bfa44b",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad agent id",
                "fullTitle": "Rootcheck GET/rootcheck/:agent_id/last_scan Params: Bad agent id",
                "timedOut": false,
                "duration": 83,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/rootcheck/abc/last_scan\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(600);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "00237a82-256d-4a22-9051-b62fe9787942",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Errors: No agent",
                "fullTitle": "Rootcheck GET/rootcheck/:agent_id/last_scan Errors: No agent",
                "timedOut": false,
                "duration": 297,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.get(\"/rootcheck/9999999/last_scan\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1701);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "d92176d9-de69-43ba-9227-a268d0d2d1b6",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "00237a82-256d-4a22-9051-b62fe9787942",
              "d92176d9-de69-43ba-9227-a268d0d2d1b6"
            ],
            "failures": [
              "eaa2049a-6c49-4583-8d64-3f8ca8bfa44b"
            ],
            "pending": [],
            "skipped": [],
            "duration": 694,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "8c753f75-00e3-4060-8481-cf074377b8bd",
            "title": "DELETE/rootcheck/:agent_id",
            "fullFile": "/wazuh-api/test/test_rootcheck.js",
            "file": "/test/test_rootcheck.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Rootcheck DELETE/rootcheck/:agent_id Request",
                "timedOut": false,
                "duration": 274,
                "state": "failed",
                "pass": false,
                "fail": true,
                "pending": false,
                "code": "request(common.url)\n.delete(\"/rootcheck/000\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});",
                "err": {
                  "message": "AssertionError: expected Object {\n  error: 1017,\n  message: 'Some Wazuh daemons are not ready in node \\'master\\' (wazuh-modulesd->restarting, ossec-analysisd->restarting, ossec-execd->restarting, wazuh-db->restarting, ossec-remoted->restarting)'\n} to have property data",
                  "estack": "AssertionError: expected Object {\n  error: 1017,\n  message: 'Some Wazuh daemons are not ready in node \\'master\\' (wazuh-modulesd->restarting, ossec-analysisd->restarting, ossec-execd->restarting, wazuh-db->restarting, ossec-remoted->restarting)'\n} to have property data\n    at Assertion.fail (node_modules/should/cjs/should.js:258:17)\n    at Assertion.value [as properties] (node_modules/should/cjs/should.js:335:19)\n    at Test.<anonymous> (test/test_rootcheck.js:87:38)\n    at Test.assert (node_modules/supertest/lib/test.js:181:6)\n    at localAssert (node_modules/supertest/lib/test.js:131:12)\n    at /wazuh-api/node_modules/supertest/lib/test.js:128:5\n    at Test.Request.callback (node_modules/superagent/lib/node/index.js:716:12)\n    at /wazuh-api/node_modules/superagent/lib/node/index.js:916:18\n    at IncomingMessage.<anonymous> (node_modules/superagent/lib/node/parsers/json.js:19:7)\n    at endReadableNT (_stream_readable.js:1221:12)\n    at processTicksAndRejections (internal/process/task_queues.js:84:21)"
                },
                "isRoot": false,
                "uuid": "2ae49269-783b-4105-87a5-c3a43c9c75f0",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad agent id",
                "fullTitle": "Rootcheck DELETE/rootcheck/:agent_id Params: Bad agent id",
                "timedOut": false,
                "duration": 77,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.delete(\"/rootcheck/abc\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(600);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "5d120282-d254-42c1-9682-7f750ba18e81",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Errors: No agent",
                "fullTitle": "Rootcheck DELETE/rootcheck/:agent_id Errors: No agent",
                "timedOut": false,
                "duration": 268,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.delete(\"/rootcheck/9999999\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1701);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "9aea6db6-d2a7-44ff-b493-cd056cd15c0e",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "5d120282-d254-42c1-9682-7f750ba18e81",
              "9aea6db6-d2a7-44ff-b493-cd056cd15c0e"
            ],
            "failures": [
              "2ae49269-783b-4105-87a5-c3a43c9c75f0"
            ],
            "pending": [],
            "skipped": [],
            "duration": 619,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "7f6bf690-4e0a-4ae1-9cd7-1fc43bd7b9f9",
            "title": "DELETE/rootcheck",
            "fullFile": "/wazuh-api/test/test_rootcheck.js",
            "file": "/test/test_rootcheck.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Rootcheck DELETE/rootcheck Request",
                "timedOut": false,
                "duration": 292,
                "state": "failed",
                "pass": false,
                "fail": true,
                "pending": false,
                "code": "request(common.url)\n.delete(\"/rootcheck\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});",
                "err": {
                  "message": "AssertionError: expected Object { error: 3022, message: 'Unknown node ID' } to have property data",
                  "estack": "AssertionError: expected Object { error: 3022, message: 'Unknown node ID' } to have property data\n    at Assertion.fail (node_modules/should/cjs/should.js:258:17)\n    at Assertion.value [as properties] (node_modules/should/cjs/should.js:335:19)\n    at Test.<anonymous> (test/test_rootcheck.js:138:38)\n    at Test.assert (node_modules/supertest/lib/test.js:181:6)\n    at localAssert (node_modules/supertest/lib/test.js:131:12)\n    at /wazuh-api/node_modules/supertest/lib/test.js:128:5\n    at Test.Request.callback (node_modules/superagent/lib/node/index.js:716:12)\n    at /wazuh-api/node_modules/superagent/lib/node/index.js:916:18\n    at IncomingMessage.<anonymous> (node_modules/superagent/lib/node/parsers/json.js:19:7)\n    at endReadableNT (_stream_readable.js:1221:12)\n    at processTicksAndRejections (internal/process/task_queues.js:84:21)"
                },
                "isRoot": false,
                "uuid": "0e0f45e7-111b-41fa-8975-18fe5fcaeb7a",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [],
            "failures": [
              "0e0f45e7-111b-41fa-8975-18fe5fcaeb7a"
            ],
            "pending": [],
            "skipped": [],
            "duration": 292,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "73e74085-524d-474e-8346-c6fb53822af3",
            "title": "PUT/rootcheck/:agent_id",
            "fullFile": "/wazuh-api/test/test_rootcheck.js",
            "file": "/test/test_rootcheck.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Rootcheck PUT/rootcheck/:agent_id Request",
                "timedOut": false,
                "duration": 276,
                "state": "failed",
                "pass": false,
                "fail": true,
                "pending": false,
                "code": "request(common.url)\n.put(\"/rootcheck/000\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});",
                "err": {
                  "message": "AssertionError: expected Object {\n  error: 1017,\n  message: 'Some Wazuh daemons are not ready in node \\'master\\' (wazuh-modulesd->restarting, ossec-analysisd->restarting, ossec-execd->restarting, wazuh-db->restarting, ossec-remoted->restarting)'\n} to have property data",
                  "estack": "AssertionError: expected Object {\n  error: 1017,\n  message: 'Some Wazuh daemons are not ready in node \\'master\\' (wazuh-modulesd->restarting, ossec-analysisd->restarting, ossec-execd->restarting, wazuh-db->restarting, ossec-remoted->restarting)'\n} to have property data\n    at Assertion.fail (node_modules/should/cjs/should.js:258:17)\n    at Assertion.value [as properties] (node_modules/should/cjs/should.js:335:19)\n    at Test.<anonymous> (test/test_rootcheck.js:159:38)\n    at Test.assert (node_modules/supertest/lib/test.js:181:6)\n    at localAssert (node_modules/supertest/lib/test.js:131:12)\n    at /wazuh-api/node_modules/supertest/lib/test.js:128:5\n    at Test.Request.callback (node_modules/superagent/lib/node/index.js:716:12)\n    at /wazuh-api/node_modules/superagent/lib/node/index.js:916:18\n    at IncomingMessage.<anonymous> (node_modules/superagent/lib/node/parsers/json.js:19:7)\n    at endReadableNT (_stream_readable.js:1221:12)\n    at processTicksAndRejections (internal/process/task_queues.js:84:21)"
                },
                "isRoot": false,
                "uuid": "847e028c-dff4-4305-a232-5ae903e97dcc",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Params: Bad agent id",
                "fullTitle": "Rootcheck PUT/rootcheck/:agent_id Params: Bad agent id",
                "timedOut": false,
                "duration": 77,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.put(\"/rootcheck/abc\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(400)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(600);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "763022db-cd88-4b4b-916e-d1a9163cd848",
                "isHook": false,
                "skipped": false
              },
              {
                "title": "Errors: No agent",
                "fullTitle": "Rootcheck PUT/rootcheck/:agent_id Errors: No agent",
                "timedOut": false,
                "duration": 265,
                "state": "passed",
                "speed": "slow",
                "pass": true,
                "fail": false,
                "pending": false,
                "code": "request(common.url)\n.put(\"/rootcheck/9999999\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'message']);\n    res.body.error.should.equal(1701);\n    done();\n});",
                "err": {},
                "isRoot": false,
                "uuid": "69940854-abd6-4222-8f63-d85c136ed2ce",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [
              "763022db-cd88-4b4b-916e-d1a9163cd848",
              "69940854-abd6-4222-8f63-d85c136ed2ce"
            ],
            "failures": [
              "847e028c-dff4-4305-a232-5ae903e97dcc"
            ],
            "pending": [],
            "skipped": [],
            "duration": 618,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          },
          {
            "uuid": "cc2f0e9d-53b1-4bf7-8ccf-ed8610a2fc11",
            "title": "PUT/rootcheck",
            "fullFile": "/wazuh-api/test/test_rootcheck.js",
            "file": "/test/test_rootcheck.js",
            "beforeHooks": [],
            "afterHooks": [],
            "tests": [
              {
                "title": "Request",
                "fullTitle": "Rootcheck PUT/rootcheck Request",
                "timedOut": false,
                "duration": 291,
                "state": "failed",
                "pass": false,
                "fail": true,
                "pending": false,
                "code": "request(common.url)\n.put(\"/rootcheck\")\n.auth(common.credentials.user, common.credentials.password)\n.expect(\"Content-type\",/json/)\n.expect(200)\n.end(function(err,res){\n    if (err) return done(err);\n    res.body.should.have.properties(['error', 'data']);\n    res.body.error.should.equal(0);\n    res.body.data.should.be.an.string;\n    done();\n});",
                "err": {
                  "message": "AssertionError: expected Object { error: 3022, message: 'Unknown node ID' } to have property data",
                  "estack": "AssertionError: expected Object { error: 3022, message: 'Unknown node ID' } to have property data\n    at Assertion.fail (node_modules/should/cjs/should.js:258:17)\n    at Assertion.value [as properties] (node_modules/should/cjs/should.js:335:19)\n    at Test.<anonymous> (test/test_rootcheck.js:209:38)\n    at Test.assert (node_modules/supertest/lib/test.js:181:6)\n    at localAssert (node_modules/supertest/lib/test.js:131:12)\n    at /wazuh-api/node_modules/supertest/lib/test.js:128:5\n    at Test.Request.callback (node_modules/superagent/lib/node/index.js:716:12)\n    at /wazuh-api/node_modules/superagent/lib/node/index.js:916:18\n    at IncomingMessage.<anonymous> (node_modules/superagent/lib/node/parsers/json.js:19:7)\n    at endReadableNT (_stream_readable.js:1221:12)\n    at processTicksAndRejections (internal/process/task_queues.js:84:21)"
                },
                "isRoot": false,
                "uuid": "e59c6931-a885-475c-b09d-41983e831722",
                "isHook": false,
                "skipped": false
              }
            ],
            "suites": [],
            "passes": [],
            "failures": [
              "e59c6931-a885-475c-b09d-41983e831722"
            ],
            "pending": [],
            "skipped": [],
            "duration": 291,
            "root": false,
            "rootEmpty": false,
            "_timeout": 10000
          }
        ],
        "passes": [],
        "failures": [],
        "pending": [],
        "skipped": [],
        "duration": 0,
        "root": false,
        "rootEmpty": false,
        "_timeout": 10000
      }
    ],
    "passes": [],
    "failures": [],
    "pending": [],
    "skipped": [],
    "duration": 0,
    "root": true,
    "rootEmpty": true,
    "_timeout": 10000
  },
  "copyrightYear": 2020
}